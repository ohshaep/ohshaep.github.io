import{be as Y,bw as Ie,bo as _e,T as me,a2 as H,aJ as ge,a3 as ce,P as ne,bx as ve,by as ze,bz as Ce,bi as pe,Q as be,bA as Le,A as k,bB as Se,a6 as Ee,V as w,w as ue,n as we,H as ye,o as h,d as de,b as m,e as L,a as y,h as g,l as e,y as fe,b4 as Ne,k as S,X as T,aR as xe,c as x,F as ae,aP as Te,aQ as Oe,bC as Re,bu as Ae,W as $e,bD as Ye,bE as Xe,f as Be,j as Ve,a_ as Me,z as te,b5 as Pe,bF as De,Y as he,ac as X,aS as $,bG as Fe,Z as ke,bH as He,bI as We,t as je,ah as Ke,bJ as Ze,aW as Ge,ab as Je,bK as Qe}from"./index-1220b33e.js";const qe=(s,c)=>{if(!Y||!s||!c)return!1;const n=s.getBoundingClientRect();let v;return c instanceof Element?v=c.getBoundingClientRect():v={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},n.top<v.bottom&&n.bottom>v.top&&n.right>v.left&&n.left<v.right},gt=s=>{let c,n;return s.type==="touchend"?(n=s.changedTouches[0].clientY,c=s.changedTouches[0].clientX):s.type.startsWith("touch")?(n=s.touches[0].clientY,c=s.touches[0].clientX):(n=s.clientY,c=s.clientX),{clientX:c,clientY:n}};var Ue="Expected a function";function ie(s,c,n){var v=!0,r=!0;if(typeof s!="function")throw new TypeError(Ue);return Ie(n)&&(v="leading"in n?!!n.leading:v,r="trailing"in n?!!n.trailing:r),_e(s,c,{leading:v,maxWait:c,trailing:r})}const et=me({urlList:{type:H(Array),default:()=>ge([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:H(String)}}),tt={close:()=>!0,switch:s=>ce(s),rotate:s=>ce(s)},at=["src","crossorigin"],nt=ne({name:"ElImageViewer"}),st=ne({...nt,props:et,emits:tt,setup(s,{expose:c,emit:n}){var v;const r=s,b={CONTAIN:{name:"contain",icon:ve(ze)},ORIGINAL:{name:"original",icon:ve(Ce)}},{t:se}=pe(),u=be("image-viewer"),{nextZIndex:B}=Le(),E=k(),N=k([]),O=Se(),I=k(!0),d=k(r.initialIndex),R=Ee(b.CONTAIN),o=k({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),V=k((v=r.zIndex)!=null?v:B()),le=w(()=>{const{urlList:a}=r;return a.length<=1}),W=w(()=>d.value===0),j=w(()=>d.value===r.urlList.length-1),M=w(()=>r.urlList[d.value]),oe=w(()=>[u.e("btn"),u.e("prev"),u.is("disabled",!r.infinite&&W.value)]),K=w(()=>[u.e("btn"),u.e("next"),u.is("disabled",!r.infinite&&j.value)]),P=w(()=>{const{scale:a,deg:l,offsetX:i,offsetY:_,enableTransition:C}=o.value;let p=i/a,z=_/a;switch(l%360){case 90:case-270:[p,z]=[z,-p];break;case 180:case-180:[p,z]=[-p,-z];break;case 270:case-90:[p,z]=[-z,p];break}const A={transform:`scale(${a}) rotate(${l}deg) translate(${p}px, ${z}px)`,transition:C?"transform .3s":""};return R.value.name===b.CONTAIN.name&&(A.maxWidth=A.maxHeight="100%"),A});function D(){Z(),n("close")}function re(){const a=ie(i=>{switch(i.code){case $.esc:r.closeOnPressEscape&&D();break;case $.space:U();break;case $.left:ee();break;case $.up:f("zoomIn");break;case $.right:t();break;case $.down:f("zoomOut");break}}),l=ie(i=>{const _=i.deltaY||i.deltaX;f(_<0?"zoomIn":"zoomOut",{zoomRate:r.zoomRate,enableTransition:!1})});O.run(()=>{X(document,"keydown",a),X(document,"wheel",l)})}function Z(){O.stop()}function G(){I.value=!1}function J(a){I.value=!1,a.target.alt=se("el.image.error")}function Q(a){if(I.value||a.button!==0||!E.value)return;o.value.enableTransition=!1;const{offsetX:l,offsetY:i}=o.value,_=a.pageX,C=a.pageY,p=ie(A=>{o.value={...o.value,offsetX:l+A.pageX-_,offsetY:i+A.pageY-C}}),z=X(document,"mousemove",p);X(document,"mouseup",()=>{z()}),a.preventDefault()}function q(){o.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function U(){if(I.value)return;const a=Fe(b),l=Object.values(b),i=R.value.name,C=(l.findIndex(p=>p.name===i)+1)%a.length;R.value=b[a[C]],q()}function F(a){const l=r.urlList.length;d.value=(a+l)%l}function ee(){W.value&&!r.infinite||F(d.value-1)}function t(){j.value&&!r.infinite||F(d.value+1)}function f(a,l={}){if(I.value)return;const{minScale:i,maxScale:_}=r,{zoomRate:C,rotateDeg:p,enableTransition:z}={zoomRate:r.zoomRate,rotateDeg:90,enableTransition:!0,...l};switch(a){case"zoomOut":o.value.scale>i&&(o.value.scale=Number.parseFloat((o.value.scale/C).toFixed(3)));break;case"zoomIn":o.value.scale<_&&(o.value.scale=Number.parseFloat((o.value.scale*C).toFixed(3)));break;case"clockwise":o.value.deg+=p,n("rotate",o.value.deg);break;case"anticlockwise":o.value.deg-=p,n("rotate",o.value.deg);break}o.value.enableTransition=z}return ue(M,()=>{we(()=>{const a=N.value[0];a!=null&&a.complete||(I.value=!0)})}),ue(d,a=>{q(),n("switch",a)}),ye(()=>{var a,l;re(),(l=(a=E.value)==null?void 0:a.focus)==null||l.call(a)}),c({setActiveItem:F}),(a,l)=>(h(),de(De,{to:"body",disabled:!a.teleported},[m(Pe,{name:"viewer-fade",appear:""},{default:L(()=>[y("div",{ref_key:"wrapper",ref:E,tabindex:-1,class:g(e(u).e("wrapper")),style:fe({zIndex:V.value})},[y("div",{class:g(e(u).e("mask")),onClick:l[0]||(l[0]=Ne(i=>a.hideOnClickModal&&D(),["self"]))},null,2),S(" CLOSE "),y("span",{class:g([e(u).e("btn"),e(u).e("close")]),onClick:D},[m(e(T),null,{default:L(()=>[m(e(xe))]),_:1})],2),S(" ARROW "),e(le)?S("v-if",!0):(h(),x(ae,{key:0},[y("span",{class:g(e(oe)),onClick:ee},[m(e(T),null,{default:L(()=>[m(e(Te))]),_:1})],2),y("span",{class:g(e(K)),onClick:t},[m(e(T),null,{default:L(()=>[m(e(Oe))]),_:1})],2)],64)),S(" ACTIONS "),y("div",{class:g([e(u).e("btn"),e(u).e("actions")])},[y("div",{class:g(e(u).e("actions__inner"))},[m(e(T),{onClick:l[1]||(l[1]=i=>f("zoomOut"))},{default:L(()=>[m(e(Re))]),_:1}),m(e(T),{onClick:l[2]||(l[2]=i=>f("zoomIn"))},{default:L(()=>[m(e(Ae))]),_:1}),y("i",{class:g(e(u).e("actions__divider"))},null,2),m(e(T),{onClick:U},{default:L(()=>[(h(),de($e(e(R).icon)))]),_:1}),y("i",{class:g(e(u).e("actions__divider"))},null,2),m(e(T),{onClick:l[3]||(l[3]=i=>f("anticlockwise"))},{default:L(()=>[m(e(Ye))]),_:1}),m(e(T),{onClick:l[4]||(l[4]=i=>f("clockwise"))},{default:L(()=>[m(e(Xe))]),_:1})],2)],2),S(" CANVAS "),y("div",{class:g(e(u).e("canvas"))},[(h(!0),x(ae,null,Be(a.urlList,(i,_)=>Ve((h(),x("img",{ref_for:!0,ref:C=>N.value[_]=C,key:i,src:i,style:fe(e(P)),class:g(e(u).e("img")),crossorigin:a.crossorigin,onLoad:G,onError:J,onMousedown:Q},null,46,at)),[[Me,_===d.value]])),128))],2),te(a.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var lt=he(st,[["__file","image-viewer.vue"]]);const ot=ke(lt),rt=me({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:H([String,Object])},previewSrcList:{type:H(Array),default:()=>ge([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:H(String)}}),it={load:s=>s instanceof Event,error:s=>s instanceof Event,switch:s=>ce(s),close:()=>!0,show:()=>!0},ct=["src","loading","crossorigin"],ut={key:0},dt=ne({name:"ElImage",inheritAttrs:!1}),ft=ne({...dt,props:rt,emits:it,setup(s,{emit:c}){const n=s;let v="";const{t:r}=pe(),b=be("image"),se=He(),u=We(),B=k(),E=k(!1),N=k(!0),O=k(!1),I=k(),d=k(),R=Y&&"loading"in HTMLImageElement.prototype;let o,V;const le=w(()=>[b.e("inner"),M.value&&b.e("preview"),N.value&&b.is("loading")]),W=w(()=>se.style),j=w(()=>{const{fit:t}=n;return Y&&t?{objectFit:t}:{}}),M=w(()=>{const{previewSrcList:t}=n;return Array.isArray(t)&&t.length>0}),oe=w(()=>{const{previewSrcList:t,initialIndex:f}=n;let a=f;return f>t.length-1&&(a=0),a}),K=w(()=>n.loading==="eager"?!1:!R&&n.loading==="lazy"||n.lazy),P=()=>{Y&&(N.value=!0,E.value=!1,B.value=n.src)};function D(t){N.value=!1,E.value=!1,c("load",t)}function re(t){N.value=!1,E.value=!0,c("error",t)}function Z(){qe(I.value,d.value)&&(P(),Q())}const G=Qe(Z,200,!0);async function J(){var t;if(!Y)return;await we();const{scrollContainer:f}=n;Ze(f)?d.value=f:Ge(f)&&f!==""?d.value=(t=document.querySelector(f))!=null?t:void 0:I.value&&(d.value=Je(I.value)),d.value&&(o=X(d,"scroll",G),setTimeout(()=>Z(),100))}function Q(){!Y||!d.value||!G||(o==null||o(),d.value=void 0)}function q(t){if(t.ctrlKey){if(t.deltaY<0)return t.preventDefault(),!1;if(t.deltaY>0)return t.preventDefault(),!1}}function U(){M.value&&(V=X("wheel",q,{passive:!1}),v=document.body.style.overflow,document.body.style.overflow="hidden",O.value=!0,c("show"))}function F(){V==null||V(),document.body.style.overflow=v,O.value=!1,c("close")}function ee(t){c("switch",t)}return ue(()=>n.src,()=>{K.value?(N.value=!0,E.value=!1,Q(),J()):P()}),ye(()=>{K.value?J():P()}),(t,f)=>(h(),x("div",{ref_key:"container",ref:I,class:g([e(b).b(),t.$attrs.class]),style:fe(e(W))},[E.value?te(t.$slots,"error",{key:0},()=>[y("div",{class:g(e(b).e("error"))},je(e(r)("el.image.error")),3)]):(h(),x(ae,{key:1},[B.value!==void 0?(h(),x("img",Ke({key:0},e(u),{src:B.value,loading:t.loading,style:e(j),class:e(le),crossorigin:t.crossorigin,onClick:U,onLoad:D,onError:re}),null,16,ct)):S("v-if",!0),N.value?(h(),x("div",{key:1,class:g(e(b).e("wrapper"))},[te(t.$slots,"placeholder",{},()=>[y("div",{class:g(e(b).e("placeholder"))},null,2)])],2)):S("v-if",!0)],64)),e(M)?(h(),x(ae,{key:2},[O.value?(h(),de(e(ot),{key:0,"z-index":t.zIndex,"initial-index":e(oe),infinite:t.infinite,"zoom-rate":t.zoomRate,"min-scale":t.minScale,"max-scale":t.maxScale,"url-list":t.previewSrcList,"hide-on-click-modal":t.hideOnClickModal,teleported:t.previewTeleported,"close-on-press-escape":t.closeOnPressEscape,onClose:F,onSwitch:ee},{default:L(()=>[t.$slots.viewer?(h(),x("div",ut,[te(t.$slots,"viewer")])):S("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):S("v-if",!0)],64)):S("v-if",!0)],6))}});var vt=he(ft,[["__file","image.vue"]]);const pt=ke(vt);export{pt as E,ot as a,gt as g};
