(window.webpackJsonp=window.webpackJsonp||[]).push([["maintenanceService"],{"0256":function(e,t,a){"use strict";a.r(t);a("b0c0");var i=a("c7eb"),r=a("1da1"),s=(a("a15b"),a("d81d"),a("14d9"),a("a434"),a("d3b7"),a("ac1f"),a("841c"),a("159b"),a("365c")),l={data:function(){return{currentType:"",dialogFormVisible:!1,actions:s.qb.uploadCheckPicture,tableData:[],permissionBtnList:[],option:[],option2:[],option3:[{value:1,label:"正常"},{value:2,label:"异常"},{value:3,label:"无"}],form:{inputValidator:""},rules:{inputValidator:[{required:!0,message:"请输入审核意见",trigger:"blur"}]},pageindex:1,pagesize:10,totalPages:0,totalRecords:0,opTitle:"",visible:!1,visible2:!1,id:"",companyName:"",name:"",phone:"",valueTime:"",wellNo:"",reportLocation:"",checkTime:"",search:{id:"",startTime:"",endTime:"",name:"",wellNo:"",reportLocation:"",companyName:""},main:{id:"",companyName:"",name:"",phone:"",wellNo:"",reportLocation:"",checkTime:"",reportFailureId:"",isReportFailure:"",checkType:"",checkMethod:"",checkResult:"",checkContent:"",remark:"",fileIds:""},uploadUrl:"",fileList:[],gosPhoto:[],srcList:[],strongCurrentPhoto:[],otherPhoto:[],lastFileList:[],lastGosPhotoList:[],lastStrongCurrentPhotoList:[],lastOtherPhotoList:[],srcList1:[],sign2:null,dialogVisible:!1,dialogImageUrl:"",userSaveLoading:!1,list:[{mcId:"",checkType:"",checkMethod:"",checkResult:"",checkContent:"",remark:"",checkTypeText:"",file:[],srcList:[]}],companyList:[],nums:[],checkUsers:[],showAddModal:!1,addForm:{obj:null,fileIds:[],checkTime:"",checkResult:1,checkerId:"",remark:void 0},auditDialogVisible:!1,autidId:""}},created:function(){this.bind(),this.companyLists(),this.btnList(),this.getAllCheckUser()},mounted:function(){},methods:{UserSave:function(){var e=this;this.$refs.form.validate().then((function(t){e.submitForm()}))},closeIcon:function(){var e=this;this.dialogFormVisible=!1,this.$nextTick((function(){e.$refs.form.clearValidate(),e.$refs.inputRef.focus()}))},getNums:function(e){var t=this;Object(s.Wb)({wellNo:e}).then((function(e){t.nums=e.data}))},searchMethod:function(){this.pageindex=1,this.bind(!1)},bind:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$loading({lock:!0,text:"正在加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t.next=3,Object(s.yd)({pageIndex:e.pageindex,pagesize:e.pagesize});case 3:if(0!=(r=t.sent).resultCode){t.next=12;break}a.close(),e.tableData=r.data,e.pageindex=r.currentPage,e.totalPages=r.totalPages,e.totalRecords=r.count,t.next=15;break;case 12:return a.close(),e.$message.error(r.resultMsg),t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t)})))()},btnList:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.Nc)({roleSysno:e.$cookies.get("Role_Sysno"),url:"inspectionManage"}).then((function(t){if("0"!=t.resultCode)return"2024"==t.resultCode?(e.$message.error("token失效!请重新登录"),e.$router.push({path:"/login"})):e.$message.error(t.resultMsg),!1;t.data.forEach((function(t){e.permissionBtnList.push(t.phoneurl)}))}));case 2:case"end":return t.stop()}}),t)})))()},edit:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r,l;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.main.wellNo=e.wellNo,t.opTitle=t.main.wellNo+"--巡检信息",t.main.id=e.id,t.main.companyName=e.companyName,t.main.name=e.name,t.main.phone=e.phone,t.main.reportLocation=e.reportLocation,t.main.reportFailureId=e.reportFailureId,t.main.isReportFailure=e.isReportFailure,t.main.checkTime=t.timestampToDate(e.checkTime),t.fileList=[],t.gosPhoto=[],t.strongCurrentPhoto=[],t.otherPhoto=[],t.lastFileList=[],t.lastGosPhotoList=[],t.lastStrongCurrentPhotoList=[],t.lastOtherPhotoList=[],t.findDic("checkType",t.option),t.findDic("checkMethod",t.option2),r=[],e.fileIds&&r.push(e.fileIds),e.gosPhoto&&r.push(e.gosPhoto),e.otherPhoto&&r.push(e.otherPhoto),e.strongCurrentPhoto&&r.push(e.strongCurrentPhoto),t.picture(r.join(",")),t.lastPicture(e.wellNo,t.main.checkTime),a.next=29,Object(s.A)({token:t.$cookies.get("token_pipe"),checkId:e.id});case 29:if("0"!==(l=a.sent).resultCode){a.next=34;break}t.list=l.data,a.next=36;break;case 34:return t.$message.error(l.resultMsg),a.abrupt("return",!1);case 36:t.visible=!0;case 37:case"end":return a.stop()}}),a)})))()},detail:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r,l,n,o;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.main.wellNo=e.wellNo,t.opTitle=t.main.wellNo+"--详情",t.main.id=e.id,t.main.companyName=e.companyName,t.main.name=e.name,t.main.phone=e.phone,t.main.reportLocation=e.reportLocation,t.main.reportFailureId=e.reportFailureId,t.main.checkTime=e.checkTime,t.fileList=[],t.gosPhoto=[],t.strongCurrentPhoto=[],t.otherPhoto=[],t.lastFileList=[],t.lastGosPhotoList=[],t.lastStrongCurrentPhotoList=[],t.lastOtherPhotoList=[],r=[],e.fileIds&&r.push(e.fileIds),e.gosPhoto&&r.push(e.gosPhoto),e.otherPhoto&&r.push(e.otherPhoto),e.strongCurrentPhoto&&r.push(e.strongCurrentPhoto),t.picture(r.join(",")),t.lastPicture(e),a.next=26,Object(s.A)({token:t.$cookies.get("token_pipe"),checkId:e.id});case 26:if("0"!==(l=a.sent).resultCode){a.next=43;break}t.list=l.data,n=0;case 30:if(!(n<t.list.length)){a.next=41;break}if(l.data[n].file=[],l.data[n].srcList=[],null==t.list[n].fileIds){a.next=38;break}return a.next=36,Object(s.Mb)({fileIds:t.list[n].fileIds});case 36:"0"===(o=a.sent).resultCode?null!=o.data&&o.data.forEach((function(e){var a={name:e.fileName,url:e.url};t.list[n].file.push(a),t.list[n].srcList.push(e.url)})):o.resultCode;case 38:n++,a.next=30;break;case 41:a.next=44;break;case 43:return a.abrupt("return",!1);case 44:t.visible2=!0;case 45:case"end":return a.stop()}}),a)})))()},picture1:function(e,t){var a=this;return Object(r.a)(Object(i.a)().mark((function r(){var l;return Object(i.a)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=3,Object(s.Mb)({fileIds:t});case 3:"0"===(l=i.sent).resultCode?null!=l.data&&l.data.forEach((function(t){var i={name:t.fileName,url:t.url};a.list[e].file.push(i),a.list[e].srcList.push(t.url)})):l.resultCode;case 5:case"end":return i.stop()}}),r)})))()},changeTime:function(e){this.search.startTime=null!=e?e[0]:"",this.search.endTime=null!=e?e[1]:""},picture:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r,l;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(s.Lb)({fileIds:e});case 2:"0"===(r=a.sent).resultCode?(l=new Object,r.data&&r.data.forEach((function(e){l.name=e.fileName,l.url=e.url,l.id=e.id,1==e.type?t.fileList.push(e):2==e.type?t.gosPhoto.push(e):3==e.type?t.strongCurrentPhoto.push(e):4==e.type&&t.otherPhoto.push(e)}))):r.resultCode;case 4:case"end":return a.stop()}}),a)})))()},lastPicture:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(s.Ob)({wellNo:e.wellNo,checkTime:e.checkTime});case 2:"0"===(r=a.sent).resultCode?0==t.lastFileList.length&&null!=r.data&&r.data.forEach((function(e){var a=new Object;a.name=e.fileName,a.url=e.url,a.id=e.id,1!=e.type&&null!=e.type||(t.lastFileList.push(a),t.srcList1.push(e.url)),2==e.type&&t.lastGosPhotoList.push(a),3==e.type&&t.lastStrongCurrentPhotoList.push(a),4==e.type&&t.lastOtherPhotoList.push(a)})):r.resultCode;case 4:case"end":return a.stop()}}),a)})))()},newCheckType:function(){this.list.push({mcId:"",checkType:"",checkMethod:"",checkResult:"",checkContent:"",remark:""})},del:function(e,t){this.list.splice(t,1)},submitUpload:function(){var e=this;this.$confirm("是否上传图片，上传后不可更改?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$refs.upload.submit()})).catch((function(){}))},addCheckFiles:function(e){var t=e.data.id;null==this.main.fileIds?this.main.fileIds=t:this.main.fileIds=this.main.fileIds+","+t,this.sign2=1},handleRemove:function(e,t){},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},companyLists:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.companyList=[],t.next=3,Object(s.bc)({});case 3:"0"==(a=t.sent).resultCode&&a.data.forEach((function(t){var a=new Object;a.value=t.name,a.label=t.name,e.companyList.push(a)}));case 5:case"end":return t.stop()}}),t)})))()},Save:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a,r,l;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$cookies.get("Sysno"),e.sign2=0,e.userSaveLoading=!0,r=[],e.list.map((function(e){var t={mcId:e.id,checkType:e.checkType,checkMethod:e.checkMethod,checkResult:e.checkResult,checkContent:e.checkContent,remark:e.remark};r.push(t)})),t.next=7,Object(s.kb)({wellNo:e.main.wellNo,id:e.main.id,companyName:e.main.companyName,name:e.main.name,phone:e.main.phone,reportLocation:e.main.reportLocation,reportFailureId:e.main.reportFailureId,isReportFailure:e.main.isReportFailure,checkTime:e.main.checkTime,fileIds:e.main.fileIds,checkList:r,createUserNo:a});case 7:if("0"!==(l=t.sent).resultCode){t.next=14;break}e.$message.success("保存成功"),e.bind(),e.visible=!1,t.next=16;break;case 14:return e.$message.error(l.resultMsg),t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t)})))()},findDic:function(e,t){return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!=t.length){a.next=5;break}return a.next=3,Object(s.Gc)({typeCode:e});case 3:"0"==(r=a.sent).resultCode&&r.data.forEach((function(e){var a=new Object;a.value=e.value,a.label=e.text,t.push(a)}));case 5:case"end":return a.stop()}}),a)})))()},Clear:function(){this.search.id="",this.search.wellNo="",this.search.name="",this.search.companyName="",this.search.reportLocation="",this.search.startTime="",this.valueTime="",this.search.endTime="",this.bind()},reflush:function(){this.pageindex=1,this.search.id="",this.search.wellNo="",this.search.name="",this.search.companyName="",this.search.reportLocation="",this.search.startTime="",this.search.endTime="",this.bind()},timestampToDate:function(e){var t=new Date(e),a=t.getFullYear(),i=t.getMonth()+1,r=t.getDate(),s=t.getHours(),l=t.getMinutes(),n=t.getSeconds();return a+"-"+(i=i<10?"0"+i:i)+"-"+(r=r<10?"0"+r:r)+" "+(s=s<10?"0"+s:s)+":"+(l=l<10?"0"+l:l)+":"+(n=n<10?"0"+n:n)},handleCurrentChange:function(e){this.pageindex=e,this.bind()},handleSuccess:function(e){this.addForm.fileIds.push(e.data.id)},getAllCheckUser:function(){var e=this;Object(s.Zb)().then((function(t){e.checkUsers=t.data}))},cancel:function(){this.showAddModal=!1,this.$refs.addFormRef.resetFields(),this.$refs.uploadRef.clearFiles(),this.addForm={}},saveAddForm:function(){var e=this;Object(s.f)({wellId:this.addForm.obj.id,wellNo:this.addForm.obj.wellNo,reportLocation:this.addForm.obj.roadSection,checkerId:this.addForm.checkerId,fileIds:this.addForm.fileIds.join(","),checkResult:this.addForm.checkResult,remark:this.addForm.remark,checkTime:this.addForm.checkTime}).then((function(t){0==t.resultCode&&(e.showAddModal=!1,e.$refs.addFormRef.resetFields(),e.$refs.uploadRef.clearFiles(),e.addForm={})}))},Audit:function(e){var t=this;this.auditDialogVisible=!0,this.autidId=e.id,this.btn6=!0,this.$nextTick((function(){t.$refs.inputRef.focus()}))},update:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.currentType=e,"1"!=e?t.dialogFormVisible=!0:t.submitForm();case 2:case"end":return a.stop()}}),a)})))()},clearform:function(){var e=this;this.dialogFormVisible=!1,this.$nextTick((function(){e.$refs.form.clearValidate(),e.$refs.inputRef.focus()}))},submitForm:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$nextTick((function(){e.$refs.form&&e.$refs.form.clearValidate()})),a=e,t.next=5,Object(s.x)({id:a.autidId,isPass:e.currentType,cause:e.form.inputValidator});case 5:"0"===(r=t.sent).resultCode?(a.$message.success("审核成功"),a.dialogFormVisible=!1,a.auditDialogVisible=!1,e.form.inputValidator="",e.bind()):"2"===r.resultCode&&(a.$message.error(r.resultMsg),a.auditDialogVisible=!1,e.form.inputValidator="");case 7:case"end":return t.stop()}}),t)})))()}}},n=(a("639f"),a("069e"),a("2877")),o=Object(n.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page_content"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card_body"},[t("div",{staticClass:"filter_container"}),t("div",{staticClass:"table_container"},[t("page-main",[t("el-table",{attrs:{data:e.tableData,stripe:""}},[t("el-table-column",{attrs:{prop:"wellNo",label:"井编号",align:"center"}}),t("el-table-column",{attrs:{prop:"name",label:"巡检人员",align:"center"}}),t("el-table-column",{attrs:{prop:"phone",label:"联系方式",align:"center"}}),t("el-table-column",{attrs:{prop:"reportLocation",label:"位置",align:"center"}}),t("el-table-column",{attrs:{prop:"checkTime",label:"巡检时间",align:"center"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.Audit(a.row)}}},[e._v("审批 ")]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.detail(a.row)}}},[e._v("详情")])]}}])})],1),t("div",{staticClass:"pagenation"},[t("el-pagination",{attrs:{background:"","current-page":e.pageindex,"page-size":e.pagesize,layout:"total,prev, pager, next, jumper",total:e.totalRecords},on:{"current-change":e.handleCurrentChange}})],1)],1)],1)])]),t("el-dialog",{attrs:{title:e.opTitle,center:"",visible:e.visible,width:"60%","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t}}},[t("el-form",{ref:"main",staticStyle:{position:"relative","margin-left":"50px"},attrs:{model:e.main,"label-width":"150px",inline:!0}},[t("h3",[e._v("巡检")]),t("br"),t("el-form-item",{attrs:{label:"巡检编号:"}},[t("el-input",{attrs:{disabled:!0,clearable:""},model:{value:e.main.id,callback:function(t){e.$set(e.main,"id",t)},expression:"main.id"}})],1),t("el-form-item",{attrs:{label:"巡检单位:"}},[t("el-input",{staticStyle:{width:"250px"},attrs:{clearable:""},model:{value:e.main.companyName,callback:function(t){e.$set(e.main,"companyName",t)},expression:"main.companyName"}})],1),t("br"),t("el-form-item",{attrs:{label:"巡检人员:"}},[t("el-input",{model:{value:e.main.name,callback:function(t){e.$set(e.main,"name",t)},expression:"main.name"}})],1),t("el-form-item",{attrs:{label:"巡检人员联系方式:"}},[t("el-input",{staticStyle:{width:"250px"},attrs:{clearable:""},model:{value:e.main.phone,callback:function(t){e.$set(e.main,"phone",t)},expression:"main.phone"}})],1),t("br"),t("el-form-item",{attrs:{label:"井编号:"}},[t("el-input",{attrs:{disabled:!0,clearable:""},model:{value:e.main.wellNo,callback:function(t){e.$set(e.main,"wellNo",t)},expression:"main.wellNo"}})],1),t("el-form-item",{attrs:{label:"上报位置:"}},[t("el-input",{staticStyle:{width:"250px"},attrs:{clearable:""},model:{value:e.main.reportLocation,callback:function(t){e.$set(e.main,"reportLocation",t)},expression:"main.reportLocation"}})],1),t("br"),t("el-form-item",{attrs:{label:"巡检时间:"}},[t("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"","value-format":"yyyy-MM-dd "},model:{value:e.main.checkTime,callback:function(t){e.$set(e.main,"checkTime",t)},expression:"main.checkTime"}})],1),t("el-form-item",{attrs:{label:"保障ID:"}},[t("el-input",{staticStyle:{width:"250px"},attrs:{clearable:"",disabled:!0},model:{value:e.main.reportFailureId,callback:function(t){e.$set(e.main,"reportFailureId",t)},expression:"main.reportFailureId"}})],1),t("br"),t("el-form-item",{attrs:{label:"是否保障:"}},[t("el-input",{attrs:{disabled:!0,clearable:""},model:{value:e.main.isReportFailure,callback:function(t){e.$set(e.main,"isReportFailure",t)},expression:"main.isReportFailure"}})],1),t("br"),t("h3",[e._v("巡检明细")]),t("br"),t("div",[t("el-form-item",{attrs:{label:"巡检记录ID:"}},[t("el-input",{attrs:{disabled:!0},model:{value:e.main.id,callback:function(t){e.$set(e.main,"id",t)},expression:"main.id"}})],1),t("br"),e._l(e.list,(function(a,i){return t("div",{key:i},[t("el-form-item",{attrs:{label:"巡检项:"}},[t("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"",filterable:"","allow-create":"","default-first-option":""},model:{value:a.checkType,callback:function(t){e.$set(a,"checkType",t)},expression:"items.checkType"}},e._l(e.option,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{staticStyle:{"margin-left":"-70px"},attrs:{label:"巡检方法:"}},[t("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"",filterable:"","allow-create":"","default-first-option":""},model:{value:a.checkMethod,callback:function(t){e.$set(a,"checkMethod",t)},expression:"items.checkMethod"}},e._l(e.option2,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{staticStyle:{"margin-left":"-70px"},attrs:{label:"检测结果:"}},[t("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"",filterable:"","allow-create":"","default-first-option":""},model:{value:a.checkResult,callback:function(t){e.$set(a,"checkResult",t)},expression:"items.checkResult"}},e._l(e.option3,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:""}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.del(a,i)}}},[e._v("删除")])],1),t("br"),t("el-form-item",{attrs:{label:"检测内容:"}},[t("el-input",{staticStyle:{width:"630px"},attrs:{type:"textarea",clearable:""},model:{value:a.checkContent,callback:function(t){e.$set(a,"checkContent",t)},expression:"items.checkContent"}})],1),t("br"),t("el-form-item",{attrs:{label:"备注:"}},[t("el-input",{staticStyle:{width:"630px"},attrs:{type:"textarea",clearable:""},model:{value:a.remark,callback:function(t){e.$set(a,"remark",t)},expression:"items.remark"}})],1),t("br")],1)})),t("el-form-item",{staticStyle:{"margin-top":"10px","margin-left":"450px",position:"relative"},attrs:{label:""}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.newCheckType}},[e._v("添加巡检项")])],1)],2),t("el-form-item",{attrs:{label:"本次巡检附件上传:"}},[t("el-upload",{ref:"upload",attrs:{action:e.uploadUrl,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"auto-upload":!1,"on-success":e.addCheckFiles,disabled:1==e.sign2,"file-list":e.fileList}},[t("i",{staticClass:"el-icon-plus"})]),t("el-button",{staticStyle:{"margin-left":"28px","margin-top":"5px"},attrs:{size:"small",type:"primary",disabled:1==e.sign2},on:{click:e.submitUpload}},[e._v(" 上传图片 ")])],1),t("br"),t("el-form-item",{attrs:{label:"上次巡检照片:"}},[t("div",{staticClass:"demo-image__preview"},e._l(e.lastFileList,(function(a,i){return t("el-image",{key:i,staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:a.url,"preview-src-list":e.srcList1}})})),1)])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",loading:e.userSaveLoading},on:{click:e.Save}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:e.opTitle,center:"",visible:e.visible2,width:"954px","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible2=t}}},[t("el-form",{ref:"main",staticStyle:{"margin-left":"10px"},attrs:{model:e.main,inline:!0}},[t("div",{staticClass:"title"},[t("span",[e._v("巡检信息")])]),t("div",{staticClass:"box1",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1_left"},[t("div",{staticClass:"box1_left_left"},[e._v("巡检位置 :")]),t("div",{staticClass:"box1_left_right",attrs:{title:e.main.reportLocation}},[t("span",[e._v(e._s(e.main.reportLocation))])])]),t("div",{staticClass:"box1_right"},[t("div",{staticClass:"box1_left_left1"},[e._v("井编号 :")]),t("div",{staticClass:"box1_left_right"},[t("span",[e._v(e._s(e.main.wellNo))])])])]),t("div",{staticClass:"box1",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1_left"},[t("div",{staticClass:"box1_left_left"},[e._v("巡检单位:")]),t("div",{staticClass:"box1_left_right"},[t("span",[e._v(e._s(e.main.companyName))])])])]),t("div",{staticClass:"box1",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1_left"},[t("div",{staticClass:"box1_left_left"},[e._v("巡检人员 :")]),t("div",{staticClass:"box1_left_right"},[t("span",[e._v(e._s(e.main.name))])])]),t("div",{staticClass:"box1_right"},[t("div",{staticClass:"box1_left_left1"},[e._v("巡检时间 :")]),t("div",{staticClass:"box1_left_right"},[t("span",[e._v(e._s(e.main.checkTime))])])])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("本次巡检照片：")])])]),0!=e.fileList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.fileList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("气体检测照片:")])])]),0!=e.gosPhoto.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.gosPhoto,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("强电检测照片:")])])]),0!=e.strongCurrentPhoto.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.strongCurrentPhoto,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("其他照片:")])])]),0!=e.otherPhoto.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.otherPhoto,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("上次巡检照片：")])])]),0!=e.lastFileList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.lastFileList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("上次气体监测照片：")])])]),0!=e.lastGosPhotoList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.lastGosPhotoList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("上次强电监测照片：")])])]),0!=e.lastStrongCurrentPhotoList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.lastStrongCurrentPhotoList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("上次其他照片：")])])]),0!=e.lastOtherPhotoList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.lastOtherPhotoList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"title",staticStyle:{"margin-top":"30px"}},[t("span",[e._v("巡检明细")])]),t("div",e._l(e.list,(function(a,i){return t("div",{key:i},[t("div",{staticClass:"box1",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1_left"},[t("div",{staticClass:"box1_left_left"},[e._v("巡检项 :")]),t("div",{staticClass:"box1_left_right"},[t("span",[e._v(e._s(a.checkTypeText))])])]),t("div",{staticClass:"box1_right"},[t("div",{staticClass:"box1_left_left1"},[e._v("巡检结果 :")]),t("div",{staticClass:"box1_left_right"},[1==a.checkResult?t("span",[e._v("正常")]):e._e(),2==a.checkResult?t("span",[e._v("异常")]):e._e(),3==a.checkResult?t("span",[e._v("无")]):e._e()])])]),2==a.checkResult?t("div",{staticClass:"box_1",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1_left",staticStyle:{"margin-top":"20px"}},[t("div",{staticClass:"box1_left_left"},[e._v("备注 :")]),t("div",{staticClass:"box1_left_right1"},[t("span",[e._v(e._s(a.remark))])])]),t("div",{staticClass:"upload"},[t("div",{staticStyle:{width:"50%",display:"flex"}},[t("div",{staticClass:"upload_left"},[t("div",{staticClass:"upload_bottom"},[t("span",[e._v("照片 ：")])])]),t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(a.file,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1)])])]):e._e()])})),0)])],1),t("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})]),t("el-dialog",{attrs:{visible:e.showAddModal,title:"新增巡检"},on:{"update:visible":function(t){e.showAddModal=t}}},[t("el-form",{ref:"addFormRef",staticClass:"woderClass",attrs:{model:e.addForm,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"井编号:",prop:"num"}},[t("el-select",{attrs:{clearable:"",filterable:"",remote:"",placeholder:"请输入","value-key":"id","remote-method":e.getNums},on:{clear:e.getNums},model:{value:e.addForm.obj,callback:function(t){e.$set(e.addForm,"obj",t)},expression:"addForm.obj"}},e._l(e.nums,(function(e,a){return t("el-option",{key:a,attrs:{value:e,label:e.wellNo}})})),1)],1),t("el-form-item",{attrs:{label:"异常情况",prop:"type"}},[t("el-radio-group",{model:{value:e.addForm.status,callback:function(t){e.$set(e.addForm,"status",t)},expression:"addForm.status"}},[t("el-radio",{attrs:{label:1}},[e._v("正常")]),t("el-radio",{attrs:{label:2}},[e._v("异常")])],1),2===e.addForm.status?t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入异常情况"},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}}):e._e()],1),t("el-form-item",{attrs:{label:"本次巡检图片"}},[t("el-upload",{ref:"uploadImages",attrs:{action:e.actions,"list-type":"picture-card","on-success":e.handleSuccess,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[t("i",{staticClass:"el-icon-plus"})])],1),t("el-form-item",{attrs:{label:"巡检人员",prop:"type"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.checkerId,callback:function(t){e.$set(e.addForm,"checkerId",t)},expression:"addForm.checkerId"}},e._l(e.checkUsers,(function(e){return t("el-option",{key:e.sysno,attrs:{label:e.name,value:e.sysno}})})),1)],1),t("el-form-item",{attrs:{label:"巡检时间",prop:"checkTime"}},[t("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期"},model:{value:e.addForm.checkTime,callback:function(t){e.$set(e.addForm,"checkTime",t)},expression:"addForm.checkTime"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveAddForm}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"巡检审核",visible:e.auditDialogVisible},on:{"update:visible":function(t){e.auditDialogVisible=t}}},[t("div",{staticStyle:{display:"flex"}},[t("div",{staticStyle:{width:"800px","margin-top":"-20px","border-right":"1px solid #eee","margin-left":"30px"}},[t("div",{staticStyle:{"text-align":"right",width:"99%"}},[t("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(t){return e.update(0)}}},[e._v("不通过")]),t("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){return e.update(1)}}},[e._v("通过审批")])],1)])]),t("input",{ref:"inputRef",staticStyle:{width:"0",height:"0",border:"0",margin:"0",padding:"0"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.update(1)}}})]),t("el-dialog",{attrs:{title:"提示",visible:e.dialogFormVisible,"before-close":e.closeIcon},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"请输入审核意见",prop:"inputValidator"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.inputValidator,callback:function(t){e.$set(e.form,"inputValidator",t)},expression:"form.inputValidator"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.clearform}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.UserSave}},[e._v("确 定")])],1)],1)],1)}),[],!1,null,"e6ad8fdc",null);t.default=o.exports},"069e":function(e,t,a){"use strict";a("b33a")},"13e7":function(e,t,a){},"29a9":function(e,t,a){},3492:function(e,t,a){"use strict";a.r(t);a("b0c0"),a("ac1f"),a("841c");var i=a("c7eb"),r=a("1da1"),s=(a("d9e2"),a("99af"),a("caad"),a("d81d"),a("14d9"),a("fb6a"),a("a434"),a("d3b7"),a("4d63"),a("c607"),a("2c3e"),a("25f0"),a("5319"),a("159b"),a("365c")),l=a("2ef0"),n=a("5a0c"),o=a.n(n),c={data:function(){(new Date).getTime();return{StartDatetions:{disabledDate:function(e){return e.getTime()>new Date}},options3:[{value:1,label:"市政移交"},{value:2,label:"自建"},{value:3,label:"其他单位"},{value:4,label:"雪亮工程"}],actions:s.qb.uploadCheckPicture,tableData:[],permissionBtnList:[],option:[],option2:[],option3:[{value:1,label:"正常"},{value:2,label:"异常"},{value:3,label:"无"}],pageindex:1,pagesize:10,totalPages:0,totalRecords:0,opTitle:"",visible:!1,visible2:!1,id:"",companyName:"",name:"",phone:"",wellNo:"",reportLocation:"",checkTime:"",search:{id:"",name:"",wellNo:"",reportLocation:"",companyName:"",assetPropertyId:"",valueTime:this.initValueTime()},main:{id:"",companyName:"",name:"",phone:"",wellNo:"",reportLocation:"",checkTime:"",reportFailureId:"",isReportFailure:"",checkType:"",checkMethod:"",checkResult:"",checkContent:"",remark:"",fileIds:""},uploadUrl:"",fileList:[],gosPhotoList:[],strongCurrentPhotoList:[],otherPhotoList:[],srcList:[],lastFileList:[],lastGosPhotoList:[],lastStrongCurrentPhotoList:[],lastOtherPhotoList:[],srcList1:[],sign2:null,dialogVisible:!1,dialogImageUrl:"",userSaveLoading:!1,list:[{mcId:"",checkType:"",checkMethod:"",checkResult:"",checkContent:"",remark:"",checkTypeText:"",file:[],srcList:[]}],companyList:[],nums:[],checkUsers:[],showAddModal:!1,addLoading:!1,addForm:{defaultImages:[],obj:null,fileIds:[],checkTime:"",checkResult:1,checkerId:"",gosPhoto:[],strongCurrentPhoto:[],otherPhoto:[],remark:void 0},addFormRule:{checkTime:[{required:!0,message:"必填",trigger:["change","blur"]}],checkResult:[{required:!0,message:"必填",trigger:["change","blur"]}],checkerId:[{required:!0,message:"必填",trigger:["change","blur"]}],obj:[{required:!0,message:"必填",trigger:["change","blur"]}],gosPhoto:[{required:!0,message:"请上传气体监测照片",trigger:"change"},{validator:function(e,t,a){t&&t.length>5?a(new Error("最多上传五张图片")):a()},trigger:"change"}],defaultImages:[{required:!0,message:"请上传本次巡检图片",trigger:"blur"}],strongCurrentPhoto:[{required:!0,message:"请上传强电监测照片",trigger:"blur"}]}}},created:function(){this.bind(),this.companyLists(),this.btnList(),this.getAllCheckUser(),this.debounceSaveAddForm=Object(l.debounce)(this.saveAddForm,500)},mounted:function(){},methods:{initValueTime:function(){var e=new Date,t=o()(e).format("YYYY"),a=o()(e).format("MM"),i="12"==a?1*t+1:t,r="12"==a?1:1*a+1;return["".concat(t,"-").concat(a,"-01 "),o()(new Date("".concat(i,"-").concat(r,"-01")).getTime()-1).format("YYYY-MM-DD ")]},handleExceed:function(){return this.$message.warning("最多只能上传 5 张照片"),!1},uploadHandleChange:function(e,t,a){var i=this;if("success"==e.status&&t.length>2)return this.$message.error("最多只能上传 2 张照片"),t.forEach((function(t){t.uid==e.uid&&i.deleteStr(t.response.data.id)})),t=t.slice(0,-1),1==a&&(this.addForm.defaultImages=t),2==a&&(this.addForm.gosPhoto=t),3==a&&(this.addForm.strongCurrentPhoto=t),void(4==a&&(this.addForm.otherPhoto=t))},beforeAvatarUpload:function(e){var t=["image/jpeg","image/jpg","image/png"].includes(e.type);return this.addForm.gosPhoto.length>5&&this.handleExceed(),t||this.$message.error("上传图片只能是 JPG、JPEG、PNG 格式!"),t},getNums:function(e){var t=this;""!==e&&Object(s.Wb)({wellNo:e}).then((function(e){t.nums=e.data}))},setDefaultPicture:function(e){var t=this;Object(s.Rb)({picList:e.picList}).then((function(e){t.main.fileIds="",e.data.forEach((function(e){t.main.fileIds+=e.id+","})),e.data&&Array.isArray(e.data)&&(t.addForm.defaultImages=[],t.addForm.gosPhoto=[],t.addForm.strongCurrentPhoto=[],t.addForm.otherPhoto=[],e.data.map((function(e){var a={name:e.fileName,url:e.ossUrl,id:e.id};1!=e.type&&null!=e.type||t.addForm.defaultImages.push(a),2==e.type&&t.addForm.gosPhoto.push(a),3==e.type&&t.addForm.strongCurrentPhoto.push(a),4==e.type&&t.addForm.otherPhoto.push(a)})))}))},searchMethod:function(){this.pageindex=1,this.bind(!1)},bind:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$loading({lock:!0,text:"正在加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t.next=3,Object(s.zd)({pageIndex:e.pageindex,pagesize:e.pagesize,id:e.search.id,wellNo:e.search.wellNo,name:e.search.name,companyName:e.search.companyName,reportLocation:e.search.reportLocation,startTime:e.search.valueTime&&e.search.valueTime.length?e.search.valueTime[0]:void 0,endTime:e.search.valueTime&&e.search.valueTime.length?e.search.valueTime[1]:void 0,assetProperty:e.search.assetPropertyId});case 3:if(0!==(r=t.sent).resultCode){t.next=12;break}a.close(),e.tableData=r.data,e.pageindex=r.currentPage,e.totalPages=r.totalPages,e.totalRecords=r.count,t.next=15;break;case 12:return a.close(),e.$message.error(r.resultMsg),t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t)})))()},btnList:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.Nc)({roleSysno:e.$cookies.get("Role_Sysno"),url:"inspectionManage"}).then((function(t){if("0"!=t.resultCode)return"2024"==t.resultCode?(e.$message.error("token失效!请重新登录"),e.$router.push({path:"/login"})):e.$message.error(t.resultMsg),!1;t.data.forEach((function(t){e.permissionBtnList.push(t.phoneurl)}))}));case 2:case"end":return t.stop()}}),t)})))()},edit:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.main.wellNo=e.wellNo,t.opTitle=t.main.wellNo+"--巡检信息",t.main.id=e.id,t.main.companyName=e.companyName,t.main.name=e.name,t.main.phone=e.phone,t.main.reportLocation=e.reportLocation,t.main.reportFailureId=e.reportFailureId,t.main.isReportFailure=e.isReportFailure,t.main.checkTime=t.timestampToDate(e.checkTime),t.fileList=[],t.lastFileList=[],t.lastGosPhotoList=[],t.lastStrongCurrentPhotoList=[],t.lastOtherPhotoList=[],t.findDic("checkType",t.option),t.findDic("checkMethod",t.option2),t.picture(e.fileIds),t.lastPicture(e.wellNo,t.main.checkTime),a.next=21,Object(s.A)({token:t.$cookies.get("token_pipe"),checkId:e.id});case 21:if("0"!==(r=a.sent).resultCode){a.next=26;break}t.list=r.data,a.next=28;break;case 26:return t.$message.error(r.resultMsg),a.abrupt("return",!1);case 28:t.visible=!0;case 29:case"end":return a.stop()}}),a)})))()},detail:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r,l,n;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.main.wellNo=e.wellNo,t.opTitle=t.main.wellNo+"--详情",t.main.id=e.id,t.main.companyName=e.companyName,t.main.name=e.name,t.main.phone=e.phone,t.main.reportLocation=e.reportLocation,t.main.reportFailureId=e.reportFailureId,t.main.checkTime=e.checkTime,t.fileList=[],t.gosPhotoList=[],t.strongCurrentPhotoList=[],t.otherPhotoList=[],t.lastFileList=[],t.lastGosPhotoList=[],t.lastStrongCurrentPhotoList=[],t.lastOtherPhotoList=[],t.picture(e.fileIds),t.lastPicture(e),a.next=21,Object(s.A)({token:t.$cookies.get("token_pipe"),checkId:e.id});case 21:if("0"!==(r=a.sent).resultCode){a.next=38;break}t.list=r.data,l=0;case 25:if(!(l<t.list.length)){a.next=36;break}if(r.data[l].file=[],r.data[l].srcList=[],null==t.list[l].fileIds){a.next=33;break}return a.next=31,Object(s.Mb)({fileIds:t.list[l].fileIds});case 31:"0"===(n=a.sent).resultCode?null!=n.data&&n.data.forEach((function(e){var a={name:e.fileName,url:e.url};t.list[l].file.push(a),t.list[l].srcList.push(e.url)})):"2"===n.resultCode&&t.$message.error(n.resultMsg);case 33:l++,a.next=25;break;case 36:a.next=40;break;case 38:return t.$message.error(r.resultMsg),a.abrupt("return",!1);case 40:t.visible2=!0;case 41:case"end":return a.stop()}}),a)})))()},picture1:function(e,t){var a=this;return Object(r.a)(Object(i.a)().mark((function r(){var l;return Object(i.a)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(s.Mb)({fileIds:t});case 2:"0"===(l=i.sent).resultCode?null!=l.data&&l.data.forEach((function(t){var i={name:t.fileName,url:t.url};a.list[e].file.push(i),a.list[e].srcList.push(t.url)})):"2"===l.resultCode&&a.$message.error(l.resultMsg);case 4:case"end":return i.stop()}}),r)})))()},picture:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(s.Lb)({fileIds:e});case 2:"0"===(r=a.sent).resultCode?0==t.fileList.length&&null!=r.data&&r.data.forEach((function(e){var a=new Object;a.name=e.fileName,a.url=e.url,1!=e.type&&null!=e.type||t.fileList.push(a),2==e.type&&t.gosPhotoList.push(a),3==e.type&&t.strongCurrentPhotoList.push(a),4==e.type&&t.otherPhotoList.push(a),t.srcList.push(e.url)})):"2"===r.resultCode&&t.$message.error(r.resultMsg);case 4:case"end":return a.stop()}}),a)})))()},lastPicture:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=3,Object(s.Ob)({wellNo:e.wellNo,checkTime:e.checkTime,id:e.id,wellId:e.wellId});case 3:"0"===(r=a.sent).resultCode?0==t.lastFileList.length&&null!=r.data&&r.data.forEach((function(e){var a=new Object;a.name=e.fileName,a.url=e.url,a.id=e.id,1!=e.type&&null!=e.type||(t.lastFileList.push(a),t.srcList1.push(e.url)),2==e.type&&t.lastGosPhotoList.push(a),3==e.type&&t.lastStrongCurrentPhotoList.push(a),4==e.type&&t.lastOtherPhotoList.push(a)})):"2"===r.resultCode&&t.$message.error(r.resultMsg);case 5:case"end":return a.stop()}}),a)})))()},newCheckType:function(){this.list.push({mcId:"",checkType:"",checkMethod:"",checkResult:"",checkContent:"",remark:""})},del:function(e,t){this.list.splice(t,1)},submitUpload:function(){var e=this;this.$confirm("是否上传图片，上传后不可更改?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$refs.upload.submit()})).catch((function(){}))},addCheckFiles:function(e){var t=e.data.id;null==this.main.fileIds?this.main.fileIds=t:this.main.fileIds=this.main.fileIds+","+t,this.sign2=1},isNull:function(e,t){return e=null==e?t:e+","+t},handleRemove:function(e,t,a,i){this.deleteStr(e.response&&e.response.data&&e.response.data.id||e.id),1==i&&(this.addForm.defaultImages=this.delPhoto(this.addForm.defaultImages,e.uid)),2==i&&(this.addForm.gosPhoto=this.delPhoto(this.addForm.gosPhoto,e.uid)),3==i&&(this.addForm.strongCurrentPhoto=this.delPhoto(this.addForm.strongCurrentPhoto,e.uid)),4==i&&(this.addForm.otherPhoto=this.delPhoto(this.addForm.otherPhoto,e.uid))},delPhoto:function(e,t){for(var a=[],i=0;i<e.length;i++)e[i].uid===t&&(a=a.concat(e.splice(i,1)),i--);return e},deleteStr:function(e){var t=new RegExp(e+",?","g");null==this.main.fileIds&&(this.main.fileIds=""),this.main.fileIds=String(this.main.fileIds).replace(t,""),this.main.fileIds=String(this.main.fileIds).replace(/,$/,"")},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},companyLists:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.companyList=[],t.next=3,Object(s.bc)({});case 3:"0"==(a=t.sent).resultCode&&a.data.forEach((function(t){var a=new Object;a.value=t.name,a.label=t.name,e.companyList.push(a)}));case 5:case"end":return t.stop()}}),t)})))()},Save:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a,r,l;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$cookies.get("Sysno"),e.sign2=0,e.userSaveLoading=!0,r=[],{list:e.list},e.list.map((function(e){var t={mcId:e.id,checkType:e.checkType,checkMethod:e.checkMethod,checkResult:e.checkResult,checkContent:e.checkContent,remark:e.remark};r.push(t)})),t.next=9,Object(s.kb)({wellNo:e.main.wellNo,id:e.main.id,companyName:e.main.companyName,name:e.main.name,phone:e.main.phone,reportLocation:e.main.reportLocation,reportFailureId:e.main.reportFailureId,isReportFailure:e.main.isReportFailure,checkTime:e.main.checkTime,fileIds:e.main.fileIds,gosPhotoIds:e.main.gosPhotoIds,strongCurrentPhotoIds:e.main.strongCurrentPhotoIds,otherPhotoIds:e.main.otherPhotoIds,checkList:r,createUserNo:a});case 9:if("0"!==(l=t.sent).resultCode){t.next=16;break}e.$message.success("保存成功"),e.bind(),e.visible=!1,t.next=18;break;case 16:return e.$message.error(l.resultMsg),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t)})))()},findDic:function(e,t){return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!=t.length){a.next=5;break}return a.next=3,Object(s.Gc)({typeCode:e});case 3:"0"==(r=a.sent).resultCode&&r.data.forEach((function(e){var a=new Object;a.value=e.value,a.label=e.text,t.push(a)}));case 5:case"end":return a.stop()}}),a)})))()},Clear:function(){this.search.id="",this.search.wellNo="",this.search.name="",this.search.companyName="",this.search.reportLocation="",this.search.valueTime="",this.search.assetPropertyId="",this.bind()},reflush:function(){this.pageindex=1,this.search.id="",this.search.wellNo="",this.search.name="",this.search.companyName="",this.search.reportLocation="",this.search.assetPropertyId="",this.search.valueTime="",this.bind()},timestampToDate:function(e){var t=new Date(e),a=t.getFullYear(),i=t.getMonth()+1,r=t.getDate(),s=t.getHours(),l=t.getMinutes(),n=t.getSeconds();return a+"-"+(i=i<10?"0"+i:i)+"-"+(r=r<10?"0"+r:r)+" "+(s=s<10?"0"+s:s)+":"+(l=l<10?"0"+l:l)+":"+(n=n<10?"0"+n:n)},handleCurrentChange:function(e){this.pageindex=e,this.bind()},handleSuccess:function(e,t,a,i){if("2"!=e.resultCode){var r=e.data&&e.data.id;null==this.main.fileIds||""==this.main.fileIds?this.main.fileIds=r:this.main.fileIds=this.main.fileIds+","+r,1!==i&&null!=i||this.addForm.defaultImages.push(t),2==i&&this.addForm.gosPhoto.push(t),3===i&&this.addForm.strongCurrentPhoto.push(t),4===i&&this.addForm.otherPhoto.push(t),this.$refs.addFormRef.validateField("gosPhoto"),this.$refs.addFormRef.validateField("defaultImages"),this.$refs.addFormRef.validateField("strongCurrentPhoto")}else{this.$message.error(e.resultMsg);var s=0;for(var l in a)if(a[l]==t){s=l;break}a.splice(s,1)}},getAllCheckUser:function(){var e=this;Object(s.sc)({roleNo:"20211215161704509894"}).then((function(t){e.checkUsers=t.data}))},cancel:function(){this.showAddModal=!1,this.$refs.addFormRef.resetFields(),this.$refs.uploadImages1.clearFiles(),this.$refs.uploadImages2.clearFiles(),this.$refs.uploadImages3.clearFiles(),this.$refs.uploadImages4.clearFiles(),this.addForm={obj:void 0,fileIds:[],checkTime:"",checkResult:1,checkerId:"",remark:void 0,defaultImages:[],gosPhoto:[],strongCurrentPhoto:[],otherPhoto:[]},this.main.fileIds=""},saveAddForm:function(){var e=this;this.$refs.addFormRef.validate((function(t){t&&(e.addLoading=!0,null==e.main.fileIds&&(e.main.fileIds=""),e.main.fileIds=String(e.main.fileIds).replace(/^,|,$/g,"").replace(/,,+/g,","),Object(s.f)({wellId:e.addForm.obj.id,wellNo:e.addForm.obj.wellNo,reportLocation:e.addForm.obj.roadSection,checkerId:e.addForm.checkerId,fileIds:e.main.fileIds,status:12,checkResult:e.addForm.checkResult,remark:e.addForm.remark,checkTime:e.addForm.checkTime}).then((function(t){0==t.resultCode&&(e.$message.success("新增成功"),e.cancel())})).finally((function(){e.addLoading=!1})))}))}}},d=(a("5c9b"),a("e851"),a("2877")),u=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"page_content"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card_body"},[t("page-main",[t("g-page-lable",{scopedSlots:e._u([{key:"left",fn:function(){return[t("div",{staticClass:"filter_container"},[t("el-form",{attrs:{inline:!0,"v-model":e.search}},[t("el-form-item",{attrs:{label:"巡检编号:"}},[t("el-input",{staticClass:"w200",attrs:{placeholder:"请输入巡检编号",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchMethod()}},model:{value:e.search.id,callback:function(t){e.$set(e.search,"id",t)},expression:"search.id"}})],1),t("el-form-item",{staticStyle:{"padding-left":"20px"},attrs:{label:"巡检时间:"}},[t("el-date-picker",{staticStyle:{width:"410px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd "},on:{change:e.changeTime},model:{value:e.search.valueTime,callback:function(t){e.$set(e.search,"valueTime",t)},expression:"search.valueTime"}})],1),t("el-form-item",{staticStyle:{"padding-left":"20px"},attrs:{label:"巡检人员:"}},[t("el-input",{staticClass:"w200",attrs:{placeholder:"请输入巡检人员",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchMethod()}},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),t("el-form-item",{staticStyle:{"padding-left":"20px"},attrs:{label:"井编号:"}},[t("el-input",{staticClass:"w200",attrs:{placeholder:"请输入井编号",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchMethod()}},model:{value:e.search.wellNo,callback:function(t){e.$set(e.search,"wellNo",t)},expression:"search.wellNo"}})],1),t("br"),t("el-form-item",{attrs:{label:"位置:"}},[t("el-input",{staticClass:"w200",attrs:{placeholder:"请输入位置",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchMethod()}},model:{value:e.search.reportLocation,callback:function(t){e.$set(e.search,"reportLocation",t)},expression:"search.reportLocation"}})],1),t("el-form-item",{staticStyle:{"padding-left":"15px"},attrs:{label:"巡检单位:"}},[t("el-select",{staticStyle:{width:"270px"},attrs:{placeholder:"请输入巡检单位",filterable:"","allow-create":"","default-first-option":""},model:{value:e.search.companyName,callback:function(t){e.$set(e.search,"companyName",t)},expression:"search.companyName"}},e._l(e.companyList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{staticStyle:{"padding-left":"20px"},attrs:{label:"资产属性:"}},[t("el-select",{attrs:{placeholder:"请选择资产属性"},model:{value:e.search.assetPropertyId,callback:function(t){e.$set(e.search,"assetPropertyId",t)},expression:"search.assetPropertyId"}},e._l(e.options3,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.searchMethod()}}},[e._v(" 搜索 ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",plain:""},on:{click:function(t){return e.Clear()}}},[e._v(" 重置 ")])],1)],1)],1)]},proxy:!0}])})],1),t("page-main",[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){e.showAddModal=!0}}},[e._v(" 新增 ")])],1),t("page-main",[t("div",{staticClass:"table_container"},[t("el-table",{attrs:{data:e.tableData,stripe:""}},[t("el-table-column",{attrs:{prop:"wellNo",label:"井编号",align:"center"}}),t("el-table-column",{attrs:{prop:"companyName",label:"巡检单位",align:"center"}}),t("el-table-column",{attrs:{prop:"assetProperty",label:"资产属性",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[1==a.row.assetProperty?t("span",[e._v("市政移交")]):2==a.row.assetProperty?t("span",[e._v("自建")]):3==a.row.assetProperty?t("span",[e._v("其他单位")]):4==a.row.assetProperty?t("span",[e._v("雪亮工程")]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"name",label:"巡检人员",align:"center"}}),t("el-table-column",{attrs:{prop:"phone",label:"联系方式",align:"center"}}),t("el-table-column",{attrs:{prop:"reportLocation",label:"位置",align:"center"}}),t("el-table-column",{attrs:{prop:"checkTime",label:"巡检时间",align:"center"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.detail(a.row)}}},[e._v("详情")])]}}])})],1),t("div",{staticClass:"pagenation"},[t("el-pagination",{attrs:{background:"","current-page":e.pageindex,"page-size":e.pagesize,layout:"total,prev, pager, next, jumper",total:e.totalRecords},on:{"current-change":e.handleCurrentChange}})],1)],1)])],1)]),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.opTitle,center:"",visible:e.visible,width:"60%","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t}}},[t("el-form",{ref:"main",staticStyle:{position:"relative","margin-left":"50px"},attrs:{model:e.main,"label-width":"150px",inline:!0}},[t("h3",[e._v("巡检")]),t("br"),t("el-form-item",{attrs:{label:"巡检编号:"}},[t("el-input",{attrs:{disabled:!0,clearable:""},model:{value:e.main.id,callback:function(t){e.$set(e.main,"id",t)},expression:"main.id"}})],1),t("el-form-item",{attrs:{label:"巡检单位:"}},[t("el-input",{staticStyle:{width:"250px"},attrs:{clearable:""},model:{value:e.main.companyName,callback:function(t){e.$set(e.main,"companyName",t)},expression:"main.companyName"}})],1),t("br"),t("el-form-item",{attrs:{label:"巡检人员:"}},[t("el-input",{model:{value:e.main.name,callback:function(t){e.$set(e.main,"name",t)},expression:"main.name"}})],1),t("el-form-item",{attrs:{label:"巡检人员联系方式:"}},[t("el-input",{staticStyle:{width:"250px"},attrs:{clearable:""},model:{value:e.main.phone,callback:function(t){e.$set(e.main,"phone",t)},expression:"main.phone"}})],1),t("br"),t("el-form-item",{attrs:{label:"井编号:"}},[t("el-input",{attrs:{disabled:!0,clearable:""},model:{value:e.main.wellNo,callback:function(t){e.$set(e.main,"wellNo",t)},expression:"main.wellNo"}})],1),t("el-form-item",{attrs:{label:"上报位置:"}},[t("el-input",{staticStyle:{width:"250px"},attrs:{clearable:""},model:{value:e.main.reportLocation,callback:function(t){e.$set(e.main,"reportLocation",t)},expression:"main.reportLocation"}})],1),t("br"),t("el-form-item",{attrs:{label:"巡检时间:"}},[t("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"","value-format":"yyyy-MM-dd "},model:{value:e.main.checkTime,callback:function(t){e.$set(e.main,"checkTime",t)},expression:"main.checkTime"}})],1),t("el-form-item",{attrs:{label:"保障ID:"}},[t("el-input",{staticStyle:{width:"250px"},attrs:{clearable:"",disabled:!0},model:{value:e.main.reportFailureId,callback:function(t){e.$set(e.main,"reportFailureId",t)},expression:"main.reportFailureId"}})],1),t("br"),t("el-form-item",{attrs:{label:"是否保障:"}},[t("el-input",{attrs:{disabled:!0,clearable:""},model:{value:e.main.isReportFailure,callback:function(t){e.$set(e.main,"isReportFailure",t)},expression:"main.isReportFailure"}})],1),t("br"),t("h3",[e._v("巡检明细")]),t("br"),t("div",[t("el-form-item",{attrs:{label:"巡检记录ID:"}},[t("el-input",{attrs:{disabled:!0},model:{value:e.main.id,callback:function(t){e.$set(e.main,"id",t)},expression:"main.id"}})],1),t("br"),e._l(e.list,(function(a,i){return t("div",{key:i},[t("el-form-item",{attrs:{label:"巡检项:"}},[t("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"",filterable:"","allow-create":"","default-first-option":""},model:{value:a.checkType,callback:function(t){e.$set(a,"checkType",t)},expression:"items.checkType"}},e._l(e.option,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{staticStyle:{"margin-left":"-70px"},attrs:{label:"巡检方法:"}},[t("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"",filterable:"","allow-create":"","default-first-option":""},model:{value:a.checkMethod,callback:function(t){e.$set(a,"checkMethod",t)},expression:"items.checkMethod"}},e._l(e.option2,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{staticStyle:{"margin-left":"-70px"},attrs:{label:"检测结果:"}},[t("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"",filterable:"","allow-create":"","default-first-option":""},model:{value:a.checkResult,callback:function(t){e.$set(a,"checkResult",t)},expression:"items.checkResult"}},e._l(e.option3,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:""}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.del(a,i)}}},[e._v("删除")])],1),t("br"),t("el-form-item",{attrs:{label:"检测内容:"}},[t("el-input",{staticStyle:{width:"630px"},attrs:{type:"textarea",clearable:""},model:{value:a.checkContent,callback:function(t){e.$set(a,"checkContent",t)},expression:"items.checkContent"}})],1),t("br"),t("el-form-item",{attrs:{label:"备注:"}},[t("el-input",{staticStyle:{width:"630px"},attrs:{type:"textarea",clearable:""},model:{value:a.remark,callback:function(t){e.$set(a,"remark",t)},expression:"items.remark"}})],1),t("br")],1)})),t("el-form-item",{staticStyle:{"margin-top":"10px","margin-left":"450px",position:"relative"},attrs:{label:""}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.newCheckType}},[e._v("添加巡检项")])],1)],2),t("el-form-item",{attrs:{label:"本次巡检附件上传:"}},[t("el-upload",{ref:"upload",attrs:{action:e.uploadUrl,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":function(t,a,i){return e.handleRemove(t,a,i)},"auto-upload":!1,"on-success":e.addCheckFiles,disabled:1==e.sign2,"file-list":e.fileList}},[t("i",{staticClass:"el-icon-plus"})]),t("el-button",{staticStyle:{"margin-left":"28px","margin-top":"5px"},attrs:{size:"small",type:"primary",disabled:1==e.sign2},on:{click:e.submitUpload}},[e._v(" 上传图片 ")])],1),t("br"),t("el-form-item",{attrs:{label:"上次巡检照片:"}},[t("div",{staticClass:"demo-image__preview"},e._l(e.lastFileList,(function(a,i){return t("el-image",{key:i,staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:a.url,"preview-src-list":e.srcList1}})})),1)])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",loading:e.userSaveLoading},on:{click:e.Save}},[e._v("确 定")])],1)],1),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.opTitle,center:"",visible:e.visible2,width:"954px","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible2=t}}},[t("el-form",{ref:"main",staticStyle:{"margin-left":"10px"},attrs:{model:e.main,inline:!0}},[t("div",{staticClass:"title"},[t("span",[e._v("巡检信息")])]),t("div",{staticClass:"box1",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1_left"},[t("div",{staticClass:"box1_left_left"},[e._v("巡检位置 :")]),t("div",{staticClass:"box1_left_right",attrs:{title:e.main.reportLocation}},[t("span",[e._v(e._s(e.main.reportLocation))])])]),t("div",{staticClass:"box1_right"},[t("div",{staticClass:"box1_left_left1"},[e._v("井编号 :")]),t("div",{staticClass:"box1_left_right"},[t("span",[e._v(e._s(e.main.wellNo))])])])]),t("div",{staticClass:"box1",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1_left"},[t("div",{staticClass:"box1_left_left"},[e._v("巡检编号 :")]),t("div",{staticClass:"box1_left_right"},[t("span",[e._v(e._s(e.main.id))])])]),t("div",{staticClass:"box1_right"},[t("div",{staticClass:"box1_left_left1"},[e._v("巡检单位:")]),t("div",{staticClass:"box1_left_right"},[t("span",[e._v(e._s(e.main.companyName))])])])]),t("div",{staticClass:"box1",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1_left"},[t("div",{staticClass:"box1_left_left"},[e._v("巡检人员 :")]),t("div",{staticClass:"box1_left_right"},[t("span",[e._v(e._s(e.main.name))])])]),t("div",{staticClass:"box1_right"},[t("div",{staticClass:"box1_left_left1"},[e._v("巡检时间 :")]),t("div",{staticClass:"box1_left_right"},[t("span",[e._v(e._s(e.main.checkTime))])])])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("本次巡检照片：")])])]),e.fileList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.fileList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("气体监测照片 ")])])]),e.gosPhotoList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.gosPhotoList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("强电监测照片")])])]),e.strongCurrentPhotoList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.strongCurrentPhotoList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("其他照片")])])]),e.otherPhotoList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.otherPhotoList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("上次巡检照片：")])])]),0!=e.lastFileList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.lastFileList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("上次气体监测照片：")])])]),0!=e.lastGosPhotoList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.lastGosPhotoList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("上次强电监测照片：")])])]),0!=e.lastStrongCurrentPhotoList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.lastStrongCurrentPhotoList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"upload"},[t("div",{staticClass:"upload_left"},[t("div",[t("span",[e._v("上次其他照片：")])])]),0!=e.lastOtherPhotoList.length?t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(e.lastOtherPhotoList,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1):t("div",{staticStyle:{"padding-top":"15px","padding-left":"10px"}},[e._v("暂无图片")])]),t("div",{staticClass:"title",staticStyle:{"margin-top":"30px"}},[t("span",[e._v("巡检明细")])]),t("div",e._l(e.list,(function(a,i){return t("div",{key:i},[t("div",{staticClass:"box1",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1_left"},[t("div",{staticClass:"box1_left_left"},[e._v("巡检项 :")]),t("div",{staticClass:"box1_left_right"},[t("span",[e._v(e._s(a.checkTypeText))])])]),t("div",{staticClass:"box1_right"},[t("div",{staticClass:"box1_left_left1"},[e._v("巡检结果 :")]),t("div",{staticClass:"box1_left_right"},[1==a.checkResult?t("span",[e._v("正常")]):e._e(),2==a.checkResult?t("span",[e._v("异常")]):e._e(),3==a.checkResult?t("span",[e._v("无")]):e._e()])])]),2==a.checkResult?t("div",{staticClass:"box_1",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1_left",staticStyle:{"margin-top":"20px"}},[t("div",{staticClass:"box1_left_left"},[e._v("备注 :")]),t("div",{staticClass:"box1_left_right1"},[t("span",[e._v(e._s(a.remark))])])]),t("div",{staticClass:"upload"},[t("div",{staticStyle:{width:"50%",display:"flex"}},[t("div",{staticClass:"upload_left"},[t("div",{staticClass:"upload_bottom"},[t("span",[e._v("照片 ：")])])]),t("div",{staticClass:"demo-image__preview",staticStyle:{"margin-left":"15px"}},e._l(a.file,(function(e,a){return t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})})),1)])])]):e._e()])})),0)])],1),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})]),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{visible:e.showAddModal,title:"新增巡检","before-close":e.cancel},on:{"update:visible":function(t){e.showAddModal=t},close:e.cancel}},[t("el-form",{ref:"addFormRef",staticClass:"woderClass",attrs:{model:e.addForm,rules:e.addFormRule,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"井编号:",prop:"obj"}},[t("el-select",{attrs:{clearable:"",filterable:"",remote:"",placeholder:"请输入","value-key":"id","remote-method":e.getNums},on:{clear:e.getNums},model:{value:e.addForm.obj,callback:function(t){e.$set(e.addForm,"obj",t)},expression:"addForm.obj"}},e._l(e.nums,(function(e,a){return t("el-option",{key:a,attrs:{value:e,label:e.wellNo}})})),1)],1),t("el-form-item",{attrs:{label:"异常情况",prop:"status"}},[t("el-radio-group",{model:{value:e.addForm.status,callback:function(t){e.$set(e.addForm,"status",t)},expression:"addForm.status"}},[t("el-radio",{attrs:{label:1}},[e._v("正常")]),t("el-radio",{attrs:{label:2}},[e._v("异常")])],1),2===e.addForm.status?t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入异常情况"},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}}):e._e()],1),t("el-form-item",{attrs:{label:"巡检人员",prop:"checkerId"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.checkerId,callback:function(t){e.$set(e.addForm,"checkerId",t)},expression:"addForm.checkerId"}},e._l(e.checkUsers,(function(e){return t("el-option",{key:e.sysno,attrs:{label:e.name,value:e.sysno}})})),1)],1),t("el-form-item",{attrs:{label:"巡检时间",prop:"checkTime"}},[t("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.StartDatetions,type:"date",placeholder:"选择日期"},model:{value:e.addForm.checkTime,callback:function(t){e.$set(e.addForm,"checkTime",t)},expression:"addForm.checkTime"}})],1),null!=e.addForm.checkTime&&""!==e.addForm.checkTime?t("el-form-item",{attrs:{label:"本次巡检图片",prop:"defaultImages"}},[t("el-upload",{ref:"uploadImages1",attrs:{action:e.actions,data:{checkTime:e.addForm.checkTime,temp:1},limit:5,"file-list":e.addForm.defaultImages,"list-type":"picture-card","on-success":function(t,a,i){return e.handleSuccess(t,a,i,1)},"on-preview":e.handlePictureCardPreview,"on-remove":function(t,a,i){return e.handleRemove(t,a,i,1)},"on-change":function(t,a){return e.uploadHandleChange(t,a,1)},"before-upload":e.beforeAvatarUpload,"before-exceed":e.handleExceed}},[t("i",{staticClass:"el-icon-plus"})])],1):e._e(),null!=e.addForm.checkTime&&""!==e.addForm.checkTime?t("el-form-item",{attrs:{label:"气体监测照片",prop:"gosPhoto",required:""}},[t("el-upload",{ref:"uploadImages2",attrs:{action:e.actions,data:{checkTime:e.addForm.checkTime,temp:2},"file-list":e.addForm.gosPhoto,"list-type":"picture-card","on-success":function(t,a,i){return e.handleSuccess(t,a,i,2)},"on-preview":e.handlePictureCardPreview,"on-remove":function(t,a,i){return e.handleRemove(t,a,i,2)},"before-upload":e.beforeAvatarUpload,"before-exceed":e.handleExceed,"on-change":function(t,a){return e.uploadHandleChange(t,a,2)}}},[t("i",{staticClass:"el-icon-plus"})])],1):e._e(),null!=e.addForm.checkTime&&""!==e.addForm.checkTime?t("el-form-item",{attrs:{label:"强电监测照片",prop:"strongCurrentPhoto"}},[t("el-upload",{ref:"uploadImages3",attrs:{action:e.actions,data:{checkTime:e.addForm.checkTime,temp:3},limit:5,"file-list":e.addForm.strongCurrentPhoto,"list-type":"picture-card","on-success":function(t,a,i){return e.handleSuccess(t,a,i,3)},"on-preview":e.handlePictureCardPreview,"on-remove":function(t,a,i){return e.handleRemove(t,a,i,3)},"before-upload":e.beforeAvatarUpload,"before-exceed":e.handleExceed,"on-change":function(t,a){return e.uploadHandleChange(t,a,3)}}},[t("i",{staticClass:"el-icon-plus"})])],1):e._e(),null!=e.addForm.checkTime&&""!==e.addForm.checkTime?t("el-form-item",{attrs:{label:"其他照片",prop:"otherPhoto"}},[t("el-upload",{ref:"uploadImages4",attrs:{action:e.actions,data:{checkTime:e.addForm.checkTime,temp:4},limit:5,"file-list":e.addForm.otherPhoto,"list-type":"picture-card","on-success":function(t,a,i){return e.handleSuccess(t,a,i,4)},"on-preview":e.handlePictureCardPreview,"on-remove":function(t,a,i){return e.handleRemove(t,a,i,4)},"before-upload":e.beforeAvatarUpload,"on-change":function(t,a){return e.uploadHandleChange(t,a,4)}}},[t("i",{staticClass:"el-icon-plus"})])],1):e._e()],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.debounceSaveAddForm}},[e._v("确 定")])],1)],1)],1)])}),[],!1,null,"269c38b4",null);t.default=u.exports},"4d8a":function(e,t,a){},"5c9b":function(e,t,a){"use strict";a("addd")},"639f":function(e,t,a){"use strict";a("4d8a")},"6ff3":function(e,t,a){"use strict";a("7511")},7511:function(e,t,a){},"7af8":function(e,t,a){},a312:function(e,t,a){"use strict";a("7af8")},addd:function(e,t,a){},b33a:function(e,t,a){},b5d7:function(e,t,a){"use strict";a.r(t);a("b0c0");var i=a("c7eb"),r=a("1da1"),s=(a("a15b"),a("14d9"),a("e9c4"),a("d3b7"),a("4d63"),a("c607"),a("ac1f"),a("2c3e"),a("00b4"),a("25f0"),a("3ca3"),a("5319"),a("159b"),a("ddb0"),a("2b3d"),a("9861"),a("88a7"),a("271a"),a("5494"),a("365c")),l={filters:{dateFormat:function(e){var t=new Date(e),a=t.getFullYear(),i=t.getMonth()+1;i=i<10?"0"+i:i;var r=t.getDate();r=r<10?"0"+r:r;var s=t.getHours();s=s<10?"0"+s:s;var l=t.getMinutes();l=l<10?"0"+l:l;var n=t.getSeconds();return a+"-"+i+"-"+r+" "+s+":"+l+":"+(n=n<10?"0"+n:n)},getDate:function(e,t){if(!e)return"";if(e&&13!=e.length){e&&10==e.length&&(e=parseInt(e+"000"));for(var a=0;a<13;a++)e.length===a&&(e=parseInt(e*(10^13-a)))}var i=new Date(e),r={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};for(var s in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?r[s]:("00"+r[s]).substr((""+r[s]).length)));return t}},data:function(){return{fileListPopoverFlag:!1,catalogTitle:"",allowFormats:["txt","png","doc","ppt","xls","mp4","jpg","gif","xlsx","docx","rar","zip","7z","pdf","dwg"],pageindex:1,pagesize:10,totalRecords:0,searchFileTitle:"",value1:"",tableData:[],dirDataList:[],dataForm:{id:"",fileName:"",fileRemark:"",parentId:"",parentName:"",uploaderField:"",uploadTime:"",resource:"0",userid:"",checkStation:""},dataFormRename:{id:"",fileName:"",parentId:"",parentName:"",uploaderField:"",uploadTime:"",resource:"",userid:""},rulesRename:{fileName:[{required:!0,message:"请填写名称",trigger:"change"}]},rules:{fileName:[{required:!0,message:"请填写名称",trigger:"change"}]},visible:!1,visible1:!1,catalogvisible:!1,catalogvisible1:!1,catalogvisible2:!1,renamevisible:!1,historyvisible:!1,fileList:[],uploadUrl:"",downloadUrl:"",fileListTreeProps:{label:"fileName",children:"children"},userid:this.$cookies.get("Sysno"),Sysno:"",SystemUserID:"",id:"",datas:{},ids:[],dataFormref1:{options:[],value:"",date1:"",date2:""},dataFormref2:{options:[],value:"",date1:""},rulesDataFormref:{date1:[{required:!0,message:"请选择日期",trigger:"change"}]},dataFormref3:{options:[],value:""},rules1:{value:[{required:!0,message:"请选择用户",trigger:"change"}]},deleteStation:1,tableDatas:[],inRoleSysno:"",shareid:"",arr:[],pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()}}}},computed:{upData:function(){return{fileManagement:JSON.stringify(this.dataForm)}},dataTime:function(){var e=(new Date).getTime(),t=Date.parse(this.dataFormref2.date1);return parseInt((t-e)/864e5+1)}},watch:{"dataForm.resource":{handler:function(){this.$refs.dataForm.clearValidate(["fileName"])}}},mounted:function(){this.uploadUrl=s.qb.uploadFile,this.downloadUrl=s.qb.downloadUrl},created:function(){this.Sysno=this.$cookies.get("Sysno"),this.userid=this.$cookies.get("Sysno"),this.selectSysno(),this.resetSearchForm()},methods:{handlerUploadError:function(e,t,a){this.$message.error("文件上传失败")},dataTime1:function(e){var t=(new Date).getTime(),a=Date.parse(e);return parseInt((a-t)/864e5+1)},createusers:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.xc)();case 2:a=t.sent,e.dataFormref3.options=a.data;case 4:case"end":return t.stop()}}),t)})))()},OperatingHistory:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.historyvisible=!0,a.next=3,Object(s.vd)({id:e.id});case 3:"0"===(r=a.sent).resultCode?t.tableDatas=r.data:t.$message.error("无记录");case 6:case"end":return a.stop()}}),a)})))()},passed:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=4,Object(s.Pd)({id:e.id,checkStation:"0"});case 4:if("0"!==a.sent.resultCode){a.next=12;break}return t.$message.success("审核通过"),a.next=10,t.getFileList();case 10:a.next=13;break;case 12:t.$message.error("审核未通过");case 13:case"end":return a.stop()}}),a)})))()},add:function(e){this.visible1=!0,this.dataForm.id=e.id,this.dataForm.parentId=e.id,this.dataForm.parentName=e.fileName,this.dataForm.uploaderField=this.Sysno,this.dataForm.userid=e.uploaderField,this.dataForm.visible=e.visible,"0"==this.inRoleSysno?this.dataForm.checkStation="0":this.dataForm.checkStation="1"},fileChange:function(){},closeFile:function(){this.visible1=!1,this.clearDataForm()},closeFile1:function(){this.renamevisible=!1},closeDialog:function(){this.clearDataForm()},selectSysno:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.xd)({sysno:e.Sysno});case 2:return a=t.sent,e.inRoleSysno=a.data.inRoleSysno,"0"!==e.inRoleSysno&&(e.dataFormref3.value=a.data.sysno),t.next=7,e.getFileList();case 7:case"end":return t.stop()}}),t)})))()},allocation:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.catalogvisible1=!0,a.next=3,Object(s.xc)();case 3:r=a.sent,t.dataFormref1.options=r.data,t.id=e.id,t.datas=e;case 7:case"end":return a.stop()}}),a)})))()},share:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.catalogvisible2=!0,a.next=3,Object(s.xc)({sysno:e.userId});case 3:r=a.sent,t.dataFormref2.options=r.data,t.shareid=e.id;case 6:case"end":return a.stop()}}),a)})))()},saveshare:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(r.a)(Object(i.a)().mark((function e(a){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=14;break}return e.next=3,Object(s.Yd)({id:t.shareid,shareOne:t.dataFormref2.value,validTime:t.dataFormref2.date1});case 3:if("0"!==e.sent.resultCode){e.next=12;break}return e.next=7,t.getFileList();case 7:t.catalogvisible2=!1,t.$message.success("分享成功"),t.dataFormref2.value="",t.dataFormref2.date1="",t.shareid="";case 12:e.next=16;break;case 14:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},saveshareCancel:function(e){this.$refs[e].resetFields(),this.dataFormref2.value="",this.dataFormref2.date1="",this.shareid="",this.catalogvisible2=!1},dirCancel1:function(e){this.catalogvisible1=!1,this.$refs[e].resetFields()},saveTheUser:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(r.a)(Object(i.a)().mark((function e(a){var r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=19;break}return t.updateByIds(t.datas,t.ids),e.next=6,Object(s.ae)({ids:t.ids,userId:t.dataFormref1.value});case 6:if("0"!==(r=e.sent).resultCode){e.next=15;break}return t.$message.success("分配成功"),e.next=11,t.getFileList();case 11:t.catalogvisible1=!1,t.clearDataForm(),e.next=17;break;case 15:return t.$message.error(r.resultMsg),e.abrupt("return",!1);case 17:e.next=21;break;case 19:return t.$message.error("请选择用户"),e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},CloseAllocation:function(){this.dataFormref1.value=""},CloseAllocation1:function(){this.$refs.dataFormref2.resetFields(),this.dataFormref2.value="",this.dataFormref2.date1="",this.shareid=""},downloadFile:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r,l;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("0"!=e.isDir){a.next=4;break}return t.$message.warning("此文件夹为空！"),a.abrupt("return");case 4:return a.next=6,Object(s.ib)({id:e.id,openStyle:"inline"});case 6:if(r=a.sent,(l=document.createElement("a")).href=r.data,l.target="_blank",l.click(),document.body.appendChild(l),URL.revokeObjectURL(l.href),document.body.removeChild(l),"0"!==r.resultCode){a.next=18;break}t.getFileList(),a.next=21;break;case 18:return t.$message.error(r.resultMsg),t.getFileList(),a.abrupt("return",!1);case 21:case"end":return a.stop()}}),a)})))()},clearInput:function(){this.searchFileTitle="",this.userid="",this.getFileList()},downloadDir:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(s.ib)({id:e,openStyle:"attachment"});case 2:if("0"!==(r=a.sent).resultCode){a.next=8;break}t.$message.success("下载成功"),t.getFileList(),a.next=11;break;case 8:return t.$message.error(r.resultMsg),t.getFileList(),a.abrupt("return",!1);case 11:case"end":return a.stop()}}),a)})))()},reject:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(s.Y)({id:e.id});case 2:if("0"!==(r=a.sent).resultCode){a.next=8;break}t.getFileList(),t.$message.success("驳回成功"),a.next=11;break;case 8:return t.$message.error(r.resultMsg),t.getFileList(),a.abrupt("return",!1);case 11:case"end":return a.stop()}}),a)})))()},deletePassed:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.deleteStation=e.deleteStation,a.next=3,Object(s.Qd)({id:e.id,deleteStation:t.deleteStation+1,inRoleSySno:t.Sysno});case 3:if("0"!==(r=a.sent).resultCode){a.next=10;break}return t.$message.success("审核通过"),a.next=8,t.getFileList();case 8:a.next=14;break;case 10:return t.$message.error(r.resultMsg),a.next=13,t.getFileList();case 13:return a.abrupt("return",!1);case 14:case"end":return a.stop()}}),a)})))()},overrule:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.deleteStation=e.deleteStation,a.next=3,Object(s.Qd)({id:e.id,deleteStation:0,inRoleSySno:"0"});case 3:if("0"!==(r=a.sent).resultCode){a.next=10;break}return t.$message.success("驳回成功"),a.next=8,t.getFileList();case 8:a.next=14;break;case 10:return t.$message.error(r.resultMsg),a.next=13,t.getFileList();case 13:return a.abrupt("return",!1);case 14:case"end":return a.stop()}}),a)})))()},deleteAll:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var l,n,o;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:l=(new Date).getTime(),n=e.uploadTime,o=Date.parse(n),(l-o)/9e5>1?t.$confirm("是否确认删除该文件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r.a)(Object(i.a)().mark((function a(){return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(s.Qd)({id:e.id,deleteStation:"0"==t.inRoleSysno?2:1,inRoleSySno:"0"==t.inRoleSysno?t.Sysno:"0"});case 2:if("0"!==a.sent.resultCode){a.next=7;break}return t.$message.success("删除提交"),a.next=7,t.getFileList();case 7:case"end":return a.stop()}}),a)})))).catch(function(){var e=Object(r.a)(Object(i.a)().mark((function e(a){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$message.error(a.resultMsg),e.next=3,t.getFileList();case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):t.$confirm("是否确认删除该文件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.getIds(e,t.arr),a.next=3,Object(s.Z)({ids:t.arr});case 3:if("0"!==(r=a.sent).resultCode){a.next=11;break}return t.$message.success("删除成功"),t.arr=[],a.next=9,t.getFileList();case 9:a.next=13;break;case 11:return t.$message.error(r.resultMsg),a.abrupt("return",!1);case 13:case"end":return a.stop()}}),a)})))).catch((function(){return t.$message.info("已取消删除"),!1}));case 5:case"end":return a.stop()}}),a)})))()},getIds:function(e,t){var a=this;t.push(e.id),e.children.forEach((function(e){a.getIds(e,t)}))},updateByIds:function(e,t){var a=this;t.push(e.id),e.children.forEach((function(e){a.updateByIds(e,t)}))},rename:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.renamevisible=!0,a.next=3,Object(s.wd)({id:e.id});case 3:r=a.sent,t.dataFormRename=r.data;case 5:case"end":return a.stop()}}),a)})))()},deleteDir:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.$confirm("是否确认删除该文件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r.a)(Object(i.a)().mark((function a(){var r,l,n,o;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("10000000000000000001"!==t.Sysno){a.next=14;break}return a.next=3,Object(s.Y)({id:e.id});case 3:if("0"!==(r=a.sent).resultCode){a.next=9;break}t.$message.success("删除成功"),t.getFileList(),a.next=12;break;case 9:return t.$message.error(r.resultMsg),t.getFileList(),a.abrupt("return",!1);case 12:a.next=32;break;case 14:if(l=(new Date).getTime(),n=e.uploadTime,!((l-n)/36e5>1)){a.next=21;break}t.$message.error("超出删除时间"),a.next=32;break;case 21:return a.next=23,Object(s.Y)({id:e.id});case 23:if("0"!==(o=a.sent).resultCode){a.next=29;break}t.$message.success("删除成功"),t.getFileList(),a.next=32;break;case 29:return t.$message.error(o.resultMsg),t.getFileList(),a.abrupt("return",!1);case 32:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}));case 1:case"end":return a.stop()}}),a)})))()},dirCancel:function(){this.catalogvisible=!1,this.visible=!1,this.clearDataForm()},updateDir:function(e){this.catalogTitle="编辑目录";this.catalogvisible=!0,this.dataForm.fileName=e.fileName,this.dataForm.parentName=e.parentName,this.dataForm.parentId=e.parentId,this.dataForm.id=e.id,this.dataForm.userid=e.userId,this.dataForm.uploaderField=e.uploaderField,this.dataForm.uploadTime=e.uploadTime,this.dataForm.resource=e.visible+""},addCatalogClik:function(){this.catalogTitle="新增目录";var e=this;e.clearDataForm(),e.catalogvisible=!0,this.$nextTick((function(){e.$refs.dataFormref.clearValidate()}))},addCatalog:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(s.sd)({id:e.dataForm.id,fileName:e.dataForm.fileName,parentId:e.dataForm.parentId,parentName:e.dataForm.parentName,isDir:e.dataForm.resource,visible:e.dataForm.visible,userId:e.dataForm.userid,uploaderField:e.dataForm.uploaderField});case 3:if("0"!==(a=t.sent).resultCode){t.next=11;break}e.getFileList(),e.visible1=!1,e.$message.success("新增成功"),e.clearDataForm(),t.next=14;break;case 11:return e.$message.error(a.resultMsg),e.getFileList(),t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t)})))()},CatalogSave:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=3,t.$refs[e].validate((function(e){if(!e)return!1;t.addCatalog()}));case 3:case"end":return a.stop()}}),a)})))()},CatalogSaveRename:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.Td)({id:e.dataFormRename.id,fileName:e.dataFormRename.fileName,parentId:e.dataFormRename.parentId,userId:e.Sysno});case 2:if("0"!=(a=t.sent).resultCode){t.next=10;break}return e.renamevisible=!1,t.next=7,e.getFileList();case 7:e.$message.success(a.resultMsg),t.next=11;break;case 10:e.$message.error(a.resultMsg);case 11:case"end":return t.stop()}}),t)})))()},fileSave:function(e){this.visible=!1,this.visible1=!1,this.clearDataForm(),this.getFileList(),this.$refs.upload.clearFiles()},handleUploadFiles:function(e,t){"0"==e.resultCode?this.$message.success("上传文件成功"):this.$message.error(e.resultMsg)},fileListTreeCurrentChangeHandle:function(e,t){this.dataForm.parentId=e.id,this.dataForm.parentName=e.fileName,this.dataForm.userid=this.Sysno,this.dataForm.uploaderField=this.Sysno,Array.isArray(e.children)&&0!=e.children.length||(this.fileListPopoverFlag=!1)},handlePreview:function(e){var t=e.name.split(".").pop().toLowerCase(),a=this.allowFormats.join(",");return-1===a.indexOf(t)?(this.$message.error("上传失败，仅允许上传 ".concat(a," 格式的文件")),!1):!(e.size>314572800)||(this.$message({message:"文件大小不能超过300M",type:"error",duration:1500}),!1)},resetSearchForm:function(){this.searchFileTitle="","0"!==this.inRoleSysno?this.dataFormref3.value=this.Sysno:this.dataFormref3.value="",this.getFileList()},handleCurrentChange:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.pageindex=e,t.getFileList();case 2:case"end":return a.stop()}}),a)})))()},getFileLists:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$loading({lock:!0,text:"正在加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t.next=3,Object(s.lc)({userId:e.dataFormref3.value,fileName:e.searchFileTitle});case 3:if("0"!=(r=t.sent).resultCode){t.next=9;break}r.data.uploadTime=e.tableData=r.data,t.next=12;break;case 9:return a.close(),e.$message.error(r.resultMsg),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t)})))()},getFileList:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function e(){var a,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.$loading({lock:!0,text:"正在加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),e.next=4,Object(s.kc)({inRoleSySno:t.inRoleSysno,pageNum:t.pageindex,pageSize:t.pagesize,userId:t.Sysno,fileName:t.searchFileTitle});case 4:if("0"!=(r=e.sent).resultCode){e.next=12;break}a.close(),r.data.uploadTime=t.tableData=r.data,t.createusers(),e.next=15;break;case 12:return a.close(),t.$message.error(r.resultMsg),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})))()},toAddFileDetail:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.clearDataForm(),e.visible=!0;case 2:case"end":return t.stop()}}),t)})))()},clearDataForm:function(){var e=this;this.dataForm={id:"",fileName:"",fileRemark:"",parentId:"",parentName:"",resource:"0",userid:"",uploaderField:"",checkStation:""},this.$nextTick((function(){e.$refs.dataForm.resetFields()}))},searchEnter:function(){""===this.searchFileTitle?this.clearInput():this.getFileList()}}},n=(a("6ff3"),a("ef12"),a("2877")),o=Object(n.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[t("page-main",[t("div",{staticClass:"search_form"},[t("el-form",{attrs:{inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"文件名称:"}},[t("el-input",{attrs:{placeholder:"请输入文件名称",clearable:""},on:{clear:function(t){return e.clearInput()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getFileLists.apply(null,arguments)}},model:{value:e.searchFileTitle,callback:function(t){e.searchFileTitle=t},expression:"searchFileTitle"}})],1),"0"==e.inRoleSysno?t("el-form-item",{attrs:{label:"文件归属人",prop:"value"}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"全部"},model:{value:e.dataFormref3.value,callback:function(t){e.$set(e.dataFormref3,"value",t)},expression:"dataFormref3.value"}},e._l(e.dataFormref3.options,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.sysno}})})),1)],1):e._e(),t("el-form-item",[t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getFileLists()}}},[e._v(" 搜 索 ")]),t("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-refresh"},on:{click:function(t){return e.resetSearchForm()}}},[e._v("重 置")])],1)],1)],1)]),t("page-main",[t("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.tableData,"row-key":"id",border:"","tree-props":{children:"children",hasChildren:"hasChildren"}}},[t("el-table-column",{attrs:{prop:"fileName",label:"名称",sortable:"",width:"600"},scopedSlots:e._u([{key:"default",fn:function(a){return["10000000000000000001"!=e.Sysno&&"私人文件"==a.row.fileName?t("span",[t("i",{staticClass:"el-icon-folder-opened"}),e._v("个人文件 ")]):t("span",[0==a.row.isDir?t("i",{staticClass:"el-icon-folder-opened"}):e._e(),1==a.row.isDir?t("i",{staticClass:"el-icon-document"}):e._e(),"借阅文件"==a.row.fileName?t("span",{class:a.row.deleteStation>=1&&a.row.deleteStation<3?"delete_line":"",staticStyle:{cursor:"pointer"}},[e._v(e._s(a.row.fileName))]):t("span",{class:a.row.deleteStation>=1&&a.row.deleteStation<3?"delete_line":"",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.downloadFile(a.row)}}},[e._v(e._s(a.row.fileName))]),"0"==a.row.shareOne&&e.dataTime1(a.row.validTime)>=1&&"0"!==e.inRoleSysno&&"借阅文件"==a.row.parentName?t("span",{staticClass:"timeOut"},[e._v("("+e._s(e.dataTime1(a.row.validTime))+"天后过期)")]):e._e()]),1==a.row.isDir&&"1"==a.row.checkStation?t("span",{attrs:{STYLE:"color: red;"}},[e._v("（待管理员确认）")]):e._e(),a.row.deleteStation>=1&&a.row.deleteStation<3?t("span",{attrs:{STYLE:" color: red;"}},[e._v("（待管理员确认）")]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"isDir",label:"类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[0===a.row.isDir?t("el-tag",{attrs:{size:"small"}},[e._v("目录")]):1===a.row.isDir?t("el-tag",{attrs:{size:"small",type:"success"}},[e._v("文件")]):e._e()]}}])}),"0"===e.inRoleSysno?t("el-table-column",{attrs:{prop:"belongName.name",label:"归属",width:"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[0!==a.row.parentId&&"0"===e.inRoleSysno?t("span",[e._v(e._s(a.row.useridName))]):e._e()]}}],null,!1,2812123460)}):e._e(),"0"!==e.inRoleSysno?t("el-table-column",{attrs:{prop:"belongName.name",label:"创建人",width:"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[0!==a.row.parentId&&"0"!==e.inRoleSysno?t("span",[e._v(e._s(a.row.uploaderFieldName))]):e._e(),5566===a.row.parentId&&"0"===e.inRoleSysno?t("el-button",{attrs:{type:"primary",icon:"el-icon-view",size:"mini"},on:{click:function(t){return e.allocation(a.row)}}}):e._e()]}}],null,!1,750146563)}):e._e(),t("el-table-column",{attrs:{label:"创建时间",width:"250"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.uploadTime))])]}}])}),t("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return["0"===e.inRoleSysno?t("div",[0!=a.row.isDir?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.downloadFile(a.row)}}},[e._v("下载")])],1):e._e(),1!=a.row.isDir?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.add(a.row)}}},[e._v("新增")])],1):e._e(),"1"==a.row.checkStation?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"danger"},on:{click:function(t){return e.passed(a.row)}}},[e._v("审核通过")])],1):e._e(),a.row.deleteStation>=1&&a.row.deleteStation<3&&a.row.inRoleSySno!==e.Sysno?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"danger"},on:{click:function(t){return e.deletePassed(a.row)}}},[e._v("审核通过")])],1):e._e(),"1"==a.row.checkStation?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"danger"},on:{click:function(t){return e.reject(a.row)}}},[e._v("驳回")])],1):e._e(),a.row.deleteStation>=1&&a.row.deleteStation<3?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"danger"},on:{click:function(t){return e.overrule(a.row)}}},[e._v("驳回")])],1):e._e(),0===a.row.isDir&&0!==a.row.parentId&&a.row.deleteStation<1?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.rename(a.row)}}},[e._v("重命名")])],1):e._e(),5565!==a.row.id&&5566!==a.row.id&&a.row.deleteStation<1?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.deleteAll(a.row)}}},[e._v("删除")])],1):e._e(),1==a.row.visible?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.share(a.row)}}},[e._v("分享")])],1):e._e(),0!==a.row.parentId?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.OperatingHistory(a.row)}}},[e._v("操作历史")])],1):e._e()],1):e._e(),"0"!==e.inRoleSysno?t("div",[5567!==a.row.id&&5566!==a.row.id&&0!=a.row.isDir&&a.row.deleteStation<1?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.downloadFile(a.row)}}},[e._v("下载")])],1):e._e(),1!=a.row.isDir&&5567!==a.row.id&&5567!==a.row.parentId&&5566!==a.row.id&&"1"!==a.row.isBorrow?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.add(a.row)}}},[e._v("新增")])],1):e._e(),5566!==a.row.parentId&&1===a.row.visible&&0===a.row.isDir&&0!==a.row.parentId&&"1"!==a.row.isBorrow?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.rename(a.row)}}},[e._v("重命名")])],1):e._e(),5566!==a.row.parentId&&1===a.row.visible&&0!==a.row.parentId&&a.row.deleteStation<1&&"1"!==a.row.isBorrow?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.deleteAll(a.row)}}},[e._v("删除")])],1):e._e(),0!==a.row.parentId&&1===a.row.visible&&a.row.deleteStation<1&&"1"!==a.row.isBorrow?t("el-button",{attrs:{type:"text",size:"small"}},[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.share(a.row)}}},[e._v("分享")])],1):e._e()],1):e._e()]}}])})],1),t("el-dialog",{attrs:{title:"新增",center:"",visible:e.visible1,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible1=t},close:function(t){return e.closeDialog()}}},[t("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules}},[t("el-form-item",{attrs:{prop:"resource"}},[t("el-radio",{attrs:{label:"0"},on:{change:function(t){return e.fileChange()}},model:{value:e.dataForm.resource,callback:function(t){e.$set(e.dataForm,"resource",t)},expression:"dataForm.resource"}},[e._v("文件夹")]),t("el-radio",{attrs:{label:"1"},on:{change:function(t){return e.fileChange()}},model:{value:e.dataForm.resource,callback:function(t){e.$set(e.dataForm,"resource",t)},expression:"dataForm.resource"}},[e._v("文件")])],1),"0"==e.dataForm.resource?t("el-form-item",{attrs:{label:"文件夹名称",prop:"fileName"}},[t("el-input",{model:{value:e.dataForm.fileName,callback:function(t){e.$set(e.dataForm,"fileName",t)},expression:"dataForm.fileName"}})],1):e._e(),"1"==e.dataForm.resource?t("el-form-item",{attrs:{label:"上传文件"}},[t("el-upload",{ref:"upload",attrs:{drag:"",action:e.uploadUrl,"file-list":e.fileList,"auto-upload":!0,data:e.upData,"before-upload":e.handlePreview,"on-success":e.handleUploadFiles,"on-error":e.handlerUploadError}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或 "),t("em",[e._v("点击上传")])]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("文件大小不能超过300M")])])],1):e._e()],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.closeFile()}}},[e._v("取 消")]),"0"==e.dataForm.resource?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.CatalogSave("dataForm")}}},[e._v("保 存")]):e._e(),"1"==e.dataForm.resource?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.fileSave(e.dataForm)}}},[e._v("保 存")]):e._e()],1)],1)],1),t("el-dialog",{attrs:{title:"重命名",center:"",visible:e.renamevisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.renamevisible=t}}},[t("el-form",{ref:"dataFormrefRename",attrs:{model:e.dataFormRename,rules:e.rulesRename}},["0"==e.dataForm.resource?t("el-form-item",{attrs:{label:"文件夹名称",prop:"fileName"}},[t("el-input",{model:{value:e.dataFormRename.fileName,callback:function(t){e.$set(e.dataFormRename,"fileName",t)},expression:"dataFormRename.fileName"}})],1):e._e()],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.closeFile1()}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.CatalogSaveRename()}}},[e._v("保 存")])],1)],1),t("el-dialog",{attrs:{title:"新增文件",center:"",visible:e.visible,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t}}},[t("el-form",{ref:"dataForm",attrs:{model:e.dataForm,"label-width":"130px",rules:e.rules}},[t("el-form-item",{attrs:{label:"上级菜单",prop:"parentId"}},[t("el-popover",{ref:"fileListPopover",attrs:{placement:"bottom-start",trigger:"click"}},[t("el-tree",{ref:"fileListTree",attrs:{data:e.dirDataList,props:e.fileListTreeProps,"node-key":"id","highlight-current":!0,"expand-on-click-node":!1},on:{"current-change":e.fileListTreeCurrentChangeHandle}})],1),t("el-input",{directives:[{name:"popover",rawName:"v-popover:fileListPopover",arg:"fileListPopover"}],staticStyle:{width:"210px"},attrs:{placeholder:"请选择上级菜单",readonly:!0},model:{value:e.dataForm.parentName,callback:function(t){e.$set(e.dataForm,"parentName",t)},expression:"dataForm.parentName"}})],1),t("el-form-item",{attrs:{label:"上传文件",rules:[{required:!0,message:"请选择文件",trigger:"change"}]}},[t("el-upload",{ref:"upload",attrs:{drag:"",accept:"*",action:e.uploadUrl,"file-list":e.fileList,"auto-upload":!1,data:e.upData,"before-upload":e.handlePreview,"on-error":e.handlerUploadError,"on-success":e.handleUploadFiles}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或 "),t("em",[e._v("点击上传")])]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("文件大小不能超过300M")])])],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.dirCancel()}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.fileSave(e.dataForm)}}},[e._v("保 存")])],1)],1),t("el-dialog",{attrs:{title:e.catalogTitle,center:"",visible:e.catalogvisible,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){e.catalogvisible=t}}},[t("el-form",{ref:"dataFormref",attrs:{model:e.dataForm,"label-width":"130px",rules:e.rules}},[t("el-form-item",{attrs:{label:"目录名称",prop:"fileName"}},[t("el-input",{staticStyle:{width:"210px"},attrs:{placeholder:"请输入目录名称"},model:{value:e.dataForm.fileName,callback:function(t){e.$set(e.dataForm,"fileName",t)},expression:"dataForm.fileName"}})],1),t("el-form-item",{attrs:{label:"上级菜单",prop:"parentId"}},[t("el-popover",{ref:"fileListPopover",attrs:{placement:"bottom-start",trigger:"click"},model:{value:e.fileListPopoverFlag,callback:function(t){e.fileListPopoverFlag=t},expression:"fileListPopoverFlag"}},[t("el-tree",{ref:"fileListTree",attrs:{data:e.dirDataList,props:e.fileListTreeProps,"node-key":"id","highlight-current":!0,"expand-on-click-node":!1},on:{"current-change":e.fileListTreeCurrentChangeHandle}})],1),t("el-input",{directives:[{name:"popover",rawName:"v-popover:fileListPopover",arg:"fileListPopover"}],staticStyle:{width:"210px"},attrs:{placeholder:"请选择上级菜单",readonly:!0},model:{value:e.dataForm.parentName,callback:function(t){e.$set(e.dataForm,"parentName",t)},expression:"dataForm.parentName"}})],1),t("el-form-item",{attrs:{label:"权限",prop:"resource"}},[t("el-radio",{attrs:{label:"0"},model:{value:e.dataForm.resource,callback:function(t){e.$set(e.dataForm,"resource",t)},expression:"dataForm.resource"}},[e._v("公开")]),t("el-radio",{attrs:{label:"1"},model:{value:e.dataForm.resource,callback:function(t){e.$set(e.dataForm,"resource",t)},expression:"dataForm.resource"}},[e._v("仅自己可见")])],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.dirCancel()}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.CatalogSave()}}},[e._v("保 存")])],1)],1),t("el-dialog",{attrs:{title:"修改归属人",center:"",visible:e.catalogvisible1,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){e.catalogvisible1=t},close:function(t){return e.CloseAllocation()}}},[t("el-form",{ref:"dataFormref1",attrs:{model:e.dataFormref1,"label-width":"130px",rules:e.rules1}},[t("el-form-item",{attrs:{label:"选择用户",prop:"value"}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.dataFormref1.value,callback:function(t){e.$set(e.dataFormref1,"value",t)},expression:"dataFormref1.value"}},e._l(e.dataFormref1.options,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.sysno}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.dirCancel1("dataFormref1")}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveTheUser("dataFormref1")}}},[e._v("保 存")])],1)],1),t("el-dialog",{attrs:{title:"分享",center:"",visible:e.catalogvisible2,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){e.catalogvisible2=t},close:function(t){return e.CloseAllocation1()}}},[t("el-form",{ref:"dataFormref2",attrs:{model:e.dataFormref2,rules:e.rulesDataFormref,"label-width":"130px"}},[t("el-form-item",{attrs:{label:"分享给",prop:"value"}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.dataFormref2.value,callback:function(t){e.$set(e.dataFormref2,"value",t)},expression:"dataFormref2.value"}},e._l(e.dataFormref2.options,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.sysno}})})),1)],1),t("el-form-item",{attrs:{label:"有效时间",prop:"date1"}},[t("el-col",{attrs:{span:11}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","picker-options":e.pickerOptions,format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd"},model:{value:e.dataFormref2.date1,callback:function(t){e.$set(e.dataFormref2,"date1",t)},expression:"dataFormref2.date1"}})],1),e.dataTime>=1?t("span",{staticClass:"timeOut"},[e._v("("+e._s(e.dataTime)+"天后过期)")]):e._e()],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.saveshareCancel("dataFormref2")}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveshare("dataFormref2")}}},[e._v("保 存")])],1)],1),t("el-dialog",{attrs:{title:"历史操作",center:"",visible:e.historyvisible,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(t){e.historyvisible=t}}},[[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableDatas,border:""}},[t("el-table-column",{attrs:{prop:"fileName",label:"操作类型",width:"250"},scopedSlots:e._u([{key:"default",fn:function(a){return[0==a.row.operationType?t("span",[e._v("创建文件夹:"+e._s(a.row.fileName))]):e._e(),1==a.row.operationType?t("span",[e._v("修改名称为:"+e._s(a.row.fileName))]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"userId",label:"用户",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.children.name)+" ")]}}])}),t("el-table-column",{attrs:{prop:"uploadTime",label:"时间"}})],1)]],2)],1)}),[],!1,null,"dde99524",null);t.default=o.exports},e851:function(e,t,a){"use strict";a("29a9")},ef12:function(e,t,a){"use strict";a("13e7")},fdcd:function(e,t,a){"use strict";a.r(t);a("ac1f"),a("841c");var i=a("c7eb"),r=a("1da1"),s=(a("14d9"),a("b0c0"),a("d3b7"),a("159b"),a("365c")),l={data:function(){return{addForm:{sendOrderName:""},options17:[],valueTime:"",tableData:[],permissionBtnList:[],recordData:[],option:[],option2:[],option3:[],pageindex:1,pagesize:10,totalPages:0,totalRecords:0,opTitle:"",visible:!1,visible2:!1,visible3:!1,id:"",checkerId:"",reportName:"",failureType:"",wellNo:"",status:"",reportTime:"",search:{id:"",startTime:"",endTime:"",status:"",checkerId:""},main:{id:"",wellNo:"",checkerId:"",failureType:"",failureDesc:"",reportName:"",reportTime:"",status:"",repairType:"",repairId:"",examineId:"",examineComment:"",fileIds:"",checkTypeText:"",remark:"",checkTime:"",checkAddress:""},rules:{sendOrderName:[{required:!0,message:"请选择指派人员",trigger:"change"}]},list:[{checkTypeText:"",remark:"",status:"",file:[],srcList:[]}],uploadUrl:"",fileList:[],srcList:[],sign2:null,dialogVisible:!1,dialogImageUrl:"",userSaveLoading:!1,record:{reportTime:"",reportName:""}}},created:function(){this.bind(),this.bindSearch(),this.statusSelects(),this.btnList()},mounted:function(){var e=this;this.uploadUrl=s.qb.uploadPicture,document.onkeydown=function(t){13==window.event.keyCode&&e.bind()}},methods:{changeTime:function(e){this.search.startTime=e[0],this.search.endTime=e[1]},UserSave:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(r.a)(Object(i.a)().mark((function e(a){var r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=15;break}return e.next=3,Object(s.Dd)({id:t.id,sendOrderName:t.addForm.sendOrderName});case 3:if("0"!==(r=e.sent).resultCode){e.next=11;break}t.$message.success("编辑成功"),t.bind(!1),t.visible3=!1,e.next=13;break;case 11:return t.$message.error(r.resultMsg),e.abrupt("return",!1);case 13:e.next=17;break;case 15:return e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},getReviewerName:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.options17=[],t.next=3,Object(s.Qb)({});case 3:"0"===(a=t.sent).resultCode?a.data.forEach((function(t){var a=new Object;a.label=t.name,a.value=t.sysno,e.options17.push(a)})):"2"===a.resultCode&&e.$message.error(a.resultMsg);case 6:case"end":return t.stop()}}),t)})))()},onDialog:function(){this.$refs.addForm.clearValidate()},sendOrder:function(e){null!=e&&(this.id=e.id),this.addForm={sendOrderName:""},this.opTitle="指派人员维护",this.visible3=!0,this.getReviewerName(),this.addForm.sendOrderName=e.sendOrderName},bind:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$loading({lock:!0,text:"正在加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t.next=3,Object(s.Ad)({token:e.$cookies.get("token_pipe"),pageIndex:e.pageindex,pagesize:e.pagesize,id:e.search.id,status:e.search.status,checkerId:e.search.checkerId,startTime:e.search.startTime,endTime:e.search.endTime});case 3:if(0!==(r=t.sent).resultCode){t.next=12;break}a.close(),e.tableData=r.data,e.pageindex=r.currentPage,e.totalPages=r.totalPages,e.totalRecords=r.count,t.next=15;break;case 12:return a.close(),e.$message.error(r.resultMsg),t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t)})))()},btnList:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.Nc)({roleSysno:e.$cookies.get("Role_Sysno"),url:"failureManage"}).then((function(t){if("0"!=t.resultCode)return"2024"==t.resultCode?(e.$message.error("token失效!请重新登录"),e.$router.push({path:"/login"})):e.$message.error(t.resultMsg),!1;t.data.forEach((function(t){e.permissionBtnList.push(t.phoneurl)}))}));case 2:case"end":return t.stop()}}),t)})))()},detail:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r,l,n;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.srcList=[],t.fileList=[],t.main.wellNo=e.wellNo,t.main.id=e.id,t.main.checkerId=e.checkerId,t.main.failureType=e.failureType,t.main.failureDesc=e.failureDesc,t.main.reportName=e.reportName,t.main.status=e.status+"",t.main.repairType=e.repairType+"",t.main.repairId=e.repairId,t.main.reportTime=e.reportTime,t.main.examineId=e.examineId,t.main.examineComment=e.examineComment,t.main.fileIds=e.fileIds,t.main.checkTime=e.checkTime,t.main.checkAddress=e.checkAddress,a.next=19,Object(s.zc)({token:t.$cookies.get("token_pipe"),failureId:e.id});case 19:if("0"!==(r=a.sent).resultCode){a.next=36;break}t.list=r.data,l=0;case 23:if(!(l<t.list.length)){a.next=34;break}if(r.data[l].file=[],r.data[l].srcList=[],null==t.list[l].fileIds){a.next=31;break}return a.next=29,Object(s.Mb)({fileIds:t.list[l].fileIds});case 29:"0"===(n=a.sent).resultCode?null!=n.data&&n.data.forEach((function(e){var a={name:e.fileName,url:e.url};t.list[l].file.push(a),t.list[l].srcList.push(e.url)})):"2"===n.resultCode&&t.$message.error(n.resultMsg);case 31:l++,a.next=23;break;case 34:a.next=38;break;case 36:return t.$message.error(r.resultMsg),a.abrupt("return",!1);case 38:t.visible2=!0;case 39:case"end":return a.stop()}}),a)})))()},bindSearch:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.jc)({token:e.$cookies.get("token_pipe"),pageIndex:e.pageindex,pagesize:e.pagesize,wellNo:e.main.wellNo,reportTime:e.record.reportTime,reportName:e.record.reportName});case 2:if(0!==(a=t.sent).resultCode){t.next=11;break}e.recordData=a.data,e.pageindex=a.currentPage,e.totalPages=a.totalPages,e.totalRecords=a.count,t.next=13;break;case 11:return e.$message.error(a.resultMsg),t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t)})))()},clickData:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.srcList=[],t.fileList=[],t.picture(e.fileIds),t.main.wellNo=e.wellNo,t.main.id=e.id,t.main.checkerId=e.checkerId,t.main.failureType=e.failureType,t.main.failureDesc=e.failureDesc,t.main.reportName=e.reportName,t.main.status=e.status+"",t.main.repairType=e.repairType+"",t.main.repairId=e.repairId,t.main.reportTime=t.timestampToDate(e.reportTime),t.main.examineId=e.examineId,t.main.examineComment=e.examineComment,t.main.fileIds=e.fileIds;case 17:case"end":return a.stop()}}),a)})))()},picture:function(e){var t=this;return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(s.Lb)({fileIds:e});case 2:"0"===(r=a.sent).resultCode?0==t.fileList.length&&r.data.forEach((function(e){var a=new Object;a.name=e.fileName,a.url=e.url,t.fileList.push(a),t.srcList.push(e.url)})):"2"===r.resultCode&&t.$message.error(r.resultMsg);case 4:case"end":return a.stop()}}),a)})))()},submitUpload:function(){var e=this;this.$confirm("是否上传图片，上传后不可更改?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$refs.upload.submit()})).catch((function(){}))},addCheckFiles:function(e){var t=e.data.id;""==this.main.fileIds?this.main.fileIds=t:this.main.fileIds=this.main.fileIds+","+t,this.sign2=1},handleRemove:function(e,t){},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},Save:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.sign2=0,t.next=3,Object(s.mb)({wellNo:e.main.wellNo,id:e.main.id,checkerId:e.main.checkerId,failureType:e.main.failureType,failureDesc:e.main.failureDesc,reportName:e.main.reportName,status:e.main.status,repairType:e.main.repairType,repairId:e.main.repairId,reportTime:e.main.reportTime,examineId:e.main.examineId,examineComment:e.main.examineComment,fileIds:e.main.fileIds});case 3:if("0"!==(a=t.sent).resultCode){t.next=10;break}e.$message.success("保存成功"),e.bind(),e.visible=!1,t.next=12;break;case 10:return e.$message.error(a.resultMsg),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t)})))()},statusSelects:function(){var e=this;return Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.option2=[],t.next=3,Object(s.Gc)({typeCode:"status"});case 3:"0"==(a=t.sent).resultCode&&a.data.forEach((function(t){var a=new Object;a.value=t.value,a.label=t.text,e.option2.push(a)}));case 5:case"end":return t.stop()}}),t)})))()},findDic:function(e,t){return Object(r.a)(Object(i.a)().mark((function a(){var r;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!=t.length){a.next=5;break}return a.next=3,Object(s.Gc)({typeCode:e});case 3:"0"==(r=a.sent).resultCode&&r.data.forEach((function(e){var a=new Object;a.value=e.value,a.label=e.text,t.push(a)}));case 5:case"end":return a.stop()}}),a)})))()},Clear:function(){this.pageNum=this.pageNum,this.pageSize=this.pageSize,this.valueTime="",this.search.id="",this.search.status="",this.search.checkerId="",this.search.startTime="",this.search.endTime="",this.bind()},Clear1:function(){this.pageNum=this.pageNum,this.pageSize=this.pageSize,this.record.reportTime="",this.record.reportName="",this.bindSearch()},reflush:function(){this.pageindex=1,this.search.id="",this.search.status="",this.search.checkerId="",this.search.startTime="",this.search.endTime="",this.bind()},timestampToDate:function(e){var t=new Date(e),a=t.getFullYear(),i=t.getMonth()+1,r=t.getDate(),s=t.getHours(),l=t.getMinutes(),n=t.getSeconds();return a+"-"+(i=i<10?"0"+i:i)+"-"+(r=r<10?"0"+r:r)+" "+(s=s<10?"0"+s:s)+":"+(l=l<10?"0"+l:l)+":"+(n=n<10?"0"+n:n)},handleCurrentChange:function(e){this.pageindex=e,this.bind()}}},n=(a("a312"),a("2877")),o=Object(n.a)(l,(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"page_content"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card_body"},[t("page-main",[t("div",{staticClass:"filter_container"},[t("el-form",{attrs:{inline:!0,"v-model":e.search}},[t("el-form-item",{attrs:{label:"报障记录ID:"}},[t("el-input",{staticClass:"w200",attrs:{placeholder:"请输入报障记录ID",clearable:""},model:{value:e.search.id,callback:function(t){e.$set(e.search,"id",t)},expression:"search.id"}})],1),t("el-form-item",{attrs:{label:"报障状态:"}},[t("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入报障状态",filterable:"","allow-create":"","default-first-option":""},model:{value:e.search.status,callback:function(t){e.$set(e.search,"status",t)},expression:"search.status"}},e._l(e.option2,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"巡检编号:"}},[t("el-input",{staticClass:"w200",attrs:{placeholder:"请输入巡检编号",clearable:""},model:{value:e.search.checkerId,callback:function(t){e.$set(e.search,"checkerId",t)},expression:"search.checkerId"}})],1),t("el-form-item",{attrs:{label:"上报时间 :"}},[t("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd "},on:{change:e.changeTime},model:{value:e.valueTime,callback:function(t){e.valueTime=t},expression:"valueTime"}})],1),t("el-form-item",{staticStyle:{"margin-right":"auto"}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.bind()}}},[e._v(" 搜索 ")]),t("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-refresh"},on:{click:function(t){return e.Clear()}}},[e._v(" 重置 ")])],1)],1)],1)]),t("div",{staticClass:"table_container"},[t("page-main",[t("el-table",{attrs:{data:e.tableData,stripe:""}},[t("el-table-column",{attrs:{prop:"id",label:"报障记录ID",align:"center"}}),t("el-table-column",{attrs:{prop:"checkerId",label:"巡检编号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.checkerId||"--")+" ")]}}])}),t("el-table-column",{attrs:{prop:"reportName",label:"维护人员",align:"center"}}),t("el-table-column",{attrs:{prop:"companyName",label:"归属单位",align:"center"}}),t("el-table-column",{attrs:{prop:"wellNo",label:"井编号",align:"center"}}),t("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[1==a.row.status?t("span",[e._v("待派单")]):2==a.row.status?t("span",[e._v("进行中")]):3==a.row.status?t("span",[e._v("待验证")]):4==a.row.status?t("span",[e._v("延期")]):5==a.row.status?t("span",[e._v("已关闭")]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"reportTime",label:"上报时间",align:"center"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"<200></200>",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.permissionBtnList.indexOf("details")>-1?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.detail(a.row)}}},[e._v(" 详情 ")]):e._e(),1==a.row.status&&e.permissionBtnList.indexOf("update1")>-1?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.sendOrder(a.row)}}},[e._v(" 派单 ")]):e._e(),3==a.row.status&&e.permissionBtnList.indexOf("update2")>-1?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirm(a.row)}}},[e._v(" 确认 ")]):e._e()]}}])})],1),t("div",{staticClass:"pagenation"},[t("el-pagination",{attrs:{background:"","current-page":e.pageindex,"page-size":e.pagesize,layout:"total,prev, pager, next, jumper",total:e.totalRecords},on:{"current-change":e.handleCurrentChange}})],1)],1)],1)],1)]),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.opTitle,center:"",visible:e.visible,width:"1000px","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"card",staticStyle:{border:"1px #c7cccc solid",display:"inline-block"}},[t("div",{staticClass:"card_body"},[t("div",{staticClass:"filter_container"},[t("el-form",{ref:"main",staticStyle:{position:"relative"},attrs:{model:e.main,"label-width":"150px",inline:!0}},[t("h3",{staticStyle:{"padding-left":"60px"}},[e._v("报障")]),t("br"),t("el-form-item",{attrs:{label:"报障记录ID:"}},[t("el-input",{attrs:{clearable:"",disabled:""},model:{value:e.main.id,callback:function(t){e.$set(e.main,"id",t)},expression:"main.id"}})],1),t("el-form-item",{attrs:{label:"巡检编号:"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{clearable:"",disabled:""},model:{value:e.main.checkerId,callback:function(t){e.$set(e.main,"checkerId",t)},expression:"main.checkerId"}})],1),t("br"),t("el-form-item",{attrs:{label:"故障类型:"}},[t("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.main.failureType,callback:function(t){e.$set(e.main,"failureType",t)},expression:"main.failureType"}},e._l(e.option,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"故障描述:"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{clearable:""},model:{value:e.main.failureDesc,callback:function(t){e.$set(e.main,"failureDesc",t)},expression:"main.failureDesc"}})],1),t("br"),t("el-form-item",{attrs:{label:"报障人员:"}},[t("el-input",{attrs:{clearable:""},model:{value:e.main.reportName,callback:function(t){e.$set(e.main,"reportName",t)},expression:"main.reportName"}})],1),t("el-form-item",{attrs:{label:"井编号:"}},[t("el-input",{staticStyle:{width:"90px"},attrs:{clearable:"",disabled:""},model:{value:e.main.wellNo,callback:function(t){e.$set(e.main,"wellNo",t)},expression:"main.wellNo"}})],1),t("el-form-item",{staticStyle:{"margin-left":"-80px"},attrs:{label:"上报时间:"}},[t("el-date-picker",{staticStyle:{width:"130px"},attrs:{type:"date",placeholder:"","value-format":"yyyy-MM-dd "},model:{value:e.main.reportTime,callback:function(t){e.$set(e.main,"reportTime",t)},expression:"main.reportTime"}})],1),t("br"),t("el-form-item",{attrs:{label:"报障状态:"}},[t("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.main.status,callback:function(t){e.$set(e.main,"status",t)},expression:"main.status"}},e._l(e.option2,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"维修方式:"}},[t("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.main.repairType,callback:function(t){e.$set(e.main,"repairType",t)},expression:"main.repairType"}},e._l(e.option3,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"维修处理人员:"}},[t("el-input",{attrs:{clearable:""},model:{value:e.main.repairId,callback:function(t){e.$set(e.main,"repairId",t)},expression:"main.repairId"}})],1),t("el-form-item",{attrs:{label:"验收人员:"}},[t("el-input",{attrs:{clearable:""},model:{value:e.main.examineId,callback:function(t){e.$set(e.main,"examineId",t)},expression:"main.examineId"}})],1),t("br"),t("el-form-item",{attrs:{label:"维修点评:"}},[t("el-input",{staticStyle:{width:"660px"},attrs:{type:"textarea",clearable:""},model:{value:e.main.examineComment,callback:function(t){e.$set(e.main,"examineComment",t)},expression:"main.examineComment"}})],1),t("br"),t("h3",{staticStyle:{"padding-left":"60px"}},[e._v("附件上传")]),t("br"),t("el-form-item",{staticStyle:{"padding-left":"60px"},attrs:{label:""}},[t("el-upload",{ref:"upload",attrs:{action:e.uploadUrl,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"auto-upload":!1,"on-success":e.addCheckFiles,disabled:1==e.sign2,"file-list":e.fileList}},[t("i",{staticClass:"el-icon-plus"})]),t("el-button",{staticStyle:{"margin-left":"28px","margin-top":"5px"},attrs:{size:"small",type:"primary",disabled:1==e.sign2},on:{click:e.submitUpload}},[e._v(" 上传图片 ")])],1),t("br"),t("span",{staticStyle:{"margin-left":"400px"}},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",loading:e.userSaveLoading},on:{click:e.Save}},[e._v("保 存")])],1)],1)],1)])])]),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.opTitle,visible:e.visible3,width:"400px","destroy-on-close":!0},on:{"update:visible":function(t){e.visible3=t},close:e.onDialog}},[t("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"130px",rules:e.rules}},[t("el-form-item",{attrs:{label:"指派人员: ",prop:"sendOrderName"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.sendOrderName,callback:function(t){e.$set(e.addForm,"sendOrderName",t)},expression:"addForm.sendOrderName"}},e._l(e.options17,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.visible3=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.UserSave("addForm")}}},[e._v("确 定")])],1)],1),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"故障详情",visible:e.visible2,width:"954px","destroy-on-close":!0},on:{"update:visible":function(t){e.visible2=t}}},[t("div",{staticClass:"card",staticStyle:{width:"100%",display:"inline-block"}},[t("div",{staticClass:"card_body"},[t("div",{staticClass:"filter_container"},[t("el-form",{ref:"main",staticStyle:{position:"relative"},attrs:{model:e.main,"label-width":"150px",inline:!0}},[t("h3",[e._v("报障信息")]),t("br"),t("div",{staticClass:"box-row"},[t("div",{staticClass:"box1"},[t("div",{staticClass:"box1_left"},[t("span",[e._v("报障记录ID :")])]),t("div",{staticClass:"box1_right"},[t("span",[e._v(e._s(e.main.id))])])]),t("div",{staticClass:"box1",staticStyle:{"margin-left":"50px"}},[t("div",{staticClass:"box1_left"},[t("span",[e._v("报障状态 :")])]),t("div",{staticClass:"box1_right"},[1==e.main.status?t("span",[e._v("待派单")]):e._e(),2==e.main.status?t("span",[e._v("进行中")]):e._e(),3==e.main.status?t("span",[e._v("已解决")]):e._e(),4==e.main.status?t("span",[e._v("延期")]):e._e(),5==e.main.status?t("span",[e._v("已关闭")]):e._e()])])]),t("div",{staticClass:"box-row",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1"},[t("div",{staticClass:"box1_left"},[t("span",[e._v("巡检编号 :")])]),t("div",{staticClass:"box1_right"},[null!=e.main.checkerId?t("span",[e._v(e._s(e.main.checkerId))]):t("span",[e._v("--")])])]),t("div",{staticClass:"box1",staticStyle:{"margin-left":"50px"}},[t("div",{staticClass:"box1_left"},[t("span",[e._v("巡检时间 :")])]),t("div",{staticClass:"box1_right"},[t("span",[e._v(e._s(e.main.checkTime))])])])]),t("div",{staticClass:"box-row",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1"},[t("div",{staticClass:"box1_left"},[t("span",[e._v("井编号 :")])]),t("div",{staticClass:"box1_right"},[t("span",[e._v(e._s(e.main.wellNo))])])]),t("div",{staticClass:"box1",staticStyle:{"margin-left":"50px"}},[t("div",{staticClass:"box1_left"},[t("span",[e._v("巡检位置 :")])]),t("div",{staticClass:"box1_right"},[t("span",{attrs:{title:e.main.checkAddress}},[e._v(e._s(e.main.checkAddress))])])])]),t("div",{staticClass:"box-row",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1"},[t("div",{staticClass:"box1_left"},[t("span",[e._v("报障人员 :")])]),t("div",{staticClass:"box1_right"},[t("span",[e._v(e._s(e.main.reportName))])])]),t("div",{staticClass:"box1",staticStyle:{"margin-left":"50px"}},[t("div",{staticClass:"box1_left"},[t("span",[e._v("报障时间 :")])]),t("div",{staticClass:"box1_right"},[t("span",[e._v(e._s(e.main.reportTime))])])])]),t("div",{staticClass:"box-row",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1"},[t("div",{staticClass:"box1_left"},[t("span",[e._v("维护人员 :")])]),t("div",{staticClass:"box1_right"},[t("span",[e._v(e._s(e.main.repairId))])])]),t("div",{staticClass:"box1",staticStyle:{"margin-left":"50px"}},[t("div",{staticClass:"box1_left"},[t("span",[e._v("验收人员 :")])]),t("div",{staticClass:"box1_right"},[t("span",[e._v(e._s(e.main.examineId))])])])]),t("h3",{staticStyle:{"margin-top":"30px"}},[e._v("报障项")]),t("br"),t("div",{staticClass:"boxx"},e._l(e.list,(function(a,i){return t("div",{key:i},[t("div",{staticClass:"box-row",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1"},[t("div",{staticClass:"box1_left"},[t("span",[e._v("故障项NO1 :")])]),t("div",{staticClass:"box1_right"},[t("span",[e._v(e._s(a.checkTypeText))])])]),t("div",{staticClass:"box1",staticStyle:{"margin-left":"50px"}},[t("div",{staticClass:"box1_left"},[t("span",[e._v("故障状态 :")])]),t("div",{staticClass:"box1_right"},[1==a.status?t("span",[e._v("待派单")]):e._e(),2==a.status?t("span",[e._v("进行中")]):e._e(),3==a.status?t("span",[e._v("已解决（已修好，待验收）")]):e._e(),4==a.status?t("span",[e._v("延期")]):e._e(),5==a.status?t("span",[e._v("已关闭（故障已经解决）")]):e._e()])])]),t("div",{staticClass:"remarks",staticStyle:{"margin-top":"16px"}},[t("div",{staticClass:"box1_left"},[t("span",[e._v("报障备注 :")])]),t("div",{staticClass:"box1_right box1_right1"},[t("span",[e._v(e._s(a.remarks))])])]),t("el-form-item",{staticClass:"picture",attrs:{label:""}},[t("div",{staticStyle:{display:"flex"}},[t("div",{staticClass:"picture_left"},[t("span",[e._v("图片 :")])]),e._l(a.file,(function(e,a){return t("div",{key:a,staticClass:"demo-image__preview"},[t("el-image",{key:a,staticClass:"img",staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.url,"preview-src-list":[e.url]}})],1)}))],2)])],1)})),0)])],1)])])]),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)])}),[],!1,null,"fb79ba9e",null);t.default=o.exports}}]);