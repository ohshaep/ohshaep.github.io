import{z as Ce,a as Re,r as s,A as $,aO as ke,V as Ie,o as d,c as h,d as a,w as l,e as p,t as i,F as B,W as H,i as L,f as u,g as D,R as X,E as Ae,Q as P,G as Ne,m as j,_ as Te,a$ as $e,b0 as De,y as Pe,b3 as ze,n as Fe,a8 as Ue,a9 as Oe,a6 as Ve,B as qe,L as Be,s as Le,q as je,x as Me,S as Qe,ac as Ye,M as Ee,aa as Ge,ab as Ke,N as Je,O as We}from"./index.192c8708.js";import{m as Z,n as He}from"./approveSaleOut.1dd4a8dc.js";const Xe=[{title:"\u51FA\u5E93\u8BB0\u5F55ID",dataIndex:"id",width:150},{title:"\u635F\u8017",dataIndex:"loss",width:150},{title:"\u5E93\u533A",dataIndex:"storeAreaName",ellipsis:!0,width:150},{title:"\u5E93\u4F4D",dataIndex:"storePositionName",ellipsis:!0,width:150},{title:"\u5546\u54C1\u540D\u79F0",dataIndex:"productName",ellipsis:!0,width:150},{title:"\u51FA\u5E93\u65E5\u671F",dataIndex:"productDate",width:150},{title:"\u5BA1\u6838\u65E5\u671F",dataIndex:"approveTime",width:150},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",width:150},{title:"\u64CD\u4F5C",dataIndex:"operation",fixed:"right",align:"center",width:150}];const ee=k=>(Je("data-v-bc75782d"),k=k(),We(),k),Ze=ee(()=>u("span",{class:"separate"},"/",-1)),ea=ee(()=>u("span",null,"\u51FA\u5E93\u67E5\u8BE2",-1)),aa={class:"app-container"},la={class:"container-wrapper"},ta={key:1},oa=["onClick"],sa=["onClick"],na=["onClick"],ua={class:"dialog-footer"},ia={__name:"index",setup(k){Re();const I=s(!1),y=s(!1),{proxy:ae}=Ne();ae.useDict("sys_point_type");const le=$([{label:"\u5168\u90E8",value:""},{label:"\u5F85\u5BA1\u6279",value:"1"},{label:"\u5BA1\u6279\u901A\u8FC7",value:"3"},{label:"\u5BA1\u6279\u4E0D\u901A\u8FC7",value:"2"}]),M=s([{value:"ID",label:"\u51FA\u5E93ID"},{value:"supplierId",label:"\u4F9B\u5E94\u5546ID"},{value:"productName",label:"\u5546\u54C1\u540D"},{value:"productId",label:"\u5546\u54C1ID"}]),_=s({loss:null,approveReason:null,id:null,lossApproveStatus:1}),A=s(0),f=s(null),z=s(!0),g=s([]),w=s([]);s(""),s("");const N=s(!1);s(null);const te=async()=>{g.value=[],n.value={current:0,pageSize:10,lossApproveStatus:"",beginTime:"",endTime:""},S.value="ID",C.value="",x()},oe=s([]);s({onChange:(o,e)=>{oe.value=o}});const x=o=>{b.current=1,n.value.current=0,n.value.timeType=1,R()};function se(o){M.value.forEach((e,v)=>{e.value!=o&&(n.value[e.value]="")})}ke(w,(o,e)=>{for(let v=0;v<o.length;v++)w.value[v].key=w.value[v].id});const Q=(o,e,v)=>{b.current=o,v&&(b.pageSize=e,n.value.pageSize=e),n.value.current=o,R()},b=$({current:1,pageSize:10,total:0,showTotal:o=>`\u5171 ${o} \u6761`,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["2","20","50","100"],onChange:(o,e)=>Q(o,e),onShowSizeChange:(o,e)=>Q(o,e,"sizeChange")}),F=s("1"),ne=$({queryParams:{current:0,pageSize:10,lossApproveStatus:"",beginTime:"",endTime:""},searchType:"ID",searchValue:""}),{queryParams:n,searchType:S,searchValue:C}=Ie(ne),ue={loss:[{required:!0,validator:async(o,e)=>isNaN(e)?isNaN(parseFloat(e))?Promise.reject("\u8BF7\u8F93\u5165\u6570\u5B57"):e.match(/\./g).length>1?Promise.reject("\u4E0D\u80FD\u8F93\u5165\u591A\u4E2A\u5C0F\u6570\u70B9"):A.value<parseFloat(e)?Promise.reject("\u4E0D\u80FD\u8F93\u5165\u5927\u4E8E\u603B\u91CF\u7684\u503C"):Promise.resolve():A.value<e?Promise.reject("\u4E0D\u80FD\u8F93\u5165\u5927\u4E8E\u603B\u91CF\u7684\u503C"):Promise.resolve(),trigger:"change"}]};function ie(o){y.value=!0,_.value.id=o.id,A.value=o.storageQuality}const Y=s();async function re(){await Y.value.validateFields(),Z(_.value).then(o=>{j.success(o.message),y.value=!1,_.value={},R()})}const R=async()=>{z.value=!0,g.value&&g.value.length>0?(n.value.beginTime=g.value[0],n.value.endTime=g.value[1]):(n.value.beginTime="",n.value.endTime=""),n.value[S.value]=C.value,He({...n.value,lossApproveStatus:F.value}).then(o=>{o.code===200&&(w.value=o.data.data,console.log(b,"test"),b.total=o.data.row,z.value=!1)})},pe=o=>{I.value=!0,c.value.id=o.id};s(!1),$({verifyStatus:null,failureReson:""});const ve={lossApproveStatus:[{required:!0,message:"\u5FC5\u9009",trigger:["change"]}]},c=s({id:"",lossApproveStatus:3,approveReason:"",fileNames:"",fileInfo:""}),de=s([]);s(!1);const U=s(null),_e=()=>{U.value.validateFields().then(async o=>{const e=await Z(c.value);console.log(e,"deliveryRecordApprove"),e.code==200?(j.success("\u63D0\u4EA4\u6210\u529F"),E(),R()):j.error("\u63D0\u4EA4\u5931\u8D25")})},E=()=>{I.value=!1,U.value.resetFields(),c.value.fileNames="",de.value=[]};return R(),(o,e)=>{const v=Te,ce=$e,me=De,fe=Pe,ge=ze,m=Fe,ye=Ue,be=Oe,G=Ve,T=qe,O=Be,V=Le,he=je,we=Me,xe=Qe,K=Ye,q=Ee,J=Ge,Se=Ke;return d(),h(B,null,[a(v,{title:"\u635F\u8017\u5904\u7406",icon:"icon-rongqi"},{nav:l(()=>[p(i("\u51FA\u5E93\u67E5\u8BE2")+" "),Ze,ea]),_:1}),a(fe,null,{default:l(()=>[a(me,{defaultValue:"1",value:F.value,"onUpdate:value":e[0]||(e[0]=t=>F.value=t),onChange:x},{default:l(()=>[(d(!0),h(B,null,H(le,(t,r)=>(d(),L(ce,{key:r,value:t.value},{default:l(()=>[p(i(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),u("div",aa,[a(he,{justify:"space-between",style:{flex:"1"}},{default:l(()=>[u("div",la,[a(V,{layout:"inline",ref:"queryRef",model:D(n)},{default:l(()=>[a(m,{style:{width:"308px"},name:"dateRange",label:"\u521B\u5EFA\u65F6\u95F4"},{default:l(()=>[a(ge,{value:g.value,"onUpdate:value":e[1]||(e[1]=t=>g.value=t),"value-format":"YYYY-MM-DD",onChange:x},null,8,["value"])]),_:1}),a(m,{label:""},{default:l(()=>[a(G,{placeholder:"\u8BF7\u8F93\u5165",value:D(C),"onUpdate:value":e[3]||(e[3]=t=>X(C)?C.value=t:null),onKeyup:Ae(x,["enter"])},{addonBefore:l(()=>[a(be,{style:{width:"120px"},value:D(S),"onUpdate:value":e[2]||(e[2]=t=>X(S)?S.value=t:null),onChange:se},{default:l(()=>[(d(!0),h(B,null,H(M.value,(t,r)=>(d(),L(ye,{key:r,value:t.value},{default:l(()=>[p(i(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["value"])]),_:1}),a(m,{style:{"margin-left":"auto"}},{default:l(()=>[a(O,null,{default:l(()=>[a(T,{type:"primary",onClick:x},{default:l(()=>[p("\u67E5\u8BE2")]),_:1}),a(T,{type:"primary",ghost:"",onClick:te},{default:l(()=>[p("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),a(xe,{spinning:z.value},{default:l(()=>[a(we,{dataSource:w.value,columns:D(Xe),pagination:b,scroll:{x:0,y:500}},{bodyCell:l(({column:t,record:r})=>[t.dataIndex==="lossApproveStatus"?(d(),L(O,{key:0},{default:l(()=>[p(i(["\u5F02\u5E38\u6570\u636E","\u5F85\u5BA1\u6838","\u5BA1\u6279\u4E0D\u901A\u8FC7","\u5BA1\u6279\u901A\u8FC7"][r.lossApproveStatus]),1)]),_:2},1024)):P("",!0),t.dataIndex==="operation"?(d(),h("span",ta,[a(O,{size:"middle",style:{color:"#05C059",cursor:"pointer"}},{default:l(()=>[r.lossApproveStatus==1?(d(),h("span",{key:0,onClick:W=>pe(r)},"\u5BA1\u6838",8,oa)):P("",!0),u("span",{onClick:W=>(N.value=!0,f.value=r)},"\u8BE6\u60C5",8,sa),r.lossApproveStatus==2?(d(),h("span",{key:1,onClick:W=>ie(r)},"\u7F16\u8F91",8,na)):P("",!0)]),_:2},1024)])):P("",!0)]),_:1},8,["dataSource","columns","pagination"])]),_:1},8,["spinning"])]),a(q,{title:"\u635F\u8017\u7F16\u8F91",visible:y.value,"onUpdate:visible":e[8]||(e[8]=t=>y.value=t),width:"580px",layout:"inline","append-to-body":"",onCancel:e[9]||(e[9]=t=>y.value=!1)},{footer:l(()=>[u("div",ua,[a(T,{type:"primary",onClick:e[6]||(e[6]=t=>re())},{default:l(()=>[p("\u786E \u5B9A")]),_:1}),a(T,{onClick:e[7]||(e[7]=t=>y.value=!1)},{default:l(()=>[p("\u53D6 \u6D88")]),_:1})])]),default:l(()=>[a(V,{ref_key:"dataRef",ref:Y,model:_.value,rules:ue},{default:l(()=>[a(m,{label:"\u5F53\u524D\u7CAE\u98DF\u603B\u91CF"},{default:l(()=>[u("span",null,i(A.value),1)]),_:1}),a(m,{label:"\u635F\u8017",name:"loss"},{default:l(()=>[a(G,{placeholder:"\u8BF7\u8F93\u5165",value:_.value.loss,"onUpdate:value":e[4]||(e[4]=t=>_.value.loss=t)},null,8,["value"])]),_:1}),a(m,{name:"approveReason",label:"\u539F\u56E0"},{default:l(()=>[a(K,{value:_.value.approveReason,"onUpdate:value":e[5]||(e[5]=t=>_.value.approveReason=t),placeholder:"\u8BF7\u8F93\u5165\u635F\u8017\u539F\u56E0","auto-size":{minRows:5,maxRows:10}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),a(q,{visible:N.value,"onUpdate:visible":e[10]||(e[10]=t=>N.value=t),title:"\u8BE6\u60C5",onOk:e[11]||(e[11]=t=>N.value=!1),"append-to-body":"",destroyOnClose:""},{default:l(()=>[u("div",null,"\u8D27\u54C1\uFF1A"+i(f.value.productName),1),u("div",null,"\u8D27\u54C1\u635F\u8017:"+i(f.value.loss),1),u("div",null,"\u6279\u5BA1\u4EBA:"+i(f.value.approveUser),1),u("div",null,"\u6279\u5BA1\u65E5\u671F:"+i(f.value.approveTime),1),u("div",null,"\u6279\u5BA1\u610F\u89C1:"+i(f.value.approveReason),1),u("div",null,"\u6279\u5BA1\u7ED3\u679C:"+i(["\u6570\u636E\u5F02\u5E38","\u5F85\u5BA1\u6279","\u4E0D\u901A\u8FC7","\u5DF2\u901A\u8FC7"][f.value.approveStatus]),1)]),_:1},8,["visible"]),a(q,{visible:I.value,"onUpdate:visible":e[14]||(e[14]=t=>I.value=t),title:"\u64CD\u4F5C\u786E\u8BA4",onOk:_e,onCancel:E,"append-to-body":"",destroyOnClose:""},{default:l(()=>[a(V,{layout:"inline",ref_key:"reviewFormComp",ref:U,model:c.value,rules:ve},{default:l(()=>[a(m,{style:{width:"308px"},name:"lossApproveStatus",label:"\u5BA1\u6838\u72B6\u6001"},{default:l(()=>[a(Se,{value:c.value.lossApproveStatus,"onUpdate:value":e[12]||(e[12]=t=>c.value.lossApproveStatus=t),style:{"margin-right":"8px"}},{default:l(()=>[a(J,{value:3},{default:l(()=>[p("\u5BA1\u6838\u901A\u8FC7")]),_:1}),a(J,{value:2},{default:l(()=>[p("\u5BA1\u6838\u4E0D\u901A\u8FC7")]),_:1})]),_:1},8,["value"])]),_:1}),a(m,{style:{width:"308px"},name:"approveReason",label:"\u539F\u56E0"},{default:l(()=>[a(K,{value:c.value.approveReason,"onUpdate:value":e[13]||(e[13]=t=>c.value.approveReason=t),placeholder:"\u5BA1\u6838\u8BED","auto-size":{minRows:5,maxRows:10}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},da=Ce(ia,[["__scopeId","data-v-bc75782d"]]);export{da as default};
