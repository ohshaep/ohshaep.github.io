import{z as Be,a as De,r as s,A as O,aO as Le,V as Ve,o as v,c as h,d as t,w as l,e as c,t as U,F as G,W as ae,i as q,f as y,g as $,R as te,E as Ee,Q as z,G as Me,m,M as le,_ as je,a$ as Qe,b0 as Ye,y as Ge,b3 as Je,n as Ke,a3 as We,a9 as He,a8 as Xe,a6 as Ze,B as ea,L as aa,s as ta,q as la,x as oa,S as na,aa as sa,ab as ia,ac as ua,aJ as ra,N as da,O as ca}from"./index.192c8708.js";import{p as va}from"./approveSaleOut.1dd4a8dc.js";import{u as pa}from"./qualityReport.6dc17b5d.js";import{i as oe,s as _a,a as ma,b as fa}from"./storageMg.e8e488da.js";const ga=[{title:"\u51FA\u5E93\u8BB0\u5F55ID",dataIndex:"id",width:150},{title:"\u51FA\u5E93\u8BB8\u53EF\u5355\u53F7",dataIndex:"deliveryOrderCode",width:150},{title:"\u9500\u552E\u5408\u540C\u53F7",dataIndex:"contractNo",width:150},{title:"\u4ED3\u5E93",dataIndex:"storehouseName",width:150},{title:"\u5E93\u533A",dataIndex:"storeAreaName",ellipsis:!0,width:150},{title:"\u5E93\u4F4D",dataIndex:"storePositionName",ellipsis:!0,width:150},{title:"\u5546\u54C1\u540D\u79F0",dataIndex:"productName",ellipsis:!0,width:150},{title:"\u51FA\u5E93\u6570\u91CF",dataIndex:"deliveryQuality",ellipsis:!0,width:150},{title:"\u51FA\u5E93\u65B9\u5F0F",dataIndex:"deliveryMode",width:150},{title:"\u724C\u7167\u767B\u8BB0",dataIndex:"licenseRegister",width:150},{title:"\u51FA\u5E93\u65E5\u671F",dataIndex:"productDate",width:150},{title:"\u5355\u636E\u72B6\u6001",dataIndex:"orderStatus",width:150},{title:"\u6536\u6B3E\u65F6\u95F4",dataIndex:"receivablesTime",width:150},{title:"\u6536\u6B3E\u91D1\u989D",dataIndex:"receivablesAmount",width:150},{title:"\u6536\u6B3E\u94F6\u884C",dataIndex:"receivablesBank",width:150},{title:"\u5BA1\u6838\u65E5\u671F",dataIndex:"approveTime",width:150},{title:"\u5BA1\u6838\u4EBA",dataIndex:"approveUser",width:150},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",width:150},{title:"\u521B\u5EFA\u4EBA",dataIndex:"createBy",width:150},{title:"\u64CD\u4F5C",dataIndex:"operation",fixed:"right",align:"center",width:150}];const ne=F=>(da("data-v-98f24295"),F=F(),ca(),F),ha=ne(()=>y("span",{class:"separate"},"/",-1)),ya=ne(()=>y("span",null,"\u51FA\u5E93\u67E5\u8BE2",-1)),ba={class:"app-container"},wa={class:"container-wrapper"},Ia={key:1},xa=["onClick"],Sa=["onClick"],Ca=["onClick"],ka=["onClick"],Ra={__name:"tindex",setup(F){const J=De(),P=s(!1),{proxy:B}=Me();B.useDict("sys_point_type");const r=s({storehouseId:[],storeAreaId:[],storePositionId:[]}),se=O([{label:"\u5168\u90E8",value:""},{label:"\u5F85\u5BA1\u6279",value:"1"},{label:"\u5BA1\u6279\u901A\u8FC7",value:"3"},{label:"\u5BA1\u6279\u4E0D\u901A\u8FC7",value:"2"}]),K=s([{value:"deliveryOrderCode",label:"\u51FA\u5E93\u8BB8\u53EF\u5355\u53F7"},{value:"deliveryMode",label:"\u51FA\u5E93\u65B9\u5F0F"},{value:"licenseRegister",label:"\u724C\u7167\u767B\u8BB0"},{value:"approveUser",label:"\u5BA1\u6838\u4EBA"},{value:"createBy",label:"\u9500\u521B\u5EFA\u4EBA"},{value:"createBy",label:"\u521B\u5EFA\u4EBA"}]),D=s(!0),f=s([]),b=s([]);s(""),s(""),s(null);const ie=async()=>{f.value=[],r.value={storehouseId:[],storeAreaId:[],storePositionId:[]},i.value={current:0,pageSize:10,orderStatus:"",beginTime:"",endTime:"",orderStatus:""},S.value="deliveryOrderCode",C.value="",I()},w=s([]),ue=s({onChange:(e,a)=>{w.value=e}}),I=e=>{x.current=1,i.value.current=0,i.value.timeType=1,k()},re=()=>{let e={...i.value};delete e.current,delete e.pageSize,delete e.timeType,B.download("/deliveryRecord/exportData",e,`\u51FA\u5E93\u7BA1\u7406_${new Date().getTime()}.xlsx`)},de=()=>{if(w.value.length==0){m.warning("\u8BF7\u9009\u62E9\u8981\u6253\u5370\u7684\u6570\u636E");return}if(w.value.length>5){m.warning("\u6700\u591A\u652F\u63015\u6761\u6570\u636E");return}w.value.length<6&&B.download("/deliveryRecord/printData",{ids:w.value.toString()},`\u51FA\u5E93\u7BA1\u7406_${new Date().getTime()}.docx`)};function ce(e){K.value.forEach((a,n)=>{a.value!=e&&(i.value[a.value]="")})}Le(b,(e,a)=>{for(let n=0;n<e.length;n++)b.value[n].key=b.value[n].id});const W=(e,a,n)=>{x.current=e,n&&(x.pageSize=a,i.value.pageSize=a),i.value.current=e,k()},x=O({current:1,pageSize:10,total:0,showTotal:e=>`\u5171 ${e} \u6761`,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["2","20","50","100"],onChange:(e,a)=>W(e,a),onShowSizeChange:(e,a)=>W(e,a,"sizeChange")}),L=s("1"),ve=O({queryParams:{current:0,pageSize:10,orderStatus:"",beginTime:"",endTime:""},searchType:"deliveryOrderCode",searchValue:""}),{queryParams:i,searchType:S,searchValue:C}=Ve(ve),k=async()=>{D.value=!0,f.value&&f.value.length>0?(i.value.beginTime=f.value[0],i.value.endTime=f.value[1]):(i.value.beginTime="",i.value.endTime=""),i.value[S.value]=C.value;let e={...i.value,orderStatus:L.value};r.value.storehouseId.length>0&&(e={...e,...r.value}),va(e).then(a=>{const n=a;b.value=n.records,x.total=n.total||0,D.value=!1})},pe=e=>{P.value=!0,u.value.id=e.id},_e=e=>{J.push({path:"/store/verify",query:{id:e.id}})},me=e=>{J.push({path:"/store/detial",query:{id:e.id}})};function fe(e){const a=e.id;le.confirm({title:"\u64CD\u4F5C\u786E\u8BA4",content:"\u662F\u5426\u786E\u5B9A\u64A4\u9500\uFF1F",onOk(){oe({id:a,orderStatus:4}).then(()=>{k(),m.success("\u64A4\u9500\u6210\u529F")}).catch(()=>{})}})}s(!1),O({verifyStatus:null,failureReson:""});const V=s(!1),R=s(!1),H=s([]);function ge(){_a().then(e=>{(e==null?void 0:e.data).forEach(n=>{H.value.push({value:n.id,label:n.storeName})})})}function he(e){E.value=[],A.value=[],r.value.storeAreaId=void 0,r.value.storePositionId=void 0,e.length>1?(R.value=!0,V.value=!0):(R.value=!1,V.value=!1),ye(e)}const E=s([]);function ye(e){let a=e.map(Number);ma(a).then(n=>{n.data.length!=0&&n.data.forEach((g,T)=>{E.value[T]={value:g.id,label:g.storeAreaName}})})}function be(e){A.value=[],r.value.storePositionId=void 0,e.length>1?R.value=!0:R.value=!1,we(e)}const A=s([]),we=e=>{let a=e.map(Number);fa(a).then(n=>{n.data.forEach((g,T)=>{A.value[T]={value:g.id,label:g.storePositionName}})})},Ie={orderStatus:[{required:!0,message:"\u5FC5\u9009",trigger:["change"]}],receivablesTime:[{required:!0,message:"\u65F6\u95F4\u5FC5\u9009",trigger:["blur"]}],receivablesAmount:[{required:!0,message:"\u6536\u6B3E\u91D1\u989D\u5FC5\u586B",trigger:["blur"]}],receivablesBank:[{required:!0,message:"\u94F6\u884C\u540D\u79F0\u5FC5\u586B",trigger:["blur"]}]},u=s({id:"",orderStatus:3,approveReason:"",fileNames:"",fileInfo:""}),p=s([]),xe=s(!1),Se=async()=>{if(p.value[0].originFileObj.size/1024/1024>=10){m.error("\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC710M"),p.value=[];return}let a=new FormData;a.append("file",p.value[0].originFileObj);const n=await pa(a,xe.value);if(!n.success){m.error("\u4E0A\u4F20\u5931\u8D25"),p.value=[];return}m.success("\u4E0A\u4F20\u6210\u529F"),p.value[0].status="done",u.value.fileInfo=n.data,u.value.fileNames=p.value[0].originFileObj.name,u.value},M=s(null),Ce=()=>{M.value.validateFields().then(async e=>{console.log(u.value,"reviewForm.value"),(await oe(u.value)).code==200?(m.success("\u63D0\u4EA4\u6210\u529F"),X(),k()):m.error("\u63D0\u4EA4\u5931\u8D25")})},X=()=>{P.value=!1,M.value.resetFields(),u.value.fileNames="",p.value=[]};return k(),ge(),(e,a)=>{const n=je,g=Qe,T=Ye,ke=Ge,Re=Je,_=Ke,Te=We,j=He,Ne=Xe,ze=Ze,N=ea,Q=aa,Z=ta,Fe=la,Pe=oa,Ae=na,ee=sa,Oe=ia,Ue=ua,qe=ra,$e=le;return v(),h(G,null,[t(n,{title:"\u51FA\u5E93\u7BA1\u7406",icon:"icon-rongqi"},{nav:l(()=>[c(U("\u51FA\u5E93\u67E5\u8BE2")+" "),ha,ya]),_:1}),t(ke,null,{default:l(()=>[t(T,{defaultValue:"",value:L.value,"onUpdate:value":a[0]||(a[0]=o=>L.value=o),onChange:I},{default:l(()=>[(v(!0),h(G,null,ae(se,(o,d)=>(v(),q(g,{key:d,value:o.value},{default:l(()=>[c(U(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),y("div",ba,[t(Fe,{justify:"space-between",style:{flex:"1"}},{default:l(()=>[y("div",wa,[t(Z,{layout:"inline",ref:"queryRef",model:$(i)},{default:l(()=>[t(_,{style:{width:"308px"},name:"dateRange",label:"\u51FA\u5E93\u65F6\u95F4"},{default:l(()=>[t(Re,{value:f.value,"onUpdate:value":a[1]||(a[1]=o=>f.value=o),"value-format":"YYYY-MM-DD",onChange:I},null,8,["value"])]),_:1}),t(_,{name:"storehouseId"},{default:l(()=>[t(Te,{label:"\u4ED3\u5E93\u7B5B\u9009",value:r.value.storehouseId,"onUpdate:value":a[2]||(a[2]=o=>r.value.storehouseId=o),options:H.value,mode:"multiple",onChange:he,placeholder:"\u9009\u62E9\u4ED3\u5E93",clearable:"",style:{width:"200px"}},null,8,["value","options"])]),_:1}),t(_,{name:"storeAreaId"},{default:l(()=>[t(j,{value:r.value.storeAreaId,"onUpdate:value":a[3]||(a[3]=o=>r.value.storeAreaId=o),options:E.value,mode:"multiple",onChange:be,placeholder:"\u9009\u62E9\u5E93\u533A",clearable:"",style:{width:"120px","margin-left":"-15px"},disabled:V.value},null,8,["value","options","disabled"])]),_:1}),t(_,{name:"storePositionId"},{default:l(()=>[t(j,{value:r.value.storePositionId,"onUpdate:value":a[4]||(a[4]=o=>r.value.storePositionId=o),options:A.value,mode:"multiple",placeholder:"\u9009\u62E9\u5E93\u4F4D",clearable:"",style:{width:"120px","margin-left":"-15px"},disabled:R.value},null,8,["value","options","disabled"])]),_:1}),t(_,{label:""},{default:l(()=>[t(ze,{placeholder:"\u8BF7\u8F93\u5165",value:$(C),"onUpdate:value":a[6]||(a[6]=o=>te(C)?C.value=o:null),onKeyup:Ee(I,["enter"])},{addonBefore:l(()=>[t(j,{style:{width:"120px"},value:$(S),"onUpdate:value":a[5]||(a[5]=o=>te(S)?S.value=o:null),onChange:ce},{default:l(()=>[(v(!0),h(G,null,ae(K.value,(o,d)=>(v(),q(Ne,{key:d,value:o.value},{default:l(()=>[c(U(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["value"])]),_:1}),t(_,{style:{"margin-left":"auto"}},{default:l(()=>[t(Q,null,{default:l(()=>[t(N,{type:"primary",onClick:I},{default:l(()=>[c("\u67E5\u8BE2")]),_:1}),t(N,{type:"primary",ghost:"",onClick:ie},{default:l(()=>[c("\u91CD\u7F6E")]),_:1}),t(N,{type:"primary",onClick:re},{default:l(()=>[c("\u5BFC\u51FA")]),_:1}),t(N,{type:"primary",onClick:de},{default:l(()=>[c("\u6253\u5370")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),t(Ae,{spinning:D.value},{default:l(()=>[t(Pe,{dataSource:b.value,columns:$(ga),"row-selection":ue.value,pagination:x,scroll:{x:0,y:500}},{bodyCell:l(({column:o,record:d})=>[o.dataIndex==="orderStatus"?(v(),q(Q,{key:0},{default:l(()=>[c(U(["\u5F02\u5E38\u6570\u636E","\u5F85\u5BA1\u6838","\u5BA1\u6279\u4E0D\u901A\u8FC7","\u5BA1\u6279\u901A\u8FC7"][d.orderStatus]),1)]),_:2},1024)):z("",!0),o.dataIndex==="operation"?(v(),h("span",Ia,[t(Q,{size:"middle",style:{color:"#05C059",cursor:"pointer"}},{default:l(()=>[d.orderStatus==1?(v(),h("span",{key:0,onClick:Y=>pe(d)},"\u5BA1\u6838",8,xa)):z("",!0),d.orderStatus==2?(v(),h("span",{key:1,onClick:Y=>_e(d)},"\u7F16\u8F91",8,Sa)):z("",!0),y("span",{onClick:Y=>me(d)},"\u8BE6\u60C5",8,Ca),y("span",{onClick:Y=>fe(d)},"\u64A4\u9500\u5BA1\u6838",8,ka)]),_:2},1024)])):z("",!0)]),_:1},8,["dataSource","columns","row-selection","pagination"])]),_:1},8,["spinning"])]),t($e,{visible:P.value,"onUpdate:visible":a[10]||(a[10]=o=>P.value=o),title:"\u64CD\u4F5C\u786E\u8BA4",onOk:Ce,onCancel:X,"append-to-body":"",destroyOnClose:""},{default:l(()=>[t(Z,{layout:"vertical",ref_key:"reviewFormComp",ref:M,model:u.value,rules:Ie},{default:l(()=>[t(_,{name:"orderStatus",label:"\u5BA1\u6838\u72B6\u6001"},{default:l(()=>[t(Oe,{value:u.value.orderStatus,"onUpdate:value":a[7]||(a[7]=o=>u.value.orderStatus=o),style:{"margin-right":"8px"}},{default:l(()=>[t(ee,{value:3},{default:l(()=>[c("\u5BA1\u6838\u901A\u8FC7")]),_:1}),t(ee,{value:2},{default:l(()=>[c("\u5BA1\u6838\u4E0D\u901A\u8FC7")]),_:1})]),_:1},8,["value"])]),_:1}),u.value.orderStatus==2?(v(),q(_,{key:0,name:"approveReason",label:"\u539F\u56E0"},{default:l(()=>[t(Ue,{value:u.value.approveReason,"onUpdate:value":a[8]||(a[8]=o=>u.value.approveReason=o),placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6838\u4E0D\u901A\u8FC7\u539F\u56E0","auto-size":{minRows:5,maxRows:10}},null,8,["value"])]),_:1})):z("",!0),t(_,{name:"fileInfo",label:"\u4E0A\u4F20\u9644\u4EF6\uFF1A"},{default:l(()=>[t(qe,{"file-list":p.value,"onUpdate:fileList":a[9]||(a[9]=o=>p.value=o),name:"file",accept:".pdf,.jpg,.txt",customRequest:Se,maxCount:1,showUploadList:!0},{default:l(()=>[t(N,{type:"link",size:"large"},{default:l(()=>[c(" +\u4E0A\u4F20")]),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},Pa=Be(Ra,[["__scopeId","data-v-98f24295"]]);export{Pa as default};
