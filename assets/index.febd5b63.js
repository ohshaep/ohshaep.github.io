import{aI as M,z as be,a as Se,A as U,r,V as Ce,C as ke,o as s,c as h,d as n,w as a,e as u,t as p,F as N,W as Y,i as _,f as w,g as I,R as j,Q as v,bU as Re,G as Te,m as O,M as G,_ as Ue,a$ as Ne,b0 as Oe,y as Fe,b3 as Be,n as $e,a8 as Me,a9 as Ve,a6 as Qe,B as qe,s as Le,q as Pe,a4 as ze,aB as De,L as Ee,x as Ye,S as je,aa as Ge,ab as Je,ac as Ae,aJ as We,N as He,O as Ke}from"./index.192c8708.js";import{u as Xe}from"./common.e897a13c.js";const Ze=[{title:"\u91C7\u8D2D\u8BA2\u5355\u7F16\u53F7",dataIndex:"purchaseOrderCode",ellipsis:!0,width:170},{title:"\u8BA2\u5355\u7C7B\u578B",dataIndex:"orderType",ellipsis:!0,width:120},{title:"\u4F9B\u5E94\u5546",dataIndex:"supplierName",ellipsis:!0,width:150},{title:"\u91C7\u8D2D\u5408\u540C\u53F7",dataIndex:"contractNo",ellipsis:!0,width:150},{title:"\u5E01\u522B",dataIndex:"currency",ellipsis:!0,width:150},{title:"\u5546\u54C1\u7F16\u7801",dataIndex:"productCode",ellipsis:!0,width:150},{title:"\u5546\u54C1\u540D\u79F0",dataIndex:"productName",ellipsis:!0,width:180},{title:"\u89C4\u683C\u578B\u53F7",dataIndex:"productSpec",ellipsis:!0,width:150},{title:"\u8BA2\u8D27\u6570\u91CF",dataIndex:"orderQuality",ellipsis:!0,width:150},{title:"\u8BA1\u91CF\u5355\u4F4D",dataIndex:"measureUnit",ellipsis:!0,width:150},{title:"\u57FA\u672C\u8BA1\u91CF\u5355\u4F4D\u6570\u91CF",dataIndex:"baseQuality",ellipsis:!0,width:200},{title:"\u57FA\u672C\u8BA1\u91CF\u5355\u4F4D",dataIndex:"baseMeasureUnit",ellipsis:!0,width:200},{title:"\u542B\u7A0E\u5355\u4EF7(\u5143)",dataIndex:"unitPrice",ellipsis:!0,width:150},{title:"\u4EF7\u7A0E\u5408\u8BA1(\u5143)",dataIndex:"totalPrice",ellipsis:!0,width:150},{title:"\u7CAE\u98DF\u6027\u8D28",dataIndex:"nature",ellipsis:!0,width:120},{title:"\u5408\u4F5C\u5BA2\u6237",dataIndex:"cooperatorName",ellipsis:!0,width:150},{title:"\u6536\u8D27\u4ED3\u5E93",dataIndex:"receiveStorehouseName",ellipsis:!0,width:150},{title:"\u4EA4\u8D27\u65E5\u671F",dataIndex:"deliveryDate",ellipsis:!0,width:150},{title:"\u5907\u6CE8",dataIndex:"remark",ellipsis:!0,width:150},{title:"\u5236\u5355\u65F6\u95F4",dataIndex:"createTime",ellipsis:!0,width:170},{title:"\u5236\u5355\u4EBA",dataIndex:"createBy",ellipsis:!0,width:150},{title:"\u64CD\u4F5C",dataIndex:"edit",fixed:"right",align:"center",width:150}],et=[{title:"\u91C7\u8D2D\u8BA2\u5355\u7F16\u53F7",dataIndex:"purchaseOrderCode",ellipsis:!0,width:150},{title:"\u8BA2\u5355\u7C7B\u578B",dataIndex:"orderType",ellipsis:!0,width:120},{title:"\u4F9B\u5E94\u5546",dataIndex:"supplierName",ellipsis:!0,width:150},{title:"\u91C7\u8D2D\u5408\u540C\u53F7",dataIndex:"contractNo",ellipsis:!0,width:150},{title:"\u5E01\u522B",dataIndex:"currency",ellipsis:!0,width:150},{title:"\u5546\u54C1\u7F16\u7801",dataIndex:"productCode",ellipsis:!0,width:150},{title:"\u5546\u54C1\u540D\u79F0",dataIndex:"productName",ellipsis:!0,width:180},{title:"\u89C4\u683C\u578B\u53F7",dataIndex:"productSpec",ellipsis:!0,width:150},{title:"\u8BA2\u8D27\u6570\u91CF",dataIndex:"orderQuality",ellipsis:!0,width:150},{title:"\u8BA1\u91CF\u5355\u4F4D",dataIndex:"measureUnit",ellipsis:!0,width:150},{title:"\u57FA\u672C\u8BA1\u91CF\u5355\u4F4D\u6570\u91CF",dataIndex:"baseQuality",ellipsis:!0,width:200},{title:"\u57FA\u672C\u8BA1\u91CF\u5355\u4F4D",dataIndex:"baseMeasureUnit",ellipsis:!0,width:200},{title:"\u542B\u7A0E\u5355\u4EF7(\u5143)",dataIndex:"unitPrice",ellipsis:!0,width:150},{title:"\u4EF7\u7A0E\u5408\u8BA1(\u5143)",dataIndex:"totalPrice",ellipsis:!0,width:150},{title:"\u7CAE\u98DF\u6027\u8D28",dataIndex:"nature",ellipsis:!0,width:150},{title:"\u5408\u4F5C\u5BA2\u6237",dataIndex:"cooperatorName",ellipsis:!0,width:150},{title:"\u6536\u8D27\u4ED3\u5E93",dataIndex:"receiveStorehouseName",ellipsis:!0,width:150},{title:"\u4EA4\u8D27\u65E5\u671F",dataIndex:"deliveryDate",ellipsis:!0,width:150},{title:"\u5907\u6CE8",dataIndex:"remark",ellipsis:!0,width:150},{title:"\u5236\u5355\u65F6\u95F4",dataIndex:"createTime",ellipsis:!0,width:150},{title:"\u5236\u5355\u4EBA",dataIndex:"createBy",ellipsis:!0,width:150},{title:"\u4E0D\u901A\u8FC7\u539F\u56E0",dataIndex:"approveReason",ellipsis:!0,width:150},{title:"\u64CD\u4F5C",dataIndex:"edit",fixed:"right",align:"center",width:150}];function tt(c){return M({url:"/purchaseOrderInfo/list",method:"post",params:c})}function at(c){return M({url:"/purchaseOrderInfo/approve",method:"post",data:c})}function lt(c){return M({url:"/purchaseOrderInfo/edit",method:"post",data:c})}const J=c=>(He("data-v-0b9fd5c3"),c=c(),Ke(),c),nt=J(()=>w("span",{class:"separate"},"/",-1)),it=J(()=>w("span",null,"\u5BA1\u6279\u5217\u8868",-1)),st={class:"app-container"},ut={class:"container-wrapper"},ot={key:7},dt=["onClick"],rt=["onClick"],pt={__name:"index",setup(c){Se();const{proxy:A}=Te();A.useDict("sys_point_type");const W=U([{label:"\u5F85\u5BA1\u6279",value:"1"},{label:"\u5BA1\u6279\u901A\u8FC7",value:"3"},{label:"\u5BA1\u6279\u4E0D\u901A\u8FC7",value:"2"}]),y=r([]),V=r([{value:"purchaseOrderCode",label:"\u91C7\u8D2D\u8BA2\u5355\u7F16\u53F7"},{value:"supplierName",label:"\u4F9B\u5E94\u5546\u540D\u79F0"},{value:"productCode",label:"\u5546\u54C1\u7F16\u53F7"},{value:"productName",label:"\u5546\u54C1\u540D\u79F0"},{value:"contractNo",label:"\u91C7\u8D2D\u5408\u540C\u53F7"},{value:"orderUser",label:"\u5236\u5355\u4EBA"}]),F=r(!0),f=r([]),Q=r([]),H=r(""),B=r("");r(null);const K=async()=>{f.value=[],o.value={offset:0,limit:10,orderStatus:"",beginTime:"",endTime:""},x.value="purchaseOrderCode",g.value="",$()},$=()=>{b.current=1,o.value.offset=0,o.value.timeType=1,S()};function X(t){V.value.forEach((e,T)=>{e.value!=t&&(o.value[e.value]="")})}const q=(t,e,T)=>{b.current=t,T&&(b.pageSize=e,o.value.limit=e),o.value.offset=(t-1)*e,S()},b=U({current:1,pageSize:10,total:0,showTotal:t=>`\u5171 ${t} \u6761`,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["2","20","50","100"],onChange:(t,e)=>q(t,e),onShowSizeChange:(t,e)=>q(t,e,"sizeChange")}),k=r("1"),Z=U({queryParams:{offset:0,limit:10,orderStatus:"",beginTime:"",endTime:""},searchType:"purchaseOrderCode",searchValue:""}),{queryParams:o,searchType:x,searchValue:g}=Ce(Z),S=async()=>{F.value=!0,f.value&&f.value.length>0?(o.value.beginTime=f.value[0],o.value.endTime=f.value[1]):(o.value.beginTime="",o.value.endTime=""),o.value[x.value]=g.value,console.log(g.value,x.value,o.value,"searchType.valuesearchType.valuesearchType.value"),tt({...o.value,orderStatus:k.value}).then(t=>{const e=(t==null?void 0:t.data.data)||[];Q.value=e,b.total=(t==null?void 0:t.data.row)||0,F.value=!1})},ee=t=>{B.value=t.id,d.verifyStatus="3",H.value="\u5BA1\u6838",R.value=!0},te=t=>{console.log(t),Xe({file:t.file}).then(e=>{O.success("\u4E0A\u4F20\u6210\u529F"),console.log("\u4E0A\u4F20\u6210\u529F",e.data),y.value[y.value.length-1].fileInfo=e.data,t.onSuccess(e.data,t)}).catch(e=>{t.onError(e)})};function ae(t){const e=t.id;G.confirm({title:"\u64CD\u4F5C\u786E\u8BA4",content:"\u662F\u5426\u786E\u5B9A\u64A4\u9500\uFF1F",onOk(){lt({id:e,orderStatus:4}).then(()=>{S(),O.success("\u64A4\u9500\u6210\u529F")}).catch(()=>{})}})}const R=r(!1),d=U({verifyStatus:null,failureReson:""}),L=r();function P(){Object.assign(d,{verifyStatus:null,failureReson:""})}const le=async()=>{try{if(await L.value.validateFields(),d.verifyStatus==2&&d.failureReson==""){O.error("\u8BF7\u586B\u5199\u4E0D\u901A\u8FC7\u539F\u56E0");return}let t=y.value.map(e=>({path:e.response,fileName:e.name}));t.length==0&&(t=null),console.log(t,"files"),B.value&&at({approveReason:d.failureReson,orderStatus:d.verifyStatus,id:B.value,files:t}).then(e=>{console.log(e),(e==null?void 0:e.code)===200&&(O.success("\u64CD\u4F5C\u6210\u529F"),P(),S())}).finally(e=>{y.value=[]}),R.value=!1}catch(t){console.log(t)}},ne={verifyStatus:[{required:!0,message:"\u5FC5\u9009",trigger:["change"]}]};return S(),(t,e)=>{const T=Ue,ie=Ne,se=Oe,ue=Fe,oe=Be,C=$e,de=Me,re=Ve,pe=Qe,z=qe,D=Le,ce=Pe,m=ze,_e=De,ve=Ee,fe=Ye,me=je,E=Ge,he=Je,ye=Ae,xe=ke("upload-outlined"),ge=We,Ie=G;return s(),h(N,null,[n(T,{title:"\u5BA1\u6279\u91C7\u8D2D\u8BA2\u5355",icon:"icon-rongqi"},{nav:a(()=>[u(p("\u91C7\u96C6\u7BA1\u7406")+" "),nt,it]),_:1}),n(ue,null,{default:a(()=>[n(se,{defaultValue:"",value:k.value,"onUpdate:value":e[0]||(e[0]=l=>k.value=l),onChange:$},{default:a(()=>[(s(!0),h(N,null,Y(W,(l,i)=>(s(),_(ie,{key:i,value:l.value},{default:a(()=>[u(p(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),w("div",st,[n(ce,{justify:"space-between",style:{flex:"1"}},{default:a(()=>[w("div",ut,[n(D,{layout:"inline",ref:"queryRef",model:I(o)},{default:a(()=>[n(C,{style:{width:"308px"},name:"dateRange",label:"\u63D0\u4EA4\u65F6\u95F4"},{default:a(()=>[n(oe,{value:f.value,"onUpdate:value":e[1]||(e[1]=l=>f.value=l),"value-format":"YYYY-MM-DD"},null,8,["value"])]),_:1}),n(C,{label:""},{default:a(()=>[n(pe,{placeholder:"\u8BF7\u8F93\u5165",value:I(g),"onUpdate:value":e[3]||(e[3]=l=>j(g)?g.value=l:null)},{addonBefore:a(()=>[n(re,{style:{width:"120px"},value:I(x),"onUpdate:value":e[2]||(e[2]=l=>j(x)?x.value=l:null),onChange:X},{default:a(()=>[(s(!0),h(N,null,Y(V.value,(l,i)=>(s(),_(de,{key:i,value:l.value},{default:a(()=>[u(p(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["value"])]),_:1}),n(C,null,{default:a(()=>[n(z,{type:"primary",onClick:$},{default:a(()=>[u("\u67E5\u8BE2")]),_:1}),n(z,{type:"primary",ghost:"",onClick:K,style:{"margin-left":"15px"}},{default:a(()=>[u("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),n(me,{spinning:F.value},{default:a(()=>[n(fe,{dataSource:Q.value,columns:k.value=="2"?I(et):I(Ze),pagination:b,scroll:{x:0,y:500}},{bodyCell:a(({column:l,record:i})=>[l.dataIndex==="orderType"?(s(),_(m,{key:0},{default:a(()=>[u(p(i.orderType==1?"\u5B9A\u5411\u8D2D\u9500":"\u81EA\u4E3B\u7ECF\u8425"),1)]),_:2},1024)):v("",!0),l.dataIndex==="natureConvert"?(s(),_(m,{key:1},{default:a(()=>[u(p(i.natureConvert==1?"\u5408\u4F5C\u8F6C\u6362":"\u81EA\u4E3B\u8F6C\u6362"),1)]),_:2},1024)):v("",!0),l.dataIndex==="currency"?(s(),_(m,{key:2},{default:a(()=>[u(p(i.currency==1?"\u4EBA\u6C11\u5E01":"\u7F8E\u5143"),1)]),_:2},1024)):v("",!0),l.dataIndex==="measureUnit"?(s(),_(m,{key:3},{default:a(()=>[u(p(i.measureUnit==1?"\u65A4":i.measureUnit==2?"\u516C\u65A4":"\u5428"),1)]),_:2},1024)):v("",!0),l.dataIndex==="baseMeasureUnit"?(s(),_(m,{key:4},{default:a(()=>[u(p(i.baseMeasureUnit==1?"\u65A4":i.baseMeasureUnit==2?"\u516C\u65A4":"\u5428"),1)]),_:2},1024)):v("",!0),l.dataIndex==="nature"?(s(),_(m,{key:5},{default:a(()=>[u(p(i.nature==1?"\u50A8\u5907\u7CAE":i.nature==2?"\u5546\u54C1\u7CAE":"\u8F6E\u6362\u7CAE\u6CB9"),1)]),_:2},1024)):v("",!0),l.dataIndex==="orderStatus"?(s(),h(N,{key:6},[n(m,null,{default:a(()=>[u(p(i.orderStatus==1?"\u5F85\u5BA1\u6838":i.orderStatus==2?"\u5BA1\u6838\u4E0D\u901A\u8FC7":i.orderStatus==3?"\u5BA1\u6838\u901A\u8FC7":"\u5DF2\u53D6\u6D88"),1)]),_:2},1024),i.orderStatus==2?(s(),_(_e,{key:0,placement:"top"},{title:a(()=>[w("span",null,p(i.approveReason),1)]),default:a(()=>[n(I(Re))]),_:2},1024)):v("",!0)],64)):v("",!0),l.dataIndex==="edit"?(s(),h("span",ot,[n(ve,{size:"middle",style:{color:"#05C059",cursor:"pointer"}},{default:a(()=>[i.orderStatus==1?(s(),h("span",{key:0,onClick:we=>ee(i)},"\u5BA1\u6838",8,dt)):(s(),h("span",{key:1,onClick:we=>ae(i)},"\u64A4\u9500\u5BA1\u6838",8,rt))]),_:2},1024)])):v("",!0)]),_:1},8,["dataSource","columns","pagination"])]),_:1},8,["spinning"])]),n(Ie,{visible:R.value,"onUpdate:visible":e[7]||(e[7]=l=>R.value=l),title:"\u5BA1\u6279\u72B6\u6001",width:"480px",onOk:le,onCancel:P},{default:a(()=>[n(D,{class:"set-form",ref_key:"verifyFormRef",ref:L,model:d,name:"basic",autocomplete:"off",colon:!1,rules:ne},{default:a(()=>[n(C,{label:" ",name:"verifyStatus"},{default:a(()=>[n(he,{value:d.verifyStatus,"onUpdate:value":e[4]||(e[4]=l=>d.verifyStatus=l)},{default:a(()=>[n(E,{value:"3"},{default:a(()=>[u("\u5BA1\u6838\u901A\u8FC7")]),_:1}),n(E,{value:"2"},{default:a(()=>[u("\u5BA1\u6838\u4E0D\u901A\u8FC7")]),_:1})]),_:1},8,["value"])]),_:1}),d.verifyStatus==="2"?(s(),_(C,{key:0,label:""},{default:a(()=>[n(ye,{value:d.failureReson,"onUpdate:value":e[5]||(e[5]=l=>d.failureReson=l),"show-count":"",rows:4,maxlength:200,placeholder:"\u8F93\u5165\u4E0D\u901A\u8FC7\u7684\u539F\u56E0"},null,8,["value"])]),_:1})):v("",!0),n(ge,{"file-list":y.value,"onUpdate:fileList":e[6]||(e[6]=l=>y.value=l),customRequest:te,name:"file",multiple:!0},{default:a(()=>[w("a",null,[n(xe),u(" \u9644\u4EF6+ ")])]),_:1},8,["file-list"])]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},vt=be(pt,[["__scopeId","data-v-0b9fd5c3"]]);export{vt as default};
