import{aI as C,z as ce,r as p,A,V as de,C as pe,o as R,c as J,d as a,w as n,e as _,t as _e,h as k,D as N,f as y,g as r,i as me,Q as M,F as fe,m as P,M as ve,_ as ge,l as ye,n as he,B as xe,s as Ce,K as we,a5 as be,L as ke,x as Ne,a6 as Ie,a3 as Se,q as qe,N as Te,O as Re,G as Pe}from"./index.192c8708.js";const $e=[{title:"\u8D28\u68C0\u6307\u6807",dataIndex:"targetContent",ellipsis:!0},{title:"\u68C0\u9A8C\u4F9D\u636E",dataIndex:"accordance",ellipsis:!0},{title:"\u6807\u51C6",dataIndex:"standard",ellipsis:!0},{title:"\u5355\u4F4D",dataIndex:"unit",ellipsis:!0},{title:"\u6765\u6E90",dataIndex:"resources",ellipsis:!0}];function ze(i){return C({url:"/qualityPlan/list",method:"post",params:i})}function De(i){return C({url:"/qualityPlan/add",method:"post",params:i})}function Le(i){return C({url:"/qualityPlan/edit",method:"post",params:i})}function Ue(i){return C({url:"/qualityPlan/delete/"+i,method:"post"})}function G(i){return C({url:"/qualityTarget/selectList",method:"post",params:i})}const Z=i=>(Te("data-v-aa400a12"),i=i(),Re(),i),je=Z(()=>y("span",{class:"separate"},"/",-1)),Be=Z(()=>y("span",null,"\u8D28\u68C0\u65B9\u6848",-1)),Fe={class:"app-container"},Ke={class:"container-wrapper"},Qe={key:0},Ve={class:"app-container"},Ee={class:"container-wrapper"},Oe={__name:"index",setup(i){const{proxy:I}=Pe(),f=p(!1),w=p([]);p(!1);const $=p(!0),z=p(!0);p([]);const h=p("\u8D28\u68C0\u65B9\u6848"),S=p([]),H=p([{value:"\u8D28\u91CF\u6307\u6807\u68C0\u9A8C",label:"\u8D28\u91CF\u6307\u6807\u68C0\u9A8C"}]);function D(t,e,u,o){if(o!==0&&t===e[o-1][u])return 0;let c=1;for(let d=o+1;d<e.length&&(console.log(t,e[d][u],"texttexttexttext"),t===e[d][u]);d++)c++;return c}const W=[{title:"\u8D28\u68C0\u65B9\u6848\u540D\u79F0",dataIndex:"planName",key:"planName",ellipsis:!0,customRender:({text:t,record:e,index:u})=>{console.log(u,"index");const o={children:t!==null?t:"",props:{}};return o.props.rowSpan=D(t,w.value,"planName",u),o}},{title:"\u8D28\u68C0\u6307\u6807",dataIndex:"targetContent",ellipsis:!0},{title:"\u68C0\u9A8C\u4F9D\u636E",dataIndex:"accordance",ellipsis:!0},{title:"\u6807\u51C6",dataIndex:"standard",ellipsis:!0},{title:"\u5355\u4F4D",dataIndex:"unit",ellipsis:!0},{title:"\u6765\u6E90",dataIndex:"resources",ellipsis:!0},{title:"\u64CD\u4F5C",dataIndex:"operation",fixed:"right",align:"center",customRender:({text:t,record:e,index:u})=>{const o={children:e.planName,props:{}};return o.props.rowSpan=D(e.planName,w.value,"planName",u),o}}],X=A({categoryName:"",categoryData:["Zhejiang","Jiangsu"],form:{},queryParams:{offset:0,limit:10,dictName:void 0,dictType:void 0,status:void 0},queryParamsTwo:{},rules:{planName:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],targetType:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:m,queryParamsTwo:l,form:Y,rules:ee,categoryName:Ae,categoryData:Je}=de(X);function x(){$.value=!0,ze(I.addDateRange(m.value)).then(t=>{const e=t==null?void 0:t.data;w.value=e.data,g.total=(e==null?void 0:e.row)||0,g.pageSize=e==null?void 0:e.trueNum,$.value=!1})}function te(){Y.value={},l.value={},v.value=[],I.resetForm("queryRef")}function L(){g.current=1,m.value.offset=0,x()}function U(){m.value.planName=void 0,I.resetForm("queryRef"),L()}function ae(){l.value.targetContent="",l.value.accordance="",j()}function j(){G(l.value).then(t=>{t.code==200&&(S.value=t.data)})}const B=(t,e,u)=>{g.current=t,u&&(g.pageSize=e,m.value.limit=e),m.value.offset=(t-1)*e,x()},g=A({current:1,pageSize:10,total:0,showTotal:t=>`\u5171 ${t} \u6761`,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["2","20","50","100"],onChange:(t,e)=>B(t,e),onShowSizeChange:(t,e)=>B(t,e,"sizeChange")}),v=p([]),F=()=>({selectedRowKeys:v.value,getCheckboxProps:t=>({props:{defaultChecked:v.value.includes(t.id)}}),onChange:(t,e)=>{v.value=t,console.log(t,e,"selectedRowKeys")}});function K(t){te(),t.id?(h.value="\u4FEE\u6539\u8D28\u68C0\u65B9\u6848",l.value.id=t.id,l.value.planName=t.planName,l.value.targetType=t.targetType):h.value="\u65B0\u589E\u8D28\u68C0\u65B9\u6848",G({planId:t.id}).then(e=>{if(e.code==200){S.value=e.data;let u=[];e.data.forEach((o,c)=>{o.selected&&u.push(o.id)}),v.value=u,F(),f.value=!0}})}const q=p(),ne=async()=>{try{const t=await q.value.validateFields();console.log(t),l.value.id?Le({...l.value,targets:v.value.join(",")}).then(e=>{e.code==200&&(P.success("\u4FEE\u6539\u6210\u529F"),x(),f.value=!1)}):De({...l.value,targets:v.value.join(",")}).then(e=>{e.code==200&&(f.value=!1,P.success("\u65B0\u589E\u6210\u529F"),x())})}catch{}};function le(t){const e=t.id;ve.confirm({title:"\u64CD\u4F5C\u786E\u8BA4",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u8BE5\u6570\u636E\u9879\uFF1F",onOk(){Ue(e).then(()=>{U(),P.success("\u5220\u9664\u6210\u529F")}).catch(()=>{})}})}return x(),(t,e)=>{const u=ge,o=ye,c=he,d=xe,oe=pe("plus-outlined"),T=Ce,Q=we,V=be,se=ke,E=Ne,ue=Ie,re=Se,O=qe;return R(),J(fe,null,[a(u,{title:h.value,icon:"icon-xuniziyuan",back:"/overview"},{nav:n(()=>[_(_e("\u8D28\u68C0\u65B9\u6848")+" "),je,Be]),_:1},8,["title"]),k(y("div",Fe,[y("div",Ke,[k(a(T,{model:r(m),ref_key:"queryRef",ref:q,layout:"inline","label-width":"68px"},{default:n(()=>[a(c,{name:"planName"},{default:n(()=>[a(o,{label:"\u8D28\u68C0\u65B9\u6848\u540D\u79F0",value:r(m).planName,"onUpdate:value":e[0]||(e[0]=s=>r(m).planName=s),placeholder:"\u8BF7\u8F93\u5165",clearable:"",style:{width:"240px"}},null,8,["value"])]),_:1}),a(c,null,{default:n(()=>[a(d,{type:"primary",onClick:L},{default:n(()=>[_("\u67E5\u8BE2")]),_:1}),a(d,{type:"primary",ghost:"",onClick:U,style:{"margin-left":"15px"}},{default:n(()=>[_("\u91CD\u7F6E")]),_:1})]),_:1}),a(c,{style:{"margin-left":"165px"}},{default:n(()=>[a(d,{type:"primary",onClick:K},{icon:n(()=>[a(oe)]),default:n(()=>[_(" \u65B0\u589E ")]),_:1})]),_:1})]),_:1},8,["model"]),[[N,z.value]])]),a(E,{dataSource:w.value,columns:W,pagination:r(g)},{bodyCell:n(({column:s,record:b})=>[s.dataIndex==="operation"?(R(),J("span",Qe,[a(se,{size:"small"},{default:n(()=>[a(Q,{onClick:ie=>K(b)},{default:n(()=>[_("\u7F16\u8F91")]),_:2},1032,["onClick"]),a(V,{type:"vertical",style:{"background-color":"#05C059"}}),b.roleId!==1?(R(),me(Q,{key:0,onClick:ie=>le(b)},{default:n(()=>[_("\u5220\u9664")]),_:2},1032,["onClick"])):M("",!0)]),_:2},1024)])):M("",!0)]),_:1},8,["dataSource","pagination"])],512),[[N,!f.value]]),k(y("div",Ve,[y("div",Ee,[a(T,{style:{"margin-bottom":"20px",display:"flex","justify-content":"space-between"}},{default:n(()=>[a(d,{type:"primary",onClick:e[1]||(e[1]=s=>{f.value=!f.value,h.value="\u8D28\u68C0\u65B9\u6848"})},{default:n(()=>[_("\u8FD4\u56DE\u4E0A\u4E00\u9875")]),_:1}),a(d,{type:"primary",onClick:e[2]||(e[2]=s=>{ne(),h.value="\u8D28\u68C0\u65B9\u6848"})},{default:n(()=>[_("\u4FDD\u5B58")]),_:1})]),_:1}),k(a(T,{model:r(l),rules:r(ee),ref_key:"queryRef",ref:q,layout:"inline","label-width":"68px"},{default:n(()=>[a(O,null,{default:n(()=>[a(c,{label:"\u8D28\u68C0\u65B9\u6848\u540D\u79F0",name:"planName"},{default:n(()=>[a(ue,{value:r(l).planName,"onUpdate:value":e[3]||(e[3]=s=>r(l).planName=s),placeholder:"\u8BF7\u8F93\u5165",clearable:"",style:{width:"240px"}},null,8,["value"])]),_:1}),a(c,{label:"\u6307\u6807\u7C7B\u578B",name:"targetType"},{default:n(()=>[a(re,{value:r(l).targetType,"onUpdate:value":e[4]||(e[4]=s=>r(l).targetType=s),placeholder:"\u8BF7\u9009\u62E9",clearable:"",style:{width:"240px"},options:H.value},null,8,["value","options"])]),_:1})]),_:1}),a(V),a(O,null,{default:n(()=>[a(c,{name:"targetContent"},{default:n(()=>[a(o,{label:"\u8D28\u68C0\u6307\u6807",value:r(l).targetContent,"onUpdate:value":e[5]||(e[5]=s=>r(l).targetContent=s),placeholder:"\u8BF7\u8F93\u5165",clearable:"",style:{width:"240px"}},null,8,["value"])]),_:1}),a(c,{name:"accordance"},{default:n(()=>[a(o,{label:"\u68C0\u9A8C\u4F9D\u636E",value:r(l).accordance,"onUpdate:value":e[6]||(e[6]=s=>r(l).accordance=s),placeholder:"\u8BF7\u8F93\u5165",clearable:"",style:{width:"240px"}},null,8,["value"])]),_:1}),a(c,null,{default:n(()=>[a(d,{type:"primary",onClick:j},{default:n(()=>[_("\u641C\u7D22")]),_:1}),a(d,{type:"primary",ghost:"",onClick:ae,style:{"margin-left":"15px"}},{default:n(()=>[_("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"]),[[N,z.value]])]),a(E,{dataSource:S.value,columns:r($e),"row-selection":F(),rowKey:s=>s.id,pagination:!1},{bodyCell:n(({column:s,record:b})=>[]),_:1},8,["dataSource","columns","row-selection","rowKey"])],512),[[N,f.value]])],64)}}},Ge=ce(Oe,[["__scopeId","data-v-aa400a12"]]);export{Ge as default};
