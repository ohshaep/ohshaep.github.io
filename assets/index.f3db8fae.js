import{z as oe,ai as se,r as o,aj as ie,o as s,c as i,d as t,w as l,e as y,t as L,f as _,g as F,F as O,W as pe,Q as d,i as ce,m as I,_ as ue,a6 as de,n as re,a3 as _e,B as me,L as ve,s as fe,x as he,S as ge,N as Se,O as ye}from"./index.192c8708.js";import{_ as ke}from"./index.fab15c34.js";import{d as we}from"./common.e897a13c.js";import{u as Ce}from"./common.0ebad352.js";import{g as be,f as xe,a as P}from"./artMag.f64bd10b.js";import V from"./AddModal.0046a370.js";import E from"./DetailModal.3a59c5db.js";import J from"./EditModal.4a0ab3be.js";import"./qualityReport.6dc17b5d.js";import"./UploadOutlined.4d52294f.js";import"./index.ad48934c.js";const Fe=[{title:"\u5E8F\u53F7",align:"center",width:80,customRender:({text:m,record:k,index:S})=>parseInt(S)+1},{title:"\u8303\u672C\u540D\u79F0",ellipsis:!0,align:"center",dataIndex:"templateName"},{title:"\u8303\u672C\u72B6\u6001",width:100,align:"center",dataIndex:"approvalState"},{title:"\u53D1\u5E03\u65F6\u95F4",width:200,align:"center",dataIndex:"publishTime"},{title:"\u8303\u672C\u8BF4\u660E",ellipsis:!0,align:"center",dataIndex:"remark"},{title:"\u64CD\u4F5C",dataIndex:"action",align:"center",fixed:"right",width:200,scopedSlots:{customRender:"action"}}],Q=[{value:"1",label:"\u5F85\u5BA1\u6279"},{value:"2",label:"\u5BA1\u6838\u4E0D\u901A\u8FC7"},{value:"3",label:"\u5F85\u53D1\u5E03"},{value:"4",label:"\u5DF2\u53D1\u5E03"}];const M=m=>(Se("data-v-c5fe25e5"),m=m(),ye(),m),Ie=M(()=>_("span",{class:"separate"},"/",-1)),Me=M(()=>_("span",null,"\u8303\u672C\u7BA1\u7406",-1)),Ne={class:"app-container"},$e={class:"container-wrapper"},ze={class:"table-operator"},De={key:1},Be=["onClick"],Re=["onClick"],Le=["onClick"],Oe=["onClick"],Pe=["onClick"],Ve=M(()=>_("span",null,"\u5220\u9664",-1)),Ee={__name:"index",setup(m){se({components:{AddModal:V,DetailModal:E,EditModal:J}});const k=o(null),S=o(null),N=o(null),p=o({templateName:"",approvalState:void 0}),c=o({}),$=o(0),z=o(10),v=o({current:1,pageSize:10,pageSizeOptions:["10","20","30","40","100"],total:0,showTotal:e=>`\u5171 ${e} \u6761`,hideOnSinglePage:!1,onChange:(e,a)=>D(e,a),onShowSizeChange:(e,a)=>{D(e,a,"sizeChange")},showSizeChanger:!0,showQuickJumper:!0}),D=(e,a,g)=>{v.value.current=e,console.log(e,"page"),g==="sizeChange"&&(v.value.pageSize=a),$.value=(e-1)*10,z.value=a,f()},f=e=>{console.log(c.value,"searchForm"),c.value.offset=$.value,c.value.limit=z.value,c.value.templateName=p.value.templateName,c.value.approvalState=p.value.approvalState,h()},w=o(!1),B=o([]),h=async()=>{w.value=!0,console.log(c.value);const e=await be(c.value);e.code===200&&(B.value=e.data.records,v.value.total=e.data.total,C.value=!1,w.value=!1)};ie(()=>{f()});const T=o(null),A=()=>{c.value={offset:0,limit:10},v.value.current=1,p.value={},h()},U=Ce(),C=o(!1),j=async e=>{const a={path:e.fileInfo,fileName:e.filename},g=await we(a);U(g,e.filename),C.value=!0},q=e=>{console.log(e),xe(e.id).then(a=>{a.code===200&&(I.success("\u5220\u9664\u6210\u529F"),h())})},W=e=>{k.value.showModal(e)},G=e=>{N.value.showModal(JSON.parse(JSON.stringify(e)))},H=async e=>{e.approvalState=="3"&&(await P({id:e.id,approvalState:"4"}),I.success("\u53D1\u5E03\u6210\u529F")),h()},K=async e=>{e.approvalState=="4"&&(await P({id:e.id,approvalState:"3"}),I.success("\u505C\u6B62\u53D1\u5E03\u6210\u529F")),h()},X=e=>{S.value.showModal(e)};return(e,a)=>{const g=ue,Y=de,b=re,Z=_e,x=me,R=ve,ee=fe,ae=ke,te=he,ne=ge;return s(),i(O,null,[t(g,{title:"\u8303\u672C\u7BA1\u7406",icon:"icon-rongqi"},{nav:l(()=>[y(L("\u8303\u672C\u7BA1\u7406")+" "),Ie,Me]),_:1}),_("div",Ne,[_("div",$e,[t(ee,{layout:"inline",ref_key:"searchFormRef",ref:T,model:p.value},{default:l(()=>[t(b,{label:"\u8303\u672C\u540D\u79F0"},{default:l(()=>[t(Y,{value:p.value.templateName,"onUpdate:value":a[0]||(a[0]=r=>p.value.templateName=r),placeholder:"\u8BF7\u8F93\u5165\u8303\u672C\u540D\u79F0",clearable:"",style:{width:"240px"}},null,8,["value"])]),_:1}),t(b,null,{default:l(()=>[t(Z,{label:"\u8303\u672C\u72B6\u6001",value:p.value.approvalState,"onUpdate:value":a[1]||(a[1]=r=>p.value.approvalState=r),placeholder:"\u8BF7\u9009\u62E9\u8303\u672C\u72B6\u6001",clearable:"",style:{width:"240px"},options:F(Q)},null,8,["value","options"])]),_:1}),t(b,null,{default:l(()=>[t(R,null,{default:l(()=>[t(x,{type:"primary",onClick:f},{default:l(()=>[y("\u67E5\u8BE2")]),_:1}),t(x,{type:"primary",ghost:"",onClick:A},{default:l(()=>[y("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),_("div",ze,[t(x,{type:"primary",style:{width:"80px"},onClick:a[2]||(a[2]=r=>W(e.record))},{default:l(()=>[y("\u65B0\u589E")]),_:1})])]),_("div",null,[t(ne,{spinning:w.value},{default:l(()=>[t(te,{dataSource:B.value,columns:F(Fe),pagination:v.value,scroll:{x:0,y:430}},{bodyCell:l(({column:r,record:n})=>[r.dataIndex==="approvalState"?(s(!0),i(O,{key:0},pe(F(Q),(u,le)=>(s(),i("div",{key:le},L(n.approvalState==u.value?u.label:""),1))),128)):d("",!0),r.dataIndex==="action"?(s(),i("span",De,[t(R,{size:"middle",style:{color:"#05c059",cursor:"pointer"}},{default:l(()=>[n.approvalState!==4?(s(),i("span",{key:0,onClick:u=>X(n)},"\u8BE6\u60C5",8,Be)):d("",!0),n.approvalState==1?(s(),i("span",{key:1,onClick:u=>G(n)},"\u7F16\u8F91",8,Re)):d("",!0),n.approvalState==3?(s(),i("span",{key:2,onClick:u=>H(n)},"\u53D1\u5E03",8,Le)):d("",!0),n.approvalState==4?(s(),i("span",{key:3,onClick:u=>j(n)},"\u4E0B\u8F7D\u8303\u672C",8,Oe)):d("",!0),n.approvalState==4?(s(),i("span",{key:4,onClick:u=>K(n)},"\u505C\u6B62\u53D1\u5E03",8,Pe)):d("",!0),C.value==!0&&n.approvalState==4?(s(),ce(ae,{key:5,title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:u=>q(n)},{default:l(()=>[Ve]),_:2},1032,["onConfirm"])):d("",!0)]),_:2},1024)])):d("",!0)]),_:1},8,["dataSource","columns","pagination"])]),_:1},8,["spinning"])])]),t(V,{ref_key:"addModal",ref:k,onRefresh:f},null,512),t(E,{ref_key:"detailModal",ref:S},null,512),t(J,{ref_key:"editModal",ref:N,onRefresh:f},null,512)],64)}}},Xe=oe(Ee,[["__scopeId","data-v-c5fe25e5"]]);export{Xe as default};
