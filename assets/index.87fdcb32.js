import{aI as q,z as Ue,a as Oe,A as N,r,V as Re,ca as Te,C as Fe,o as s,c as g,d as n,w as t,e as o,t as c,F as M,W as Q,i as v,f as _,g as x,R as Z,E as Ne,Q as m,bU as Me,h as $e,cb as Be,D as De,cc as Le,G as Pe,M as ee,m as D,_ as Ve,a$ as ze,b0 as Qe,y as qe,b3 as je,n as Ee,a8 as Ye,a9 as Ae,a6 as Ge,B as Ke,s as Je,q as We,a4 as He,aB as Xe,L as Ze,x as et,S as tt,aa as at,ab as lt,ac as nt,cd as it,N as st,O as ot}from"./index.192c8708.js";import{u as ut}from"./common.e897a13c.js";const dt=[{title:"\u9500\u552E\u8BA2\u5355\u7F16\u53F7",dataIndex:"saleOrderCode",ellipsis:!0,width:180},{title:"\u8BA2\u5355\u7C7B\u578B",dataIndex:"orderType",width:120},{title:"\u5408\u4F5C\u5BA2\u6237",dataIndex:"cooperatorName",ellipsis:!0,width:150},{title:"\u9500\u552E\u5408\u540C\u53F7",dataIndex:"contractNo",ellipsis:!0,width:150},{title:"\u5546\u54C1\u7F16\u7801",dataIndex:"productCode",ellipsis:!0,width:150},{title:"\u5546\u54C1\u540D\u79F0",dataIndex:"productName",ellipsis:!0,width:180},{title:"\u89C4\u683C\u578B\u53F7",dataIndex:"productSpec",ellipsis:!0,width:150},{title:"\u6570\u91CF",dataIndex:"orderQuality",ellipsis:!0,width:150},{title:"\u8BA1\u91CF\u5355\u4F4D",dataIndex:"measureUnit",ellipsis:!0,width:150},{title:"\u57FA\u672C\u8BA1\u91CF\u5355\u4F4D\u6570\u91CF",dataIndex:"baseQuality",ellipsis:!0,width:200},{title:"\u57FA\u672C\u8BA1\u91CF\u5355\u4F4D",dataIndex:"baseMeasureUnit",ellipsis:!0,width:150},{title:"\u542B\u7A0E\u5355\u4EF7(\u5143)",dataIndex:"unitPrice",ellipsis:!0,width:150},{title:"\u4EF7\u7A0E\u5408\u8BA1(\u5143)",dataIndex:"totalPrice",ellipsis:!0,width:150},{title:"\u53D1\u8D27\u4ED3\u5E93",dataIndex:"storehouseName",ellipsis:!0,width:150},{title:"\u53D1\u8D27\u65E5\u671F",dataIndex:"sendDate",ellipsis:!0,width:150},{title:"\u5907\u6CE8",dataIndex:"remark",ellipsis:!0,width:150},{title:"\u5236\u5355\u65F6\u95F4",dataIndex:"createTime",ellipsis:!0,width:160},{title:"\u5236\u5355\u4EBA",dataIndex:"createBy",ellipsis:!0,width:150},{title:"\u64CD\u4F5C",dataIndex:"edit",fixed:"right",align:"center",width:150}],rt=[{title:"\u9500\u552E\u8BA2\u5355\u7F16\u53F7",dataIndex:"saleOrderCode",ellipsis:!0,width:180},{title:"\u8BA2\u5355\u7C7B\u578B",dataIndex:"orderType",width:120},{title:"\u5408\u4F5C\u5BA2\u6237",dataIndex:"cooperatorName",ellipsis:!0,width:150},{title:"\u9500\u552E\u5408\u540C\u53F7",dataIndex:"contractNo",ellipsis:!0,width:120},{title:"\u5546\u54C1\u7F16\u7801",dataIndex:"productCode",ellipsis:!0,width:150},{title:"\u5546\u54C1\u540D\u79F0",dataIndex:"productName",ellipsis:!0,width:180},{title:"\u89C4\u683C\u578B\u53F7",dataIndex:"productSpec",ellipsis:!0,width:150},{title:"\u6570\u91CF",dataIndex:"orderQuality",ellipsis:!0,width:150},{title:"\u8BA1\u91CF\u5355\u4F4D",dataIndex:"measureUnit",ellipsis:!0,width:150},{title:"\u57FA\u672C\u8BA1\u91CF\u5355\u4F4D\u6570\u91CF",dataIndex:"baseQuality",ellipsis:!0,width:200},{title:"\u57FA\u672C\u8BA1\u91CF\u5355\u4F4D",dataIndex:"baseMeasureUnit",ellipsis:!0,width:150},{title:"\u542B\u7A0E\u5355\u4EF7(\u5143)",dataIndex:"unitPrice",ellipsis:!0,width:150},{title:"\u4EF7\u7A0E\u5408\u8BA1(\u5143)",dataIndex:"totalPrice",ellipsis:!0,width:150},{title:"\u53D1\u8D27\u4ED3\u5E93",dataIndex:"storehouseName",ellipsis:!0,width:150},{title:"\u53D1\u8D27\u65E5\u671F",dataIndex:"sendDate",ellipsis:!0,width:150},{title:"\u5907\u6CE8",dataIndex:"remark",ellipsis:!0,width:150},{title:"\u5236\u5355\u65F6\u95F4",dataIndex:"createTime",ellipsis:!0,width:160},{title:"\u5236\u5355\u4EBA",dataIndex:"createBy",ellipsis:!0,width:150},{title:"\u4E0D\u901A\u8FC7\u539F\u56E0",dataIndex:"approveReason",ellipsis:!0,width:150},{title:"\u64CD\u4F5C",dataIndex:"edit",fixed:"right",align:"center",width:150}];function pt(f){return q({url:"/saleOrderInfo/list",method:"post",params:f})}function ct(f){return q({url:"/saleOrderInfo/approve",method:"post",data:f})}function _t(f){return q({url:"/saleOrderInfo/edit",method:"post",data:f})}const j=f=>(st("data-v-25fb5478"),f=f(),ot(),f),ft=j(()=>_("span",{class:"separate"},"/",-1)),vt=j(()=>_("span",null,"\u5BA1\u6279\u5217\u8868",-1)),mt={class:"app-container"},gt={class:"container-wrapper"},ht={key:7},yt=["onClick"],xt=["onClick"],wt={style:{display:"flex","align-items":"center"}},It=["onClick"],bt={class:"ant-upload-drag-icon"},Ct=j(()=>_("p",{class:"ant-upload-text"},[_("em",null,"\u70B9\u51FB\u4E0A\u4F20\u4ED8\u6B3E\u51ED\u8BC1")],-1)),St={class:"dialog-footer"},kt={__name:"index",setup(f){Oe();const{proxy:te}=Pe();te.useDict("sys_point_type");const ae=N([{label:"\u5F85\u5BA1\u6279",value:"1"},{label:"\u5BA1\u6279\u901A\u8FC7",value:"3"},{label:"\u5BA1\u6279\u4E0D\u901A\u8FC7",value:"2"}]),E=r([{value:"saleOrderCode",label:"\u9500\u552E\u8BA2\u5355\u7F16\u53F7"},{value:"cooperatorName",label:"\u5BA2\u6237\u540D\u79F0"},{value:"productCode",label:"\u5546\u54C1\u7F16\u7801"},{value:"productName",label:"\u5546\u54C1\u540D\u79F0"},{value:"contractNo",label:"\u9500\u552E\u5408\u540C\u53F7"},{value:"orderUser",label:"\u5236\u5355\u4EBA"}]),L=r(!0),w=r([]),Y=r([]),le=r(""),P=r(""),h=r([]),I=r([]),C=r([]);r(null);const ne=async()=>{w.value=[],d.value={offset:0,limit:10,orderStatus:"",beginTime:"",endTime:""},O.value="saleOrderCode",R.value="",k()},k=()=>{U.current=1,d.value.offset=0,d.value.timeType=1,T()};function ie(l){E.value.forEach((e,u)=>{e.value!=l&&(d.value[e.value]="")})}const A=(l,e,u)=>{U.current=l,u&&(U.pageSize=e,d.value.limit=e),d.value.offset=(l-1)*e,T()},U=N({current:1,pageSize:10,total:0,showTotal:l=>`\u5171 ${l} \u6761`,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["2","20","50","100"],onChange:(l,e)=>A(l,e),onShowSizeChange:(l,e)=>A(l,e,"sizeChange")}),$=r("1"),se=N({queryParams:{offset:0,limit:10,orderStatus:"",beginTime:"",endTime:""},searchType:"saleOrderCode",searchValue:""}),{queryParams:d,searchType:O,searchValue:R}=Re(se),T=async()=>{L.value=!0,w.value&&w.value.length>0?(d.value.beginTime=w.value[0],d.value.endTime=w.value[1]):(d.value.beginTime="",d.value.endTime=""),d.value[O.value]=R.value,pt({...d.value,orderStatus:$.value}).then(l=>{const e=(l==null?void 0:l.data.data)||[];Y.value=e,U.total=(l==null?void 0:l.data.row)||0,L.value=!1})},oe=l=>{P.value=l.id,p.verifyStatus="3",le.value="\u5BA1\u6838",B.value=!0};function ue(l){const e=l.id;ee.confirm({title:"\u64CD\u4F5C\u786E\u8BA4",content:"\u662F\u5426\u786E\u5B9A\u64A4\u9500\uFF1F",onOk(){_t({id:e,orderStatus:4}).then(()=>{T(),D.success("\u64A4\u9500\u6210\u529F")}).catch(()=>{})}})}const B=r(!1),p=N({verifyStatus:null,failureReson:""}),y=N({open:!1,title:"",isUploading:!1,updateSupport:!1,headers:{Authorization:Te(),"Content-Type":"multipart/form-data"}});async function de(){if(C.value=[],I.value=[],h.value.length<1){y.open=!1;return}console.log();let l=h.value[0].originFileObj;if(!l)return;if(!(l.size/1024/1024<50)){const z=h.indexOf(l);return h.splice(z,1),ElMessage.warning("\u4E0A\u4F20\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 50MB!!"),!1}var u=new FormData;u.append("file",l);const V=await ut(u,y.updateSupport);C.value.push(V.data),console.log("uploadUrl-----------",C.toString()),I.value.push(h.value[0].originFileObj.name),D.success("\u4E0A\u4F20\u6210\u529F"),y.open=!1}function re(l){I.value.splice(l,1),C.value[l]&&(C.value.splice(l,1),h.value.splice(l,1))}const G=r();function K(){I.value=[],Object.assign(p,{verifyStatus:null,failureReson:""})}const pe=async()=>{var l,e;try{if(await G.value.validateFields(),p.verifyStatus==2&&p.failureReson==""){D.error("\u8BF7\u586B\u5199\u4E0D\u901A\u8FC7\u539F\u56E0");return}P.value&&ct({payProofName:(l=I.value)==null?void 0:l.toString(),payProofFile:(e=C.value)==null?void 0:e.toString(),approveReason:p.failureReson,orderStatus:p.verifyStatus,id:P.value,saleStatus:"2"}).then(u=>{console.log(u),(u==null?void 0:u.code)===200&&(I.value=[],D.success("\u64CD\u4F5C\u6210\u529F"),K(),T())}),B.value=!1}catch(u){console.log(u)}},ce={verifyStatus:[{required:!0,message:"\u5FC5\u9009",trigger:["change"]}]};return T(),(l,e)=>{const u=Ve,V=ze,z=Qe,_e=qe,fe=je,S=Ee,ve=Ye,me=Ae,ge=Ge,F=Ke,J=Je,he=We,b=He,ye=Xe,xe=Ze,we=et,Ie=tt,W=at,be=lt,Ce=nt,Se=Fe("upload-outlined"),ke=it,H=ee;return s(),g(M,null,[n(u,{title:"\u5BA1\u6279\u9500\u552E\u8BA2\u5355",icon:"icon-rongqi"},{nav:t(()=>[o(c("\u91C7\u96C6\u7BA1\u7406")+" "),ft,vt]),_:1}),n(_e,null,{default:t(()=>[n(z,{defaultValue:"",value:$.value,"onUpdate:value":e[0]||(e[0]=a=>$.value=a),onChange:k},{default:t(()=>[(s(!0),g(M,null,Q(ae,(a,i)=>(s(),v(V,{key:i,value:a.value},{default:t(()=>[o(c(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),_("div",mt,[n(he,{justify:"space-between",style:{flex:"1"}},{default:t(()=>[_("div",gt,[n(J,{layout:"inline",ref:"queryRef",model:x(d)},{default:t(()=>[n(S,{style:{width:"308px"},name:"dateRange"},{default:t(()=>[n(fe,{label:"\u63D0\u4EA4\u65F6\u95F4",value:w.value,"onUpdate:value":e[1]||(e[1]=a=>w.value=a),"value-format":"YYYY-MM-DD",onChange:k},null,8,["value"])]),_:1}),n(S,{label:""},{default:t(()=>[n(ge,{placeholder:"\u8BF7\u8F93\u5165",value:x(R),"onUpdate:value":e[3]||(e[3]=a=>Z(R)?R.value=a:null),onKeyup:Ne(k,["enter"])},{addonBefore:t(()=>[n(me,{style:{width:"120px"},value:x(O),"onUpdate:value":e[2]||(e[2]=a=>Z(O)?O.value=a:null),onChange:ie},{default:t(()=>[(s(!0),g(M,null,Q(E.value,(a,i)=>(s(),v(ve,{key:i,value:a.value},{default:t(()=>[o(c(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["value"])]),_:1}),n(S,null,{default:t(()=>[n(F,{type:"primary",onClick:k},{default:t(()=>[o("\u67E5\u8BE2")]),_:1}),n(F,{type:"primary",ghost:"",onClick:ne,style:{"margin-left":"15px"}},{default:t(()=>[o("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),n(Ie,{spinning:L.value},{default:t(()=>[n(we,{dataSource:Y.value,columns:$.value=="2"?x(rt):x(dt),pagination:U,scroll:{x:0,y:500}},{bodyCell:t(({column:a,record:i})=>[a.dataIndex==="orderType"?(s(),v(b,{key:0},{default:t(()=>[o(c(i.orderType==1?"\u5B9A\u5411\u8D2D\u9500":"\u81EA\u4E3B\u7ECF\u8425"),1)]),_:2},1024)):m("",!0),a.dataIndex==="natureConvert"?(s(),v(b,{key:1},{default:t(()=>[o(c(i.natureConvert==1?"\u5408\u4F5C\u8F6C\u6362":"\u81EA\u4E3B\u8F6C\u6362"),1)]),_:2},1024)):m("",!0),a.dataIndex==="currency"?(s(),v(b,{key:2},{default:t(()=>[o(c(i.currency==1?"\u4EBA\u6C11\u5E01":"\u7F8E\u5143"),1)]),_:2},1024)):m("",!0),a.dataIndex==="measureUnit"?(s(),v(b,{key:3},{default:t(()=>[o(c(i.measureUnit==1?"\u65A4":i.measureUnit==2?"\u516C\u65A4":"\u5428"),1)]),_:2},1024)):m("",!0),a.dataIndex==="baseMeasureUnit"?(s(),v(b,{key:4},{default:t(()=>[o(c(i.baseMeasureUnit==1?"\u65A4":i.baseMeasureUnit==2?"\u516C\u65A4":"\u5428"),1)]),_:2},1024)):m("",!0),a.dataIndex==="nature"?(s(),v(b,{key:5},{default:t(()=>[o(c(i.nature==1?"\u50A8\u5907\u7CAE":i.nature==2?"\u5546\u54C1\u7CAE":"\u8F6E\u6362\u7CAE\u6CB9"),1)]),_:2},1024)):m("",!0),a.dataIndex==="orderStatus"?(s(),g(M,{key:6},[n(b,null,{default:t(()=>[o(c(i.orderStatus==1?"\u5F85\u5BA1\u6838":i.orderStatus==2?"\u5BA1\u6838\u4E0D\u901A\u8FC7":i.orderStatus==3?"\u5BA1\u6838\u901A\u8FC7":"\u5DF2\u53D6\u6D88"),1)]),_:2},1024),i.orderStatus==2?(s(),v(ye,{key:0,placement:"top"},{title:t(()=>[_("span",null,c(i.approveReason),1)]),default:t(()=>[n(x(Me))]),_:2},1024)):m("",!0)],64)):m("",!0),a.dataIndex==="edit"?(s(),g("span",ht,[n(xe,{size:"middle",style:{color:"#05C059",cursor:"pointer"}},{default:t(()=>[i.orderStatus==1?(s(),g("span",{key:0,onClick:X=>oe(i)},"\u5BA1\u6838",8,yt)):(s(),g("span",{key:1,onClick:X=>ue(i)},"\u64A4\u9500\u5BA1\u6838",8,xt))]),_:2},1024)])):m("",!0)]),_:1},8,["dataSource","columns","pagination"])]),_:1},8,["spinning"])]),n(H,{visible:B.value,"onUpdate:visible":e[10]||(e[10]=a=>B.value=a),title:"\u5BA1\u6279",width:"480px",onOk:pe,onCancel:K},{default:t(()=>[n(J,{class:"set-form",ref_key:"verifyFormRef",ref:G,model:p,name:"basic",autocomplete:"off",colon:!1,rules:ce},{default:t(()=>[n(S,{label:" ",name:"verifyStatus"},{default:t(()=>[n(be,{value:p.verifyStatus,"onUpdate:value":e[4]||(e[4]=a=>p.verifyStatus=a)},{default:t(()=>[n(W,{value:"3"},{default:t(()=>[o("\u5BA1\u6838\u901A\u8FC7")]),_:1}),n(W,{value:"2"},{default:t(()=>[o("\u5BA1\u6838\u4E0D\u901A\u8FC7")]),_:1})]),_:1},8,["value"])]),_:1}),p.verifyStatus==="2"?(s(),v(S,{key:0,label:""},{default:t(()=>[n(Ce,{value:p.failureReson,"onUpdate:value":e[5]||(e[5]=a=>p.failureReson=a),"show-count":"",rows:4,maxlength:200,placeholder:"\u8F93\u5165\u4E0D\u901A\u8FC7\u7684\u539F\u56E0"},null,8,["value"])]),_:1})):m("",!0),n(S,{name:"fileInfo"},{default:t(()=>[n(F,{onClick:e[6]||(e[6]=a=>y.open=!0)},{default:t(()=>[n(Se),o(" \u4E0A\u4F20\u4ED8\u6B3E\u51ED\u8BC1 ")]),_:1}),(s(!0),g(M,null,Q(I.value,(a,i)=>(s(),g("div",wt,[_("div",null,[_("span",null,c(a),1)]),_("div",{style:{"margin-left":"10px"},onClick:X=>re(i)},[$e(n(x(Be),null,null,512),[[De,a]])],8,It)]))),256))]),_:1}),n(H,{title:"\u4E0A\u4F20\u4ED8\u6B3E\u51ED\u8BC1",visible:y.open,"onUpdate:visible":e[9]||(e[9]=a=>y.open=a),width:"400px","append-to-body":""},{footer:t(()=>[_("div",St,[n(F,{type:"primary",onClick:de},{default:t(()=>[o("\u786E \u5B9A")]),_:1}),n(F,{onClick:e[8]||(e[8]=a=>y.open=!1)},{default:t(()=>[o("\u53D6 \u6D88")]),_:1})])]),default:t(()=>[n(ke,{fileList:h.value,"onUpdate:fileList":e[7]||(e[7]=a=>h.value=a),type:"file",accept:"image/png,image/jpeg,image/*",name:"file",maxCount:1,disabled:y.isUploading,beforeUpload:"false",drag:""},{default:t(()=>[_("p",bt,[n(x(Le))]),Ct]),_:1},8,["fileList","disabled"])]),_:1},8,["visible"])]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},Rt=Ue(kt,[["__scopeId","data-v-25fb5478"]]);export{Rt as default};
