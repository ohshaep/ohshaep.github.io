import{aI as A,z as Ce,A as U,r as p,V as Se,C as ke,o as r,c,d as l,w as s,e as v,t as f,F as V,W as E,i as O,f as $,g as h,R as W,E as Te,Q as I,bO as qe,G as Ue,M as G,m as B,_ as Ve,a$ as Oe,b0 as $e,y as Ne,b3 as De,n as ze,a8 as Be,a9 as Fe,a6 as Le,a3 as Pe,q as Qe,B as Me,s as Ye,L as je,x as Ee,S as We,aa as Ge,ab as Ke,ac as Ae,N as Je,O as He}from"./index.192c8708.js";function Xe(_){return A({url:"/qualityReport/list",method:"post",params:_})}function K(_){return A({url:"/qualityReport/approve",method:"post",data:_})}const J=_=>(Je("data-v-89492599"),_=_(),He(),_),Ze=J(()=>$("span",{class:"separate"},"/",-1)),et=J(()=>$("span",null,"\u6266\u6837\u5BA1\u6279",-1)),tt={class:"app-container"},at={class:"container-wrapper"},nt={key:0},lt={key:2},st={key:4},it=["onClick"],ot=["onClick"],ut={__name:"index",setup(_){const{proxy:H}=Ue(),{sys_point_type:X}=H.useDict("sys_point_type"),Z=U([{label:"\u5F85\u5BA1\u6279",value:"1"},{label:"\u5BA1\u6279\u901A\u8FC7",value:"3"},{label:"\u5BA1\u6279\u4E0D\u901A\u8FC7",value:"2"}]);function ee(t,e,a,m){if(m!==0&&t===e[m-1][a])return 0;let q=1;for(let x=m+1;x<e.length&&(console.log(t,e[x][a],"texttexttexttext"),t===e[x][a]);x++)q++;return q}const i=(t,e,a)=>{const m={children:t!==null?t:"",props:{}};return m.props.rowSpan=ee(e.id,D.value,"id",a),m},te=[{title:"\u8D28\u68C0\u5355\u53F7",dataIndex:"inspectCode",ellipsis:!0,width:180,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u6266\u6837\u5355\u7F16\u53F7",dataIndex:"sampleCode",ellipsis:!0,width:180,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u6837\u54C1\u540D\u79F0",dataIndex:"productName",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u68C0\u9A8C\u65E5\u671F",dataIndex:"inspectDate",ellipsis:!0,width:160,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u68C0\u9A8C\u7C7B\u578B",dataIndex:"sampleType",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u68C0\u9A8C\u4EBA",dataIndex:"inspectUser",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u4EE3\u8868\u6570\u91CF(\u5428)",dataIndex:"quality",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u6837\u54C1\u91CD\u91CF(\u5343\u514B)",dataIndex:"sampleWeight",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u8D28\u68C0\u6307\u6807\u540D\u79F0",dataIndex:"targetContent",ellipsis:!0,width:150},{title:"\u68C0\u9A8C\u4F9D\u636E",dataIndex:"accordance",ellipsis:!0,width:150},{title:"\u6807\u51C6",dataIndex:"standard",ellipsis:!0,width:150},{title:"\u5355\u4F4D",dataIndex:"unit",ellipsis:!0,width:150},{title:"\u8D28\u68C0\u6307\u6807\u503C",dataIndex:"targetValue",ellipsis:!0,width:150},{title:"\u8D28\u68C0\u7ED3\u679C",dataIndex:"checkResult",ellipsis:!0,width:150},{title:"\u589E\u6263\u91CF(\u5343\u514B)",dataIndex:"changeQuality",ellipsis:!0,width:150},{title:"\u589E\u6263\u4EF7(\u5143)",dataIndex:"changePrice",ellipsis:!0,width:150},{title:"\u68C0\u6D4B\u8BF4\u660E",dataIndex:"checkDeclare",ellipsis:!0,width:150},{title:"\u68C0\u9A8C\u5458\u610F\u89C1",dataIndex:"checkerOpinion",ellipsis:!0,width:150},{title:"\u5907\u6CE8",dataIndex:"remark",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u64CD\u4F5C",dataIndex:"edit",fixed:"right",align:"center",width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)}],ae=[{title:"\u8D28\u68C0\u5355\u53F7",dataIndex:"inspectCode",ellipsis:!0,width:180,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u6266\u6837\u5355\u7F16\u53F7",dataIndex:"sampleCode",ellipsis:!0,width:180,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u6837\u54C1\u540D\u79F0",dataIndex:"productName",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u68C0\u9A8C\u65E5\u671F",dataIndex:"inspectDate",ellipsis:!0,width:160,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u68C0\u9A8C\u7C7B\u578B",dataIndex:"sampleType",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u68C0\u9A8C\u4EBA",dataIndex:"inspectUser",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u4EE3\u8868\u6570\u91CF(\u5428)",dataIndex:"quality",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u6837\u54C1\u91CD\u91CF(\u5343\u514B)",dataIndex:"sampleWeight",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u8D28\u68C0\u6307\u6807\u540D\u79F0",dataIndex:"targetContent",ellipsis:!0,width:150},{title:"\u68C0\u9A8C\u4F9D\u636E",dataIndex:"accordance",ellipsis:!0,width:150},{title:"\u6807\u51C6",dataIndex:"standard",ellipsis:!0,width:150},{title:"\u5355\u4F4D",dataIndex:"unit",ellipsis:!0,width:150},{title:"\u8D28\u68C0\u6307\u6807\u503C",dataIndex:"targetValue",ellipsis:!0,width:150},{title:"\u8D28\u68C0\u7ED3\u679C",dataIndex:"checkResult",ellipsis:!0,width:150},{title:"\u589E\u6263\u91CF(\u5343\u514B)",dataIndex:"changeQuality",ellipsis:!0,width:150},{title:"\u589E\u6263\u4EF7(\u5143)",dataIndex:"changePrice",ellipsis:!0,width:150},{title:"\u68C0\u6D4B\u8BF4\u660E",dataIndex:"checkDeclare",ellipsis:!0,width:150},{title:"\u68C0\u9A8C\u5458\u610F\u89C1",dataIndex:"checkerOpinion",ellipsis:!0,width:150},{title:"\u5907\u6CE8",dataIndex:"remark",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u4E0D\u901A\u8FC7\u539F\u56E0",dataIndex:"approveReason",ellipsis:!0,width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)},{title:"\u64CD\u4F5C",dataIndex:"edit",fixed:"right",align:"center",width:150,customRender:({text:t,record:e,index:a})=>i(t,e,a)}],ne=p([{value:"1",label:"\u5165\u5E93"},{value:"2",label:"\u5728\u5E93"},{value:"3",label:"\u51FA\u5E93"}]),le=p([{value:"inspectCode",label:"\u8D28\u68C0\u5355\u53F7"},{value:"productName",label:"\u7269\u6599\u540D\u79F0"},{value:"sampleCode",label:"\u6266\u6837\u5355\u7F16\u53F7"}]),N=p(!0),g=p([]),D=p([]),se=p(""),z=p("");p(null);const ie=async()=>{g.value=[],o.value={offset:0,limit:10,orderStatus:"",beginTime:"",endTime:""},o.value.type="",b.value="inspectCode",C.value="",o.value.verifyStatus="",R()},R=()=>{y.current=1,o.value.offset=0,S()},F=(t,e,a)=>{y.current=t,a&&(y.pageSize=e,o.value.limit=e),o.value.offset=(t-1)*e,S()},y=U({current:1,pageSize:10,total:0,showTotal:t=>`\u5171 ${t} \u6761`,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["2","20","50","100"],onChange:(t,e)=>F(t,e),onShowSizeChange:(t,e)=>F(t,e,"sizeChange")}),k=p("1"),oe=U({queryParams:{offset:0,limit:10,beginTime:"",endTime:""},searchType:"inspectCode",searchValue:""}),{queryParams:o,searchType:b,searchValue:C}=Se(oe);function S(){N.value=!0,g.value.length>0?(o.value.beginTime=g.value[0],o.value.endTime=g.value[1]):(o.value.beginTime="",o.value.endTime=""),o.value[b.value]=C.value,Xe({...o.value,approveStatus:k.value}).then(t=>{const e=t==null?void 0:t.data;D.value=e.data,y.total=(e==null?void 0:e.row)||0,y.pageSize=e==null?void 0:e.trueNum,N.value=!1})}const ue=t=>{z.value=t.id,d.verifyStatus="3",se.value="\u5BA1\u6838",T.value=!0};function re(t){const e=t.id;G.confirm({title:"\u64CD\u4F5C\u786E\u8BA4",content:"\u662F\u5426\u786E\u5B9A\u64A4\u9500\uFF1F",onOk(){K({id:e,approveStatus:4}).then(()=>{S(),B.success("\u64A4\u9500\u6210\u529F")}).catch(()=>{})}})}const T=p(!1),d=U({verifyStatus:null,failureReson:""}),L=p();function P(){Object.assign(d,{verifyStatus:null,failureReson:""})}const de=async()=>{try{if(await L.value.validateFields(),d.verifyStatus=="2"&&d.failureReson==""){B.error("\u8BF7\u586B\u5199\u4E0D\u901A\u8FC7\u539F\u56E0");return}z.value&&K({approveReason:d.failureReson,approveStatus:d.verifyStatus,id:z.value}).then(t=>{console.log(t),(t==null?void 0:t.code)===200&&(B.success("\u64CD\u4F5C\u6210\u529F"),P(),S())}),T.value=!1}catch(t){console.log(t)}},pe={verifyStatus:[{required:!0,message:"\u5FC5\u9009",trigger:["change"]}]};return S(),(t,e)=>{const a=Ve,m=Oe,q=$e,x=Ne,ce=De,w=ze,_e=Be,me=Fe,ve=Le,fe=Pe,Q=Qe,M=Me,Y=Ye,he=ke("dict-tag"),ge=je,ye=Ee,xe=We,j=Ge,we=Ke,Ie=Ae,Re=G;return r(),c(V,null,[l(a,{title:"\u5BA1\u6279\u8D28\u68C0\u62A5\u544A",icon:"icon-rongqi"},{nav:s(()=>[v(f("\u6266\u6837\u5BA1\u6279")+" "),Ze,et]),_:1}),l(x,null,{default:s(()=>[l(q,{defaultValue:"",value:k.value,"onUpdate:value":e[0]||(e[0]=n=>k.value=n),onChange:R},{default:s(()=>[(r(!0),c(V,null,E(Z,(n,u)=>(r(),O(m,{key:u,value:n.value},{default:s(()=>[v(f(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),$("div",tt,[l(Q,{justify:"space-between",style:{flex:"1"}},{default:s(()=>[$("div",at,[l(Y,{layout:"inline",ref:"queryRef",model:h(o)},{default:s(()=>[l(w,{style:{width:"308px"},name:"dateRange"},{default:s(()=>[l(ce,{label:"\u68C0\u9A8C\u65E5\u671F",value:g.value,"onUpdate:value":e[1]||(e[1]=n=>g.value=n),"value-format":"YYYY-MM-DD",onChange:R},null,8,["value"])]),_:1}),l(w,{label:""},{default:s(()=>[l(ve,{placeholder:"\u8BF7\u8F93\u5165",value:h(C),"onUpdate:value":e[3]||(e[3]=n=>W(C)?C.value=n:null),onKeyup:Te(R,["enter"])},{addonBefore:s(()=>[l(me,{style:{width:"120px"},value:h(b),"onUpdate:value":e[2]||(e[2]=n=>W(b)?b.value=n:null)},{default:s(()=>[(r(!0),c(V,null,E(le.value,(n,u)=>(r(),O(_e,{key:u,value:n.value},{default:s(()=>[v(f(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["value"])]),_:1}),l(Q,null,{default:s(()=>[l(w,{name:"sampleType"},{default:s(()=>[l(fe,{label:"\u68C0\u9A8C\u7C7B\u522B",value:h(o).sampleType,"onUpdate:value":e[4]||(e[4]=n=>h(o).sampleType=n),placeholder:"\u8BF7\u9009\u62E9",clearable:"",style:{width:"240px"},options:ne.value},null,8,["value","options"])]),_:1})]),_:1}),l(w,null,{default:s(()=>[l(M,{type:"primary",onClick:R},{default:s(()=>[v("\u67E5\u8BE2")]),_:1}),l(M,{type:"primary",ghost:"",onClick:ie,style:{"margin-left":"15px"}},{default:s(()=>[v("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),l(xe,{spinning:N.value},{default:s(()=>[l(ye,{dataSource:D.value,columns:k.value=="2"?ae:te,pagination:y,scroll:{x:0,y:240}},{bodyCell:s(({column:n,record:u})=>[n.dataIndex==="name"?(r(),c("span",nt,f(u.name)+" / "+f(u.id),1)):I("",!0),n.dataIndex==="type"?(r(),O(he,{key:1,options:h(X),value:u.type},null,8,["options","value"])):I("",!0),n.dataIndex==="sampleType"?(r(),c("span",lt,f(u.sampleType=="1"?"\u5165\u5E93":u.sampleType=="2"?"\u5728\u5E93":"\u51FA\u5E93"),1)):I("",!0),n.dataIndex==="verifyTime"?(r(),c(V,{key:3},[v(f(h(qe)(u.verifyTime)),1)],64)):I("",!0),n.dataIndex==="edit"?(r(),c("span",st,[l(ge,{size:"middle",style:{color:"#05C059",cursor:"pointer"}},{default:s(()=>[u.approveStatus=="1"?(r(),c("span",{key:0,onClick:be=>ue(u)},"\u5BA1\u6838",8,it)):(r(),c("span",{key:1,onClick:be=>re(u)},"\u64A4\u9500\u5BA1\u6838",8,ot))]),_:2},1024)])):I("",!0)]),_:1},8,["dataSource","columns","pagination"])]),_:1},8,["spinning"])]),l(Re,{visible:T.value,"onUpdate:visible":e[7]||(e[7]=n=>T.value=n),title:"\u5BA1\u6279\u72B6\u6001",width:"480px",onOk:de,onCancel:P},{default:s(()=>[l(Y,{class:"set-form",ref_key:"verifyFormRef",ref:L,model:d,name:"basic",autocomplete:"off",colon:!1,rules:pe},{default:s(()=>[l(w,{label:" ",name:"verifyStatus"},{default:s(()=>[l(we,{value:d.verifyStatus,"onUpdate:value":e[5]||(e[5]=n=>d.verifyStatus=n)},{default:s(()=>[l(j,{value:"3"},{default:s(()=>[v("\u5BA1\u6838\u901A\u8FC7")]),_:1}),l(j,{value:"2"},{default:s(()=>[v("\u5BA1\u6838\u4E0D\u901A\u8FC7")]),_:1})]),_:1},8,["value"])]),_:1}),d.verifyStatus==="2"?(r(),O(w,{key:0,label:""},{default:s(()=>[l(Ie,{value:d.failureReson,"onUpdate:value":e[6]||(e[6]=n=>d.failureReson=n),"show-count":"",rows:4,maxlength:200,placeholder:"\u8F93\u5165\u4E0D\u901A\u8FC7\u7684\u539F\u56E0"},null,8,["value"])]),_:1})):I("",!0)]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},dt=Ce(ut,[["__scopeId","data-v-89492599"]]);export{dt as default};
