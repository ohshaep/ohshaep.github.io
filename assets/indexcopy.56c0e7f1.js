import{z as xe,a as Re,r as s,A as O,V as Fe,o as u,c as b,d as t,w as a,e as i,t as m,F as N,W as Q,i as g,f as w,g as $,R as G,E as Ie,Q as _,G as Te,m as p,M as J,_ as De,a$ as Oe,b0 as $e,y as ze,b3 as Le,n as Ue,a8 as qe,a9 as Be,a6 as Ne,B as Ve,L as Ye,s as Me,q as je,x as Ee,S as Pe,aa as Ae,ab as Qe,ac as Ge,aJ as Je,N as Ke,O as We}from"./index.192c8708.js";import{a as He}from"./store.cbb90ece.js";import{o as Xe}from"./approveSaleOut.1dd4a8dc.js";import{u as Ze}from"./qualityReport.6dc17b5d.js";import{i as K}from"./storageMg.e8e488da.js";const W=I=>(Ke("data-v-9c560bcf"),I=I(),We(),I),ea=W(()=>w("span",{class:"separate"},"/",-1)),aa=W(()=>w("span",null,"\u8F6C\u6362\u8BB0\u5F55",-1)),ta={class:"app-container"},na={class:"container-wrapper"},la={key:4},oa=["onClick"],sa=["onClick"],ua=["onClick"],ia=["onClick"],ra={__name:"indexcopy",setup(I){const V=Re(),T=s(!1),{proxy:Y}=Te();Y.useDict("sys_point_type");const H=O([{label:"\u5168\u90E8",value:""},{label:"\u5F85\u5BA1\u6279",value:"1"},{label:"\u5BA1\u6279\u901A\u8FC7",value:"3"},{label:"\u5BA1\u6279\u4E0D\u901A\u8FC7",value:"2"}]),M=s([{value:"deliveryOrderCode",label:"\u51FA\u5E93\u8BB8\u53EF\u5355\u53F7"},{value:"deliveryMode",label:"\u51FA\u5E93\u65B9\u5F0F"},{value:"licenseRegister",label:"\u724C\u7167\u767B\u8BB0"},{value:"approveUser",label:"\u5BA1\u6838\u4EBA"},{value:"createBy",label:"\u9500\u521B\u5EFA\u4EBA"},{value:"createBy",label:"\u521B\u5EFA\u4EBA"}]),z=s(!0),v=s([]),L=s([]);s(""),s(""),s(null);const X=async()=>{v.value=[],r.value={offset:0,limit:10,orderStatus:"",beginTime:"",endTime:"",timeType:1},x.value="deliveryOrderCode",R.value="",S()},C=s([]),Z=s({onChange:(l,e)=>{C.value=l}}),S=l=>{k.offset=1,r.value.offset=0,F()},ee=()=>{if(C.value.length==0){p.warning("\u8BF7\u9009\u62E9\u8981\u6253\u5370\u7684\u6570\u636E");return}if(C.value.length>5){p.warning("\u6700\u591A\u652F\u63015\u6761\u6570\u636E");return}C.value.length<6&&Y.download("/deliveryRecord/printData",{ids:C.value.toString()},`\u51FA\u5E93\u7BA1\u7406_${new Date().getTime()}.docx`)};function ae(l){M.value.forEach((e,f)=>{e.value!=l&&(r.value[e.value]="")})}const j=(l,e,f)=>{k.offset=l,f&&(k.limit=e,r.value.limit=e),r.value.offset=l,F()},k=O({offset:1,limit:10,total:0,showTotal:l=>`\u5171 ${l} \u6761`,showQuickJumper:!0,showSizeChanger:!0,Options:["2","20","50","100"],pageSizeonChange:(l,e)=>j(l,e),onShowSizeChange:(l,e)=>j(l,e,"sizeChange")}),U=s("1"),te=O({queryParams:{offset:0,limit:10,orderStatus:"",beginTime:"",endTime:"",timeType:1},searchType:"deliveryOrderCode",searchValue:""}),{queryParams:r,searchType:x,searchValue:R}=Fe(te),F=async()=>{z.value=!0,v.value&&v.value.length>0?(r.value.beginTime=v.value[0],r.value.endTime=v.value[1]):(r.value.beginTime="",r.value.endTime=""),r.value[x.value]=R.value,Xe({...r.value,orderStatus:U.value}).then(l=>{const e=l;L.value=e.records,console.log(L.value,"verifyList"),k.total=(e==null?void 0:e.total)||0,z.value=!1})},ne=l=>{T.value=!0,d.value.id=l.id},le=l=>{V.push({path:"/store/verify",query:{id:l.id}})},oe=l=>{V.push({path:"/store/detial",query:{id:l.id}})};function se(l){const e=l.id;J.confirm({title:"\u64CD\u4F5C\u786E\u8BA4",content:"\u662F\u5426\u786E\u5B9A\u64A4\u9500\uFF1F",onOk(){K({id:e,orderStatus:4}).then(()=>{F(),p.success("\u64A4\u9500\u6210\u529F")}).catch(()=>{})}})}s(!1),O({verifyStatus:null,failureReson:""});const ue={orderStatus:[{required:!0,message:"\u5FC5\u9009",trigger:["change"]}]},d=s({id:"",orderStatus:3,approveReason:"",fileNames:"",fileInfo:""}),c=s([]),ie=s(!1),re=async()=>{if(c.value[0].originFileObj.size/1024/1024>=10){p.error("\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC710M"),c.value=[];return}let e=new FormData;e.append("file",c.value[0].originFileObj);const f=await Ze(e,ie.value);if(!f.success){p.error("\u4E0A\u4F20\u5931\u8D25"),c.value=[];return}p.success("\u4E0A\u4F20\u6210\u529F"),c.value[0].status="done",d.value.fileInfo=f.data,d.value.fileNames=c.value[0].originFileObj.name},q=s(null),de=()=>{q.value.validateFields().then(async l=>{const e=await K(d.value);console.log(e,"deliveryRecordApprove"),e.code==200?(p.success("\u63D0\u4EA4\u6210\u529F"),E(),F()):p.error("\u63D0\u4EA4\u5931\u8D25")})},E=()=>{T.value=!1,q.value.resetFields(),d.value.fileNames="",c.value=[]};return F(),(l,e)=>{const f=De,ce=Oe,_e=$e,pe=ze,ve=Le,y=Ue,fe=qe,me=Be,ge=Ne,D=Ve,h=Ye,P=Me,ye=je,he=Ee,be=Pe,A=Ae,we=Qe,Ce=Ge,Se=Je,ke=J;return u(),b(N,null,[t(f,{title:"\u8F6C\u6362\u8BB0\u5F55",icon:"icon-rongqi"},{nav:a(()=>[i(m("\u8F6C\u6362\u8BB0\u5F55")+" "),ea,aa]),_:1}),t(pe,null,{default:a(()=>[t(_e,{defaultValue:"",value:U.value,"onUpdate:value":e[0]||(e[0]=n=>U.value=n),onChange:S},{default:a(()=>[(u(!0),b(N,null,Q(H,(n,o)=>(u(),g(ce,{key:o,value:n.value},{default:a(()=>[i(m(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),w("div",ta,[t(ye,{justify:"space-between",style:{flex:"1"}},{default:a(()=>[w("div",na,[t(P,{layout:"inline",ref:"queryRef",model:$(r)},{default:a(()=>[t(y,{style:{width:"308px"},name:"dateRange",label:"\u521B\u5EFA\u65F6\u95F4"},{default:a(()=>[t(ve,{value:v.value,"onUpdate:value":e[1]||(e[1]=n=>v.value=n),"value-format":"YYYY-MM-DD",onChange:S},null,8,["value"])]),_:1}),t(y,{label:""},{default:a(()=>[t(ge,{placeholder:"\u8BF7\u8F93\u5165",value:$(R),"onUpdate:value":e[3]||(e[3]=n=>G(R)?R.value=n:null),onKeyup:Ie(S,["enter"])},{addonBefore:a(()=>[t(me,{style:{width:"120px"},value:$(x),"onUpdate:value":e[2]||(e[2]=n=>G(x)?x.value=n:null),onChange:ae},{default:a(()=>[(u(!0),b(N,null,Q(M.value,(n,o)=>(u(),g(fe,{key:o,value:n.value},{default:a(()=>[i(m(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["value"])]),_:1}),t(y,{style:{"margin-left":"auto"}},{default:a(()=>[t(h,null,{default:a(()=>[t(D,{type:"primary",onClick:S},{default:a(()=>[i("\u67E5\u8BE2")]),_:1}),t(D,{type:"primary",ghost:"",onClick:X},{default:a(()=>[i("\u91CD\u7F6E")]),_:1}),t(D,{type:"primary",onClick:ee},{default:a(()=>[i("\u6253\u5370")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),t(be,{spinning:z.value},{default:a(()=>[t(he,{dataSource:L.value,columns:$(He),"row-selection":Z.value,pagination:k,scroll:{x:0,y:500}},{bodyCell:a(({column:n,record:o})=>[n.dataIndex==="qualityLevel"?(u(),g(h,{key:0},{default:a(()=>[i(m((o==null?void 0:o.orderStatus)||"0\u7EA7"),1)]),_:2},1024)):_("",!0),n.dataIndex==="productYear"?(u(),g(h,{key:1},{default:a(()=>[i(m(new Date(o.productYear).getFullYear()),1)]),_:2},1024)):_("",!0),n.dataIndex==="productDate"?(u(),g(h,{key:2},{default:a(()=>[i(m(new Date(o.productDate).toLocaleDateString()),1)]),_:2},1024)):_("",!0),n.dataIndex==="orderStatus"?(u(),g(h,{key:3},{default:a(()=>[i(m(["\u5F02\u5E38\u6570\u636E","\u5F85\u5BA1\u6838","\u5BA1\u6279\u4E0D\u901A\u8FC7","\u5BA1\u6279\u901A\u8FC7"][o.orderStatus]),1)]),_:2},1024)):_("",!0),n.dataIndex==="operation"?(u(),b("span",la,[t(h,{size:"middle",style:{color:"#05C059",cursor:"pointer"}},{default:a(()=>[o.orderStatus==1?(u(),b("span",{key:0,onClick:B=>ne(o)},"\u5BA1\u6838",8,oa)):_("",!0),o.orderStatus==2?(u(),b("span",{key:1,onClick:B=>le(o)},"\u7F16\u8F91",8,sa)):_("",!0),w("span",{onClick:B=>oe(o)},"\u8BE6\u60C5",8,ua),w("span",{onClick:B=>se(o)},"\u53D6\u6D88",8,ia)]),_:2},1024)])):_("",!0)]),_:1},8,["dataSource","columns","row-selection","pagination"])]),_:1},8,["spinning"])]),t(ke,{visible:T.value,"onUpdate:visible":e[7]||(e[7]=n=>T.value=n),title:"\u64CD\u4F5C\u786E\u8BA4",onOk:de,onCancel:E,"append-to-body":"",destroyOnClose:""},{default:a(()=>[t(P,{layout:"inline",ref_key:"reviewFormComp",ref:q,model:d.value,rules:ue},{default:a(()=>[t(y,{style:{width:"308px"},name:"orderStatus",label:"\u5BA1\u6838\u72B6\u6001"},{default:a(()=>[t(we,{value:d.value.orderStatus,"onUpdate:value":e[4]||(e[4]=n=>d.value.orderStatus=n),style:{"margin-right":"8px"}},{default:a(()=>[t(A,{value:3},{default:a(()=>[i("\u5BA1\u6838\u901A\u8FC7")]),_:1}),t(A,{value:2},{default:a(()=>[i("\u5BA1\u6838\u4E0D\u901A\u8FC7")]),_:1})]),_:1},8,["value"])]),_:1}),d.value.orderStatus==2?(u(),g(y,{key:0,style:{width:"308px"},name:"approveReason",label:"\u539F\u56E0"},{default:a(()=>[t(Ce,{value:d.value.approveReason,"onUpdate:value":e[5]||(e[5]=n=>d.value.approveReason=n),placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6838\u4E0D\u901A\u8FC7\u539F\u56E0","auto-size":{minRows:5,maxRows:10}},null,8,["value"])]),_:1})):_("",!0),t(y,{style:{width:"308px"},name:"fileInfo",label:"\u4E0A\u4F20\u9644\u4EF6\uFF1A"},{default:a(()=>[t(Se,{"file-list":c.value,"onUpdate:fileList":e[6]||(e[6]=n=>c.value=n),name:"file",accept:".pdf,.jpg,.txt",customRequest:re,maxCount:1,showUploadList:!0},{default:a(()=>[t(D,{type:"link",size:"large"},{default:a(()=>[i(" +\u4E0A\u4F20")]),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},fa=xe(ra,[["__scopeId","data-v-9c560bcf"]]);export{fa as default};
