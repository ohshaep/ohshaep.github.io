import{z as Ve,a as je,A,r as f,V as de,o as n,c as d,d as s,w as a,e as p,t as u,F as B,W as pe,i as v,f as T,g as x,R as ce,E as Le,Q as r,bU as Ye,G as Ee,M as _e,m as I,_ as Ge,a$ as He,b0 as Je,y as Ke,b3 as We,n as Xe,a8 as Ze,a9 as et,a6 as tt,B as at,s as lt,q as st,a4 as nt,aB as it,L as ot,x as ut,S as rt,bW as dt,aJ as pt,aa as ct,ab as _t,ac as vt,N as ft,O as mt}from"./index.192c8708.js";import{k as yt,l as ve,u as ht}from"./approveSaleOut.1dd4a8dc.js";const gt=[{title:"\u9500\u552E\u51FA\u5E93\u8BA2\u5355\u7F16\u53F7",dataIndex:"deliveryOrderCode",ellipsis:!0,width:180},{title:"\u9500\u552E\u8BA2\u5355\u7F16\u53F7",dataIndex:"saleOrderCode",ellipsis:!0,width:180},{title:"\u5408\u4F5C\u5BA2\u6237",dataIndex:"cooperatorName",ellipsis:!0,width:150},{title:"\u9500\u552E\u5408\u540C\u53F7",dataIndex:"contractNo",ellipsis:!0,width:150},{title:"\u5546\u54C1\u7F16\u7801",dataIndex:"productCode",ellipsis:!0,width:150},{title:"\u5546\u54C1\u540D\u79F0",dataIndex:"productName",ellipsis:!0,width:180},{title:"\u89C4\u683C\u578B\u53F7",dataIndex:"productSpec",ellipsis:!0,width:150},{title:"\u51FA\u5E93\u6570\u91CF",dataIndex:"deliveryQuality",ellipsis:!0,width:150},{title:"\u8BA1\u91CF\u5355\u4F4D",dataIndex:"measureUnit",ellipsis:!0,width:150},{title:"\u57FA\u672C\u6570\u91CF",dataIndex:"deliveryBaseQuality",ellipsis:!0,width:150},{title:"\u57FA\u672C\u8BA1\u91CF\u5355\u4F4D",dataIndex:"baseMeasureUnit",ellipsis:!0,width:150},{title:"\u53D1\u8D27\u4ED3\u5E93",dataIndex:"storehouseName",ellipsis:!0,width:150},{title:"\u542B\u7A0E\u5355\u4EF7(\u5143)",dataIndex:"unitPrice",ellipsis:!0,width:150},{title:"\u4EF7\u7A0E\u5408\u8BA1(\u5143)",dataIndex:"totalPrice",ellipsis:!0,width:150},{title:"\u51FA\u5E93\u65E5\u671F",dataIndex:"sendDate",ellipsis:!0,width:150},{title:"\u4FDD\u8D28\u671F",dataIndex:"expireTime",width:150},{title:"\u5236\u5355\u65F6\u95F4",dataIndex:"orderTime",ellipsis:!0,width:160},{title:"\u5236\u5355\u4EBA",dataIndex:"orderUser",ellipsis:!0,width:150},{title:"\u64CD\u4F5C",dataIndex:"edit",fixed:"right",align:"center",width:150}],bt=[{title:"\u9500\u552E\u51FA\u5E93\u8BA2\u5355\u7F16\u53F7",dataIndex:"deliveryOrderCode",ellipsis:!0,width:180},{title:"\u9500\u552E\u8BA2\u5355\u7F16\u53F7",dataIndex:"saleOrderCode",ellipsis:!0,width:180},{title:"\u5408\u4F5C\u5BA2\u6237",dataIndex:"cooperatorName",ellipsis:!0,width:150},{title:"\u9500\u552E\u5408\u540C\u53F7",dataIndex:"contractNo",ellipsis:!0,width:120},{title:"\u5546\u54C1\u7F16\u7801",dataIndex:"productCode",ellipsis:!0,width:150},{title:"\u5546\u54C1\u540D\u79F0",dataIndex:"productName",ellipsis:!0,width:180},{title:"\u89C4\u683C\u578B\u53F7",dataIndex:"productSpec",ellipsis:!0,width:150},{title:"\u51FA\u5E93\u6570\u91CF",dataIndex:"deliveryQuality",ellipsis:!0,width:150},{title:"\u8BA1\u91CF\u5355\u4F4D",dataIndex:"measureUnit",ellipsis:!0,width:150},{title:"\u57FA\u672C\u6570\u91CF",dataIndex:"baseQuality",ellipsis:!0,width:150},{title:"\u57FA\u672C\u8BA1\u91CF\u5355\u4F4D",dataIndex:"baseMeasureUnit",ellipsis:!0,width:150},{title:"\u53D1\u8D27\u4ED3\u5E93",dataIndex:"storehouseName",ellipsis:!0,width:150},{title:"\u542B\u7A0E\u5355\u4EF7(\u5143)",dataIndex:"unitPrice",ellipsis:!0,width:150},{title:"\u4EF7\u7A0E\u5408\u8BA1(\u5143)",dataIndex:"totalPrice",ellipsis:!0,width:150},{title:"\u51FA\u5E93\u65E5\u671F",dataIndex:"sendDate",ellipsis:!0,width:150},{title:"\u5236\u5355\u65F6\u95F4",dataIndex:"orderTime",ellipsis:!0,width:160},{title:"\u5236\u5355\u4EBA",dataIndex:"orderUser",ellipsis:!0,width:150},{title:"\u4E0D\u901A\u8FC7\u539F\u56E0",dataIndex:"approveReason",ellipsis:!0,width:150},{title:"\u64CD\u4F5C",dataIndex:"edit",fixed:"right",align:"center",width:150}];const fe=N=>(ft("data-v-1868ad26"),N=N(),mt(),N),xt=fe(()=>T("span",{class:"separate"},"/",-1)),It=fe(()=>T("span",null,"\u5BA1\u6279\u5217\u8868",-1)),kt={class:"app-container"},wt={class:"container-wrapper"},St={key:1},Ct={key:2},Ot={key:3},Ut={key:4},Tt={key:5},Nt={key:6},Rt={key:7},Ft={key:8},At={key:9},Bt={key:10},Dt={key:11},Pt={key:12},qt={key:20},Mt=["onClick"],Qt=["onClick"],$t=["onClick"],zt={__name:"index",setup(N){je();const{proxy:me}=Ee();me.useDict("sys_point_type");const ye=A([{label:"\u5F85\u5BA1\u6279",value:"1"},{label:"\u5BA1\u6279\u901A\u8FC7",value:"3"},{label:"\u5BA1\u6279\u4E0D\u901A\u8FC7",value:"2"}]),V=f([{value:"deliveryOrderCode",label:"\u9500\u552E\u51FA\u5E93\u5355\u7F16\u53F7"},{value:"saleOrderCode",label:"\u9500\u552E\u8BA2\u5355\u7F16\u53F7"},{value:"cooperatorName",label:"\u5BA2\u6237\u540D\u79F0"},{value:"productCode",label:"\u5546\u54C1\u7F16\u7801"},{value:"productName",label:"\u5546\u54C1\u540D\u79F0"},{value:"contractNo",label:"\u9500\u552E\u5408\u540C\u53F7"},{value:"orderUser",label:"\u5236\u5355\u4EBA"}]),D=f(!0),b=f([]),j=f([]),he=f(""),P=f("");let q="",M="";f(null);const ge=async()=>{b.value=[],_.value={offset:0,limit:10,orderStatus:"",beginTime:"",endTime:""},S.value="deliveryOrderCode",C.value="",k()},k=()=>{w.current=1,_.value.offset=0,_.value.timeType=1,O()};function be(i){V.value.forEach((t,c)=>{t.value!=i&&(_.value[t.value]="")})}const L=(i,t,c)=>{w.current=i,c&&(w.pageSize=t,_.value.limit=t),_.value.offset=(i-1)*t,O()},w=A({current:1,pageSize:10,total:0,showTotal:i=>`\u5171 ${i} \u6761`,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["2","20","50","100"],onChange:(i,t)=>L(i,t),onShowSizeChange:(i,t)=>L(i,t,"sizeChange")}),R=f("1"),xe=A({queryParams:{offset:0,limit:10,orderStatus:"",beginTime:"",endTime:""},searchType:"deliveryOrderCode",searchValue:""}),{queryParams:_,searchType:S,searchValue:C}=de(xe),O=async()=>{D.value=!0,b.value&&b.value.length>0?(_.value.beginTime=b.value[0],_.value.endTime=b.value[1]):(_.value.beginTime="",_.value.endTime=""),_.value[S.value]=C.value,yt({..._.value,orderStatus:R.value}).then(i=>{const t=(i==null?void 0:i.data.data)||[];j.value=t,w.total=(i==null?void 0:i.data.row)||0,D.value=!1})},o=A({verifyStatus:null,failureReson:"",cashierApprovalStatus:"0",receivablesTime:"",receivablesAmount:"",receivablesBank:"",receivablesFilename:"",receivablesFileinfo:""});let{cashierApprovalStatus:Y,verifyStatus:E}=de(o);const G=i=>{P.value=i.id,M="",q="",i.cashierApprovalStatus!="1"?(Y.value="1",E.value="1"):(E.value="3",Y.value=i.cashierApprovalStatus),console.log(o,"formstate"),he.value="\u5BA1\u6838",F.value=!0};function Ie(i){const t=i.id;_e.confirm({title:"\u64CD\u4F5C\u786E\u8BA4",content:"\u662F\u5426\u786E\u5B9A\u64A4\u9500\uFF1F",onOk(){ve({id:t,orderStatus:4}).then(()=>{O(),I.success("\u64A4\u9500\u6210\u529F")}).catch(()=>{})}})}const F=f(!1),H=f();function J(){Object.assign(o,{verifyStatus:null,failureReson:""})}const ke=async()=>{let i={orderStatus:o.verifyStatus,id:P.value,cashierApprovalStatus:o.cashierApprovalStatus},t={};o.verifyStatus==1&&o.cashierApprovalStatus==1?t=Object.assign(i,{receivablesTime:o.receivablesTime,receivablesAmount:o.receivablesAmount,receivablesBank:o.receivablesBank,receivablesFilename:M,receivablesFileinfo:q}):t=Object.assign(i,{approveReason:o.failureReson});try{if(await H.value.validateFields(),o.verifyStatus==2&&o.failureReson==""){I.error("\u8BF7\u586B\u5199\u4E0D\u901A\u8FC7\u539F\u56E0");return}P.value&&ve(t).then(c=>{console.log(c),(c==null?void 0:c.code)===200&&(I.success("\u64CD\u4F5C\u6210\u529F"),J(),O())}),F.value=!1}catch(c){console.log(c)}},we={verifyStatus:[{required:!0,message:"\u5FC5\u9009",trigger:["change"]}],receivablesTime:[{required:!0,message:"\u65F6\u95F4\u5FC5\u9009",trigger:["blur"]}],receivablesAmount:[{required:!0,message:"\u6536\u6B3E\u91D1\u989D\u5FC5\u586B",trigger:["blur"]}],receivablesBank:[{required:!0,message:"\u94F6\u884C\u540D\u79F0\u5FC5\u586B",trigger:["blur"]}]},h=f([]),Se=f(!1),Ce=async()=>{if(h.value[0].originFileObj.size/1024/1024>=10){I.error("\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC710M"),h.value=[];return}let t=new FormData;t.append("file",h.value[0].originFileObj);const c=await ht(t,Se.value);if(!c.success){I.error("\u4E0A\u4F20\u5931\u8D25"),h.value=[];return}I.success("\u4E0A\u4F20\u6210\u529F"),h.value[0].status="done",q=c.data,M=h.value[0].originFileObj.name};return O(),(i,t)=>{const c=Ge,Oe=He,Ue=Je,Te=Ke,Ne=We,y=Xe,Re=Ze,Fe=et,Q=tt,$=at,K=lt,z=st,g=nt,Ae=it,Be=ot,De=ut,Pe=rt,qe=dt,Me=pt,W=ct,Qe=_t,$e=vt,ze=_e;return n(),d(B,null,[s(c,{title:"\u5BA1\u6279\u9500\u552E\u51FA\u5E93\u5355",icon:"icon-rongqi"},{nav:a(()=>[p(u("\u91C7\u96C6\u7BA1\u7406")+" "),xt,It]),_:1}),s(Te,null,{default:a(()=>[s(Ue,{defaultValue:"",value:R.value,"onUpdate:value":t[0]||(t[0]=e=>R.value=e),onChange:k},{default:a(()=>[(n(!0),d(B,null,pe(ye,(e,l)=>(n(),v(Oe,{key:l,value:e.value},{default:a(()=>[p(u(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),T("div",kt,[s(z,{justify:"space-between",style:{flex:"1"}},{default:a(()=>[T("div",wt,[s(K,{layout:"inline",ref:"queryRef",model:x(_)},{default:a(()=>[s(y,{style:{width:"308px"},name:"dateRange"},{default:a(()=>[s(Ne,{label:"\u63D0\u4EA4\u65F6\u95F4",value:b.value,"onUpdate:value":t[1]||(t[1]=e=>b.value=e),"value-format":"YYYY-MM-DD",onChange:k},null,8,["value"])]),_:1}),s(y,{label:""},{default:a(()=>[s(Q,{placeholder:"\u8BF7\u8F93\u5165",value:x(C),"onUpdate:value":t[3]||(t[3]=e=>ce(C)?C.value=e:null),onKeyup:Le(k,["enter"])},{addonBefore:a(()=>[s(Fe,{style:{width:"120px"},value:x(S),"onUpdate:value":t[2]||(t[2]=e=>ce(S)?S.value=e:null),onChange:be},{default:a(()=>[(n(!0),d(B,null,pe(V.value,(e,l)=>(n(),v(Re,{key:l,value:e.value},{default:a(()=>[p(u(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["value"])]),_:1}),s(y,null,{default:a(()=>[s($,{type:"primary",onClick:k},{default:a(()=>[p("\u67E5\u8BE2")]),_:1}),s($,{type:"primary",ghost:"",onClick:ge,style:{"margin-left":"15px"}},{default:a(()=>[p("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),s(Pe,{spinning:D.value},{default:a(()=>[s(De,{dataSource:j.value,columns:R.value=="2"?x(bt):x(gt),pagination:w,scroll:{x:0,y:500}},{bodyCell:a(({column:e,record:l})=>{var X,Z,ee,te,ae,le,se,ne,ie,oe,ue,re;return[e.dataIndex==="orderType"?(n(),v(g,{key:0},{default:a(()=>[p(u(l.orderType==1?"\u5B9A\u5411\u8D2D\u9500":"\u81EA\u4E3B\u7ECF\u8425"),1)]),_:2},1024)):r("",!0),e.dataIndex==="cooperatorName"?(n(),d("span",St,u((X=l.saleOrderInfo)==null?void 0:X.cooperatorName),1)):r("",!0),e.dataIndex==="contractNo"?(n(),d("span",Ct,u((Z=l.saleOrderInfo)==null?void 0:Z.contractNo),1)):r("",!0),e.dataIndex==="productCode"?(n(),d("span",Ot,u((ee=l.saleOrderInfo)==null?void 0:ee.productCode),1)):r("",!0),e.dataIndex==="productName"?(n(),d("span",Ut,u((te=l.saleOrderInfo)==null?void 0:te.productName),1)):r("",!0),e.dataIndex==="productSpec"?(n(),d("span",Tt,u((ae=l.saleOrderInfo)==null?void 0:ae.productSpec),1)):r("",!0),e.dataIndex==="orderQuality"?(n(),d("span",Nt,u((le=l.saleOrderInfo)==null?void 0:le.orderQuality),1)):r("",!0),e.dataIndex==="storehouseName"?(n(),d("span",Rt,u((se=l.saleOrderInfo)==null?void 0:se.storehouseName),1)):r("",!0),e.dataIndex==="unitPrice"?(n(),d("span",Ft,u((ne=l.saleOrderInfo)==null?void 0:ne.unitPrice),1)):r("",!0),e.dataIndex==="totalPrice"?(n(),d("span",At,u((ie=l.saleOrderInfo)==null?void 0:ie.totalPrice),1)):r("",!0),e.dataIndex==="orderTime"?(n(),d("span",Bt,u((oe=l.saleOrderInfo)==null?void 0:oe.createTime),1)):r("",!0),e.dataIndex==="orderUser"?(n(),d("span",Dt,u((ue=l.saleOrderInfo)==null?void 0:ue.createBy),1)):r("",!0),e.dataIndex==="sendDate"?(n(),d("span",Pt,u((re=l.saleOrderInfo)==null?void 0:re.sendDate),1)):r("",!0),e.dataIndex==="natureConvert"?(n(),v(g,{key:13},{default:a(()=>[p(u(l.natureConvert==1?"\u5408\u4F5C\u8F6C\u6362":"\u81EA\u4E3B\u8F6C\u6362"),1)]),_:2},1024)):r("",!0),e.dataIndex==="currency"?(n(),v(g,{key:14},{default:a(()=>[p(u(l.currency==1?"\u4EBA\u6C11\u5E01":"\u7F8E\u5143"),1)]),_:2},1024)):r("",!0),e.dataIndex==="measureUnit"?(n(),v(g,{key:15},{default:a(()=>{var m,U;return[p(u(((m=l.saleOrderInfo)==null?void 0:m.measureUnit)==1?"\u65A4":((U=l.saleOrderInfo)==null?void 0:U.measureUnit)==2?"\u516C\u65A4":"\u5428"),1)]}),_:2},1024)):r("",!0),e.dataIndex==="baseQuality"?(n(),v(g,{key:16},{default:a(()=>{var m;return[p(u((m=l.saleOrderInfo)==null?void 0:m.baseQuality),1)]}),_:2},1024)):r("",!0),e.dataIndex==="baseMeasureUnit"?(n(),v(g,{key:17},{default:a(()=>{var m,U;return[p(u(((m=l.saleOrderInfo)==null?void 0:m.baseMeasureUnit)==1?"\u65A4":((U=l.saleOrderInfo)==null?void 0:U.baseMeasureUnit)==2?"\u516C\u65A4":"\u5428"),1)]}),_:2},1024)):r("",!0),e.dataIndex==="nature"?(n(),v(g,{key:18},{default:a(()=>[p(u(l.nature==1?"\u50A8\u5907\u7CAE":l.nature==2?"\u5546\u54C1\u7CAE":"\u8F6E\u6362\u7CAE\u6CB9"),1)]),_:2},1024)):r("",!0),e.dataIndex==="orderStatus"?(n(),d(B,{key:19},[s(g,null,{default:a(()=>[p(u(l.orderStatus==1?"\u5F85\u5BA1\u6838":l.orderStatus==2?"\u5BA1\u6838\u4E0D\u901A\u8FC7":l.orderStatus==3?"\u5BA1\u6838\u901A\u8FC7":"\u5DF2\u53D6\u6D88"),1)]),_:2},1024),l.orderStatus==2?(n(),v(Ae,{key:0,placement:"top"},{title:a(()=>[T("span",null,u(l.approveReason),1)]),default:a(()=>[s(x(Ye))]),_:2},1024)):r("",!0)],64)):r("",!0),e.dataIndex==="edit"?(n(),d("span",qt,[s(Be,{size:"middle",style:{color:"#05C059",cursor:"pointer"}},{default:a(()=>[l.cashierApprovalStatus==1&&l.orderStatus==1?(n(),d("span",{key:0,onClick:m=>G(l)},"\u5BA1\u6838",8,Mt)):r("",!0),l.cashierApprovalStatus!=1?(n(),d("span",{key:1,onClick:m=>G(l)},"\u51FA\u7EB3",8,Qt)):(n(),d("span",{key:2,onClick:m=>Ie(l)},"\u64A4\u9500\u5BA1\u6838",8,$t))]),_:2},1024)])):r("",!0)]}),_:1},8,["dataSource","columns","pagination"])]),_:1},8,["spinning"])]),s(ze,{visible:F.value,"onUpdate:visible":t[10]||(t[10]=e=>F.value=e),title:"\u5BA1\u6279\u72B6\u6001",width:"480px",onOk:ke,onCancel:J},{default:a(()=>[s(K,{class:"set-form",ref_key:"verifyFormRef",ref:H,model:o,name:"basic",autocomplete:"off",colon:!1,rules:we,layout:"vertical"},{default:a(()=>[o.cashierApprovalStatus==1&&o.verifyStatus==1?(n(),v(z,{key:0},{default:a(()=>[s(y,{name:"receivablesTime",label:"\u6536\u6B3E\u65F6\u95F4:"},{default:a(()=>[s(qe,{value:o.receivablesTime,"onUpdate:value":t[4]||(t[4]=e=>o.receivablesTime=e),"show-time":"",type:"date",valueFormat:"YYYY-MM-DD HH:mm:ss",placeholder:"Pick a date"},null,8,["value"])]),_:1}),s(y,{name:"receivablesAmount",label:"\u6536\u6B3E\u91D1\u989D(\u5143):",s:""},{default:a(()=>[s(Q,{placeholder:"\u8BF7\u8F93\u5165",value:o.receivablesAmount,"onUpdate:value":t[5]||(t[5]=e=>o.receivablesAmount=e)},null,8,["value"])]),_:1}),s(y,{name:"receivablesBank",label:"\u6536\u6B3E\u94F6\u884C:"},{default:a(()=>[s(Q,{placeholder:"\u8BF7\u8F93\u5165",value:o.receivablesBank,"onUpdate:value":t[6]||(t[6]=e=>o.receivablesBank=e)},null,8,["value"])]),_:1}),s(y,{label:"\u9644\u4EF6\uFF1A",name:"file"},{default:a(()=>[s(Me,{"file-list":h.value,"onUpdate:fileList":t[7]||(t[7]=e=>h.value=e),name:"file",accept:".pdf,.jpg,.txt",customRequest:Ce,maxCount:1,showUploadList:!0},{default:a(()=>[s($,{type:"link",size:"large"},{default:a(()=>[p(" +\u4E0A\u4F20")]),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1})):(n(),v(z,{key:1},{default:a(()=>[s(y,{label:" ",name:"verifyStatus"},{default:a(()=>[s(Qe,{value:o.verifyStatus,"onUpdate:value":t[8]||(t[8]=e=>o.verifyStatus=e)},{default:a(()=>[s(W,{value:"3"},{default:a(()=>[p("\u5BA1\u6838\u901A\u8FC7")]),_:1}),s(W,{value:"2"},{default:a(()=>[p("\u5BA1\u6838\u4E0D\u901A\u8FC7")]),_:1})]),_:1},8,["value"])]),_:1}),o.verifyStatus==="2"?(n(),v(y,{key:0,label:""},{default:a(()=>[s($e,{value:o.failureReson,"onUpdate:value":t[9]||(t[9]=e=>o.failureReson=e),"show-count":"",rows:4,maxlength:200,placeholder:"\u8F93\u5165\u4E0D\u901A\u8FC7\u7684\u539F\u56E0"},null,8,["value"])]),_:1})):r("",!0)]),_:1}))]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},Lt=Ve(zt,[["__scopeId","data-v-1868ad26"]]);export{Lt as default};
