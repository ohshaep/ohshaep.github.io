import{r as c,o as i,i as u,w as a,d as l,e as p,Q as U,a_ as V,m as w,aa as T,ab as j,n as q,B as A,ac as Q,s as z,M as E}from"./index.192c8708.js";import{d as G}from"./common.e897a13c.js";import{u as H}from"./common.0ebad352.js";import{c as J}from"./artMag.f64bd10b.js";const X={__name:"review-modal",props:{reviewData:{type:Object,default:()=>{}}},emits:["refresh"],setup(g,{expose:y,emit:R}){const b=R,t=g,x=H(),s=c(!1),F=async()=>{V(D),s.value=!0},d=()=>{s.value=!1,k()},k=()=>{e.value={id:null,approvalState:3,fileInfo:"",filename:"",approvalReason:""}},e=c({id:null,approvalState:3,fileInfo:"",filename:"",approvalReason:""}),D=async()=>{e.value.id=t.reviewData.id,console.log(t.reviewData,"rd"),console.log(e.value,"rF"),e.value.fileInfo=t.reviewData.fileInfo,e.value.filename=t.reviewData.filename,e.value.approvalReason=t.reviewData.approvalReason},h={approvalReason:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BA1\u6838\u4E0D\u901A\u8FC7\u7406\u7531",trigger:"change"}]},I={path:e.value.fileInfo,fileName:e.value.filename},S=async()=>{const r=await G(I);x(r,e.value.filename),console.log("id",e.value.id)},f=c(),C=async()=>{f.value.validate().then(async r=>{if(r)try{(await J(e.value)).code===200&&(w.success("\u5BA1\u6838\u6210\u529F"),d(),b("refresh"))}catch{}else return w.error("\u63D0\u4EA4\u5931\u8D25\uFF0C\u8BF7\u586B\u5199\u5FC5\u586B\u9879"),!1})};return y({showModal:F}),(r,o)=>{const m=T,M=j,v=q,_=A,B=Q,N=z,O=E;return i(),u(O,{visible:s.value,"onUpdate:visible":o[2]||(o[2]=n=>s.value=n),title:"\u64CD\u4F5C\u786E\u8BA4",onOk:C,onCancel:d,"append-to-body":"",destroyOnClose:""},{default:a(()=>[l(N,{ref_key:"reviewRef",ref:f,model:e.value,rules:h},{default:a(()=>[l(v,{style:{width:"308px"},name:"approvalState",label:"\u5BA1\u6838\u72B6\u6001"},{default:a(()=>[l(M,{value:e.value.approvalState,"onUpdate:value":o[0]||(o[0]=n=>e.value.approvalState=n),style:{"margin-right":"8px"}},{default:a(()=>[l(m,{value:3},{default:a(()=>[p("\u5BA1\u6838\u901A\u8FC7")]),_:1}),l(m,{value:2},{default:a(()=>[p("\u5BA1\u6838\u4E0D\u901A\u8FC7")]),_:1})]),_:1},8,["value"])]),_:1}),l(v,{style:{"margin-right":"30px"}},{default:a(()=>[e.value.fileInfo?(i(),u(_,{key:0,onClick:S},{default:a(()=>[p("\u70B9\u51FB\u4E0B\u8F7D\u9644\u4EF6\u67E5\u770B")]),_:1})):(i(),u(_,{key:1},{default:a(()=>[p("\u65E0\u9644\u4EF6")]),_:1}))]),_:1}),e.value.approvalState=="2"?(i(),u(v,{key:0,style:{"margin-right":"30px"},name:"approvalReason",label:"\u5BA1\u6838\u4E0D\u901A\u8FC7\u7406\u7531"},{default:a(()=>[l(B,{value:e.value.approvalReason,"onUpdate:value":o[1]||(o[1]=n=>e.value.approvalReason=n)},null,8,["value"])]),_:1})):U("",!0)]),_:1},8,["model"])]),_:1},8,["visible"])}}};export{X as default};
